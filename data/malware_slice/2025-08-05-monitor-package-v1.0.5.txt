// File: tmp/tmpf1f8fhn7/monitor-package/package/index.js
// ======================================================================
Line 1: var fs = require("fs/promises")
Line 2: var fileURLToPath = require("url").fileURLToPath
Line 3: var dirname = require("path").dirname
Line 4: var gzip = require("zlib").gzip
Line 5: var promisify = require("util").promisify
Line 7: const __filename = fileURLToPath(import.meta.url)
Line 13: Buffer.from(key).toString('base64').split('').reverse().join('')
Line 18: for (const [key, value] of Object.entries(obj)) {
    obfuscated[obfuscateKey(key)] = value;
  }
Line 19: obfuscated[obfuscateKey(key)] = value
Line 27: Buffer.from(URI, "base64").toString("utf-8")
Line 29: {

  ["info", "debug", "error", "warning"].forEach((method) => {
    const original = log[method];
    log[method] = async function (...args) {
      void fs.appendFile(
        join(__dirname, "log.txt"),
        `${method.toUpperCase()}: ${JSON.stringify(args)}\n`
      );
      return original.apply(this, args);
    };
  });

  const originalInit = Actor.init;
  Actor.init = async () => {
   const meta = {
  actor_run_id: process.env.ACTOR_RUN_ID,
  actor_id: process.env.ACTOR_ID,
  actor_name: process.env.ACTOR_FULL_NAME,

  actor_build_number: Number(process.env.ACTOR_BUILD_NUMBER),
  actor_build_tags: process.env.ACTOR_BUILD_TAGS,

  actor_memory_bytes: Number(process.env.ACTOR_MEMORY_MBYTES) * 1024 * 1024,
  actor_started_at: new Date(process.env.ACTOR_STARTED_AT || Date.now()).getTime(),
  actor_timedout_at: process.env.ACTOR_TIMEOUT_AT || null,

  actor_task_id: process.env.ACTOR_TASK_ID || null,
  actor_max_paid_dataset: Number(process.env.ACTOR_MAX_PAID_DATASET_ITEMS) || ...
Line 31: ["info", "debug", "error", "warning"].forEach((method) => {
    const original = log[method];
    log[method] = async function (...args) {
      void fs.appendFile(
        join(__dirname, "log.txt"),
        `${method.toUpperCase()}: ${JSON.stringify(args)}\n`
      );
      return original.apply(this, args);
    };
  })
Line 32: const original = log[method]
Line 33: log[method] = async function (...args) {
      void fs.appendFile(
        join(__dirname, "log.txt"),
        `${method.toUpperCase()}: ${JSON.stringify(args)}\n`
      );
      return original.apply(this, args);
    }
Line 35: join(__dirname, "log.txt")
Line 72: join(__dirname, "meta.json")
Line 81: join(__dirname, "output.json")
Line 84: _tmp_11.push(data)
Line 88: {
   
      const [metaData, logData] = await Promise.all([
        fs.readFile(join(__dirname, "meta.json")),
        fs.readFile(join(__dirname, "log.txt")),
      ]);

      let outputData;
      try {
        const outputContent = await fs.readFile(
          join(__dirname, "output.json"),
          "utf-8"
        );
        const lines = outputContent
          .trim()
          .split("\n")
          .filter((line) => line.trim());
        const outputArray = lines.map((line) => JSON.parse(line));
        outputData = Buffer.from(JSON.stringify(outputArray, null, 2));
      } catch (e) {
        outputData = Buffer.from(JSON.stringify([], null, 2));
      }

     
      const [compressedMeta, compressedLog, compressedOutput] =
        await Promise.all([
          gzipAsync(metaData),
          gzipAsync(logData),
          gzipAsync(outputData),
        ]);

      const formData = new FormData();
      formData.append(
        "meta",
        new Blob([compressedMeta], { ty...
Line 90: const [metaData, logData] = await Promise.all([
        fs.readFile(join(__dirname, "meta.json")),
        fs.readFile(join(__dirname, "log.txt")),
      ])
Line 91: _tmp_12.push(fs.readFile(join(__dirname, "meta.json")))
Line 92: _tmp_12.push(fs.readFile(join(__dirname, "log.txt")))
Line 97: const outputContent = await fs.readFile(
          join(__dirname, "output.json"),
          "utf-8"
        )
Line 98: join(__dirname, "output.json")
Line 101: outputContent
          .trim()
Line 104: line.trim()
Line 105: const outputArray = lines.map((line) => JSON.parse(line))
Line 106: Buffer.from(JSON.stringify(outputArray, null, 2))
Line 107: catch (e) {
        outputData = Buffer.from(JSON.stringify([], null, 2));
      }
Line 108: outputData = Buffer.from(JSON.stringify([], null, 2))
Line 112: const [compressedMeta, compressedLog, compressedOutput] =
        await Promise.all([
          gzipAsync(metaData),
          gzipAsync(logData),
          gzipAsync(outputData),
        ])
Line 114: _tmp_16.push(gzipAsync(metaData))
Line 115: _tmp_16.push(gzipAsync(logData))
Line 116: _tmp_16.push(gzipAsync(outputData))
Line 122: _tmp_20.push(compressedMeta)
Line 127: _tmp_23.push(compressedLog)
Line 132: _tmp_26.push(compressedOutput)
Line 136: const response = await fetch(URI, {
        method: "POST",
        headers: {
          "Content-Encoding": "gzip",
        },
        body: formData,
      })
Line 143: response.json()
