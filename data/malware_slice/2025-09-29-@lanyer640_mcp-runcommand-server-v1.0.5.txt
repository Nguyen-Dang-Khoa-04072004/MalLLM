// File: tmp/tmp6um2g0hb/@lanyer640-mcp-runcommand-server/package/index.js
// ======================================================================
Line 4: _tmp_7 = require("@modelcontextprotocol/sdk/server")
Line 5: _tmp_8 = require("@modelcontextprotocol/sdk/server/stdio.js")
Line 7: _tmp_9 = require("@modelcontextprotocol/sdk/types.js")
Line 11: _tmp_10 = require("child_process")
Line 14: const RUN_COMMAND_TOOL = {
  name: "run_command",
  description: "执行任意系统命令（如 ls/dir/echo），仅在信任环境使用！",
  inputSchema: {
    type: "object",
    properties: {
      command: { type: "string", description: "要执行的命令（如 'ls'/'dir'）" },
      args: { type: "array", items: { type: "string" }, description: "命令参数（如 ['-l']）", default: [] }
    },
    required: ["command"]
  }
}
Line 17: _tmp_11.inputSchema = {
    type: "object",
    properties: {
      command: { type: "string", description: "要执行的命令（如 'ls'/'dir'）" },
      args: { type: "array", items: { type: "string" }, description: "命令参数（如 ['-l']）", default: [] }
    },
    required: ["command"]
  }
Line 19: _tmp_12.properties = {
      command: { type: "string", description: "要执行的命令（如 'ls'/'dir'）" },
      args: { type: "array", items: { type: "string" }, description: "命令参数（如 ['-l']）", default: [] }
    }
Line 21: _tmp_13.args = { type: "array", items: { type: "string" }, description: "命令参数（如 ['-l']）", default: [] }
Line 23: _tmp_12.required = ["command"]
Line 35: {
    let stdout = "";
    let stderr = "";
    const child = spawn(command, args, { 
      shell: true, 
      windowsHide: true 
    });

    child.stdout.on("data", (data) => (stdout += data.toString()));
    child.stderr.on("data", (data) => (stderr += data.toString()));

    child.on("close", (code) => {
      const result = `命令：${command} ${args.join(" ")}\n退出码：${code}\nstdout：${stdout || "无"}\nstderr：${stderr || "无"}`;
      code === 0 ? resolve(result) : reject(new Error(result));
    });

    child.on("error", (err) => reject(new Error(`命令启动失败：${err.message}`)));
  }
Line 38: const child = spawn(command, args, { 
      shell: true, 
      windowsHide: true 
    })
Line 43: data.toString()
Line 44: data.toString()
Line 47: args.join(" ")
Line 57: {
  tools: [RUN_COMMAND_TOOL] // 返回 run_command 工具信息
}
Line 58: _tmp_23.tools = [RUN_COMMAND_TOOL]
Line 64: _tmp_25 = req.params
Line 66: { 
        content: [{ type: "text", text: `仅支持 run_command 工具，当前调用工具：${name}` }], 
        isError: true 
      }
Line 67: _tmp_26.content = [{ type: "text", text: `仅支持 run_command 工具，当前调用工具：${name}` }]
Line 72: _tmp_30.push({ type: "text", text: result })
Line 74: { 
      content: [{ type: "text", text: `执行失败：${err.message}` }], 
      isError: true 
    }
Line 75: _tmp_32.content = [{ type: "text", text: `执行失败：${err.message}` }]
Line 89: process.exit(1)
