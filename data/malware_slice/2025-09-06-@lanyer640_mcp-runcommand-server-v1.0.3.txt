// File: tmp/tmp824fw9t5/@lanyer640-mcp-runcommand-server/package/index.js
// ======================================================================
Line 4: _tmp_7 = require("@modelcontextprotocol/sdk/dist/cjs/server")
Line 5: _tmp_8 = require("@modelcontextprotocol/sdk/dist/esm/server/stdio")
Line 6: _tmp_9 = require("child_process")
Line 9: const RUN_COMMAND_TOOL = {
  name: "run_command",
  description: "执行任意系统命令（如 ls/dir/echo），仅在信任环境使用！",
  inputSchema: {
    type: "object",
    properties: {
      command: { type: "string", description: "要执行的命令（如 'ls'/'dir'）" },
      args: { type: "array", items: { type: "string" }, description: "命令参数（如 ['-l']）", default: [] }
    },
    required: ["command"] // 必须传command参数
  }
}
Line 12: _tmp_10.inputSchema = {
    type: "object",
    properties: {
      command: { type: "string", description: "要执行的命令（如 'ls'/'dir'）" },
      args: { type: "array", items: { type: "string" }, description: "命令参数（如 ['-l']）", default: [] }
    },
    required: ["command"] // 必须传command参数
  }
Line 14: _tmp_11.properties = {
      command: { type: "string", description: "要执行的命令（如 'ls'/'dir'）" },
      args: { type: "array", items: { type: "string" }, description: "命令参数（如 ['-l']）", default: [] }
    }
Line 16: _tmp_12.args = { type: "array", items: { type: "string" }, description: "命令参数（如 ['-l']）", default: [] }
Line 18: _tmp_11.required = ["command"]
Line 30: {
    let stdout = "";
    let stderr = "";
    const child = spawn(command, args, { 
      shell: true, // 支持管道、通配符等复杂命令
      windowsHide: true // Windows系统隐藏命令行窗口
    });

    // 收集输出
    child.stdout.on("data", (data) => (stdout += data.toString()));
    child.stderr.on("data", (data) => (stderr += data.toString()));

    // 处理命令结束
    child.on("close", (code) => {
      const result = `命令：${command} ${args.join(" ")}\n退出码：${code}\nstdout：${stdout || "无"}\nstderr：${stderr || "无"}`;
      code === 0 ? resolve(result) : reject(new Error(result));
    });

    // 处理命令启动失败（如命令不存在）
    child.on("error", (err) => reject(new Error(`命令启动失败：${err.message}`)));
  }
Line 33: const child = spawn(command, args, { 
      shell: true, // 支持管道、通配符等复杂命令
      windowsHide: true // Windows系统隐藏命令行窗口
    })
Line 39: data.toString()
Line 40: data.toString()
Line 44: args.join(" ")
Line 55: _tmp_23.push(RUN_COMMAND_TOOL)
Line 60: _tmp_24 = req.params
Line 63: _tmp_26.push({ type: "text", text: `仅支持 run_command 工具` })
Line 67: _tmp_29.push({ type: "text", text: result })
Line 69: _tmp_32.push({ type: "text", text: `执行失败：${err.message}` })
Line 81: process.exit(1)
