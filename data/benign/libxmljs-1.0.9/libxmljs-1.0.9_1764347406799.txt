var createXMLReferenceOrThrow = require("./bindings").createXMLReferenceOrThrow
fs.writeFileSync(
    path,
    source
        .replace(
            "v8::Persistent<v8::Object> handle;",
            `v8::Persistent<v8::Object> handle; int refCount; xmlNode* ancestor; xmlDoc* doc;
            
            void Ref();
            void Unref();`
        )
        .replace(
            "swigCMemOwn(false), swigCObject(0), info(0)",
            "swigCMemOwn(false), swigCObject(0), info(0), refCount(0), ancestor(NULL), doc(NULL)"
        )
)
fs.existsSync(packageRoot + ".git") &&
    (!fs.existsSync(packageRoot + "vendor/libxml2/include/libxml/parserInternals.h") ||
        !fs.existsSync(packageRoot + "vendor/libxml2/globals.c"))
source
        .replace(
            "v8::Persistent<v8::Object> handle;",
            `v8::Persistent<v8::Object> handle; int refCount; xmlNode* ancestor; xmlDoc* doc;
            
            void Ref();
            void Unref();`
        )
        .replace(
            "swigCMemOwn(false), swigCObject(0), info(0)",
            "swigCMemOwn(false), swigCObject(0), info(0), refCount(0), ancestor(NULL), doc(NULL)"
        )
