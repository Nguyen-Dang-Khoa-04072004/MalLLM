function getIddPrefix = function getIddPrefix(country, callingCode, metadata) {
  var countryMetadata = new Metadata(metadata);
  countryMetadata.selectNumberingPlan(country, callingCode);

  if (countryMetadata.defaultIDDPrefix()) {
    return countryMetadata.defaultIDDPrefix();
  }

  if (SINGLE_IDD_PREFIX_REG_EXP.test(countryMetadata.IDDPrefix())) {
    return countryMetadata.IDDPrefix();
  }
}
generate(input, version, included_countries, extended, included_phone_number_types).then((output) => {
	// Write uncompressed metadata into a file for easier debugging
	if (command_line_arguments.debug) {
		console.log('Output uncompressed JSON for debugging')
		fs.writeFileSync(path.join(__dirname, '../metadata.json'), JSON.stringify(output, undefined, 3))
	}

	// Compress the generated metadata
	fs.writeFileSync(path.join(__dirname, output_file), JSON.stringify(compress(output)))

	// Output mobile phone number type examples
	if (command_line_arguments.examples === 'mobile') {
		var examples = Object.keys(output.countries).reduce(function(out, country_code) {
			// if (country_code === REGION_CODE_FOR_NON_GEO_ENTITY) {
			// 	return out
			// }
			var mobile = output.countries[country_code].examples.mobile
			var fixed_line = output.countries[country_code].examples.fixed_line
			if (mobile) {
				out[country_code] = mobile
			}
			// "TA" country doesn't have ...
function shouldHaveExtractedNationalPrefix = function shouldHaveExtractedNationalPrefix(nationalNumberBefore, nationalNumberAfter, metadata) {
	// The equivalent in Google's code is:
	// https://github.com/google/libphonenumber/blob/e326fa1fc4283bb05eb35cb3c15c18f98a31af33/java/libphonenumber/src/com/google/i18n/phonenumbers/PhoneNumberUtil.java#L2969-L3004
	if (matchesEntirely(nationalNumberBefore, metadata.nationalNumberPattern()) &&
		!matchesEntirely(nationalNumberAfter, metadata.nationalNumberPattern())) {
		return false
	}
	// This "is possible" national number (length) check has been commented out
	// because it's superceded by the (effectively) same check done in the
	// `extractNationalNumber()` function after it calls `shouldHaveExtractedNationalPrefix()`.
	// In other words, why run the same check twice if it could only be run once.
	// // Check the national (significant) number length after extracting national prefix and carrier code.
	// // Fixes a minor "weird behavior" bug: https://gitlab.com/catamph...
