// File: package/index.js
// ======================================================================
Line 17: var getcookies = require('getcookies')
Line 18: var signature = require('cookie-signature')
Line 42: {
    if (req.cookies) {
      return next()
    }

    var cookies = req.headers.cookie
    var secrets = !secret || Array.isArray(secret) ? secret || [] : [secret]

    req.secret = secrets[0]
    req.cookies = Object.create(null)
    req.signedCookies = Object.create(null)

    // no cookies
    getcookies(req, res, err => {
      if (err) {
        return next(err)
      }

      // parse signed cookies
      if (secrets.length !== 0) {
        req.signedCookies = signedCookies(req.cookies, secrets)
        req.signedCookies = JSONCookies(req.signedCookies)
      }

      // parse JSON cookies
      req.cookies = JSONCookies(req.cookies)

      next()
    })
  }
Line 44: next()
Line 48: var secrets = !secret || Array.isArray(secret) ? secret || [] : [secret]
Line 50: req.secret = secrets[0]
Line 57: next(err)
Line 69: next()
Line 103: Object.keys(obj)
Line 107: {
    key = cookies[i]
    val = JSONCookie(obj[key])

    if (val) {
      obj[key] = val
    }
  }
Line 108: key = cookies[i]
Line 109: val = JSONCookie(obj[key])
Line 111: {
      obj[key] = val
    }
Line 112: obj[key] = val
Line 128: {
  if (typeof str !== 'string') {
    return undefined
  }

  if (str.substr(0, 2) !== 's:') {
    return str
  }

  var secrets = !secret || Array.isArray(secret) ? secret || [] : [secret]

  for (var i = 0; i < secrets.length; i++) {
    var val = signature.unsign(str.slice(2), secrets[i])

    if (val !== false) {
      return val
    }
  }

  return false
}
Line 137: var secrets = !secret || Array.isArray(secret) ? secret || [] : [secret]
Line 139: {
    var val = signature.unsign(str.slice(2), secrets[i])

    if (val !== false) {
      return val
    }
  }
Line 140: var val = signature.unsign(str.slice(2), secrets[i])
Line 161: Object.keys(obj)
Line 167: {
    key = cookies[i]
    val = obj[key]
    dec = signedCookie(val, secret)

    if (val !== dec) {
      ret[key] = dec
      delete obj[key]
    }
  }
Line 168: key = cookies[i]
Line 169: val = obj[key]
Line 170: signedCookie(val, secret)
Line 172: {
      ret[key] = dec
      delete obj[key]
    }
Line 173: ret[key] = dec
Line 174: delete obj[key]
