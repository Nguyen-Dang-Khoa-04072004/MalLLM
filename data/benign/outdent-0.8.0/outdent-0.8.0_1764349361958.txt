function createInstance = function createInstance(options: Options): Outdent {
  /** Cache of pre-processed template literal arrays */
  const arrayAutoIndentCache = createWeakMap<
    TemplateStringsArray,
    Array<string>
  >();
  /**
     * Cache of pre-processed template literal arrays, where first interpolated value is a reference to outdent,
     * before interpolated values are injected.
     */
  const arrayFirstInterpSetsIndentCache = createWeakMap<
    TemplateStringsArray,
    Array<string>
  >();

  /* tslint:disable:no-shadowed-variable */
  function outdent(
    stringsOrOptions: TemplateStringsArray,
    ...values: Array<any>
  ): string;
  function outdent(stringsOrOptions: Options): Outdent;
  function outdent(
    stringsOrOptions: TemplateStringsArray | Options,
    ...values: Array<any>
  ): string | Outdent {
    /* tslint:enable:no-shadowed-variable */
    if (isTemplateStringsArray(stringsOrOptions)) {
      const strings = stringsOrOptions;

      // Is first interpolated value a ref...