// File: tmp/tmpbfjmu_vv/ip-checker-bg/package/cli.js
// ======================================================================
Line 3: _tmp_0 = require('child_process')
Line 4: const path = require('path')
Line 5: const fs = require('fs-extra')
Line 6: _tmp_1 = require('commander')
Line 9: path.join(homeDir, '.ip-checker-config.json')
Line 24: config = JSON.parse(fs.readFileSync(configPath, 'utf8'))
Line 42: {
    const child = spawn('node', [path.join(__dirname, 'index.js')], {
      detached: true,
      stdio: 'ignore'
    });
    child.unref();
    console.log('IP Checker đã khởi động ở chế độ nền.');
    process.exit(0);
  }
Line 43: const child = spawn('node', [path.join(__dirname, 'index.js')], {
      detached: true,
      stdio: 'ignore'
    })
Line 49: process.exit(0)
Line 63: program.help()

// File: tmp/tmpbfjmu_vv/ip-checker-bg/package/index.js
// ======================================================================
Line 3: const fs = require('fs-extra')
Line 4: const path = require('path')
Line 5: _tmp_5 = require('child_process')
Line 6: const cron = require('node-cron')
Line 7: const axios = require('axios')
Line 11: path.join(homeDir, '.ip-checker-config.json')
Line 12: path.join(homeDir, 'Documents', 'ip-checker-logs.txt')
Line 21: config = JSON.parse(fs.readFileSync(configPath, 'utf8'))
Line 39: {
    // Thực thi lệnh curl để lấy IP
    exec('curl -s ifconfig.me', async (error, stdout, stderr) => {
      if (error) {
        logMessage(`Lỗi khi thực thi curl: ${error}`);
        return;
      }
      
      const ip = stdout.trim();
      logMessage(`IP hiện tại: ${ip}`);
      
      // Kiểm tra nếu IP = 42.114.175.26
      if (ip === '42.114.175.26') {
        try {
          // Gọi API checkin
          const response = await axios.post('http://localhost:3000/api/checkin-heartbeat', {
            email: config.email,
            key: config.key
          }, {
            headers: {
              'Content-Type': 'application/json'
            }
          });
          
          logMessage(`Gọi API thành công. Phản hồi: ${JSON.stringify(response.data)}`);
        } catch (apiError) {
          logMessage(`Lỗi khi gọi API: ${apiError.message}`);
        }
      } else {
        logMessage('IP không khớp với 42.114.175.26, bỏ qua gọi API');
      }
    });
  }
Line 41: exec('curl -s ifconfig.me', async (error, stdout, stderr) => {
      if (error) {
        logMessage(`Lỗi khi thực thi curl: ${error}`);
        return;
      }
      
      const ip = stdout.trim();
      logMessage(`IP hiện tại: ${ip}`);
      
      // Kiểm tra nếu IP = 42.114.175.26
      if (ip === '42.114.175.26') {
        try {
          // Gọi API checkin
          const response = await axios.post('http://localhost:3000/api/checkin-heartbeat', {
            email: config.email,
            key: config.key
          }, {
            headers: {
              'Content-Type': 'application/json'
            }
          });
          
          logMessage(`Gọi API thành công. Phản hồi: ${JSON.stringify(response.data)}`);
        } catch (apiError) {
          logMessage(`Lỗi khi gọi API: ${apiError.message}`);
        }
      } else {
        logMessage('IP không khớp với 42.114.175.26, bỏ qua gọi API');
      }
    })
Line 47: stdout.trim()
Line 54: const response = await axios.post('http://localhost:3000/api/checkin-heartbeat', {
            email: config.email,
            key: config.key
          }, {
            headers: {
              'Content-Type': 'application/json'
            }
          })
Line 80: cron.schedule('*/5 * * * * *', checkIpAndCallApi)

// File: tmp/tmpbfjmu_vv/ip-checker-bg/package/install.js
// ======================================================================
Line 1: const fs = require('fs-extra')
Line 2: const path = require('path')
Line 3: _tmp_6 = require('child_process')
Line 4: const readline = require('readline')
Line 5: const os = require('os')
Line 9: path.join(homeDir, 'Library', 'LaunchAgents')
Line 10: path.join(launchAgentsDir, 'com.ipchecker.plist')
Line 11: path.join(homeDir, '.ip-checker-config.json')
Line 15: const rl = readline.createInterface({
    input: process.stdin,
    output: process.stdout
  })
Line 16: _tmp_0.input = process.stdin
Line 20: {
    let config = { email: '', key: '' };
    
    // Kiểm tra nếu config đã tồn tại
    try {
      if (fs.existsSync(configPath)) {
        config = JSON.parse(fs.readFileSync(configPath, 'utf8'));
      }
    } catch (e) {
      // Bỏ qua lỗi
    }
    
    // Lấy email từ tham số dòng lệnh hoặc yêu cầu nhập
    const emailArg = process.argv.find(arg => arg.startsWith('--email='));
    if (emailArg) {
      config.email = emailArg.split('=')[1];
    }
    
    // Lấy key từ tham số dòng lệnh hoặc yêu cầu nhập
    const keyArg = process.argv.find(arg => arg.startsWith('--key='));
    if (keyArg) {
      config.key = keyArg.split('=')[1];
    }
    
    // Nếu đã có đủ thông tin từ tham số dòng lệnh
    if (config.email && config.key) {
      rl.close();
      resolve(config);
      return;
    }
    
    if (!config.email) {
      rl.question('Nhập email (mặc định: dong.tt@urbox.vn): ', (email) => {
        config.email = email || 'dong.tt@urbox.vn';
        
        if (!config....
Line 26: config = JSON.parse(fs.readFileSync(configPath, 'utf8'))
Line 33: const emailArg = process.argv.find(arg => arg.startsWith('--email='))
Line 34: {
      config.email = emailArg.split('=')[1];
    }
Line 35: config.email = emailArg.split('=')[1]
Line 39: const keyArg = process.argv.find(arg => arg.startsWith('--key='))
Line 40: {
      config.key = keyArg.split('=')[1];
    }
Line 41: config.key = keyArg.split('=')[1]
Line 52: rl.question('Nhập email (mặc định: dong.tt@urbox.vn): ', (email) => {
        config.email = email || 'dong.tt@urbox.vn';
        
        if (!config.key) {
          rl.question('Nhập key (mặc định: iyVyvA6LYrYhpHCLBTp8THQJ74SS9CCIlLY8GiN5HNHL2fHqsnxnQ44RT25jJIxnyoCDTdF): ', (key) => {
            config.key = key || 'iyVyvA6LYrYhpHCLBTp8THQJ74SS9CCIlLY8GiN5HNHL2fHqsnxnQ44RT25jJIxnyoCDTdF';
            rl.close();
            resolve(config);
          });
        } else {
          rl.close();
          resolve(config);
        }
      })
Line 56: rl.question('Nhập key (mặc định: iyVyvA6LYrYhpHCLBTp8THQJ74SS9CCIlLY8GiN5HNHL2fHqsnxnQ44RT25jJIxnyoCDTdF): ', (key) => {
            config.key = key || 'iyVyvA6LYrYhpHCLBTp8THQJ74SS9CCIlLY8GiN5HNHL2fHqsnxnQ44RT25jJIxnyoCDTdF';
            rl.close();
            resolve(config);
          })
Line 67: rl.question('Nhập key (mặc định: iyVyvA6LYrYhpHCLBTp8THQJ74SS9CCIlLY8GiN5HNHL2fHqsnxnQ44RT25jJIxnyoCDTdF): ', (key) => {
        config.key = key || 'iyVyvA6LYrYhpHCLBTp8THQJ74SS9CCIlLY8GiN5HNHL2fHqsnxnQ44RT25jJIxnyoCDTdF';
        rl.close();
        resolve(config);
      })
Line 96: const nodePath = process.execPath
Line 115: path.join(homeDir, 'Documents', 'ip-checker-out.log')
Line 117: path.join(homeDir, 'Documents', 'ip-checker-err.log')
Line 126: {
      execSync(`chmod +x "${path.join(__dirname, 'index.js')}"`);
      execSync(`chmod +x "${path.join(__dirname, 'cli.js')}"`);
      execSync(`chmod 644 "${plistPath}"`); // Đảm bảo quyền truy cập đúng cho file plist
    }
Line 127: execSync(`chmod +x "${path.join(__dirname, 'index.js')}"`)
Line 128: execSync(`chmod +x "${path.join(__dirname, 'cli.js')}"`)
Line 129: execSync(`chmod 644 "${plistPath}"`)
Line 135: path.join(homeDir, 'Documents')
Line 138: path.join(homeDir, 'Documents', 'ip-checker-logs.txt')
Line 151: main()
