// File: package/index.js
// ======================================================================
Line 5: var EventEmitter = require('events').EventEmitter
Line 6: var spawn = require('child_process').spawn
Line 7: var path = require('path')
Line 10: var fs = require('fs')
Line 16: require('util').inherits(Command, EventEmitter)
Line 44: {
  this.flags = flags;
  this.required = flags.indexOf('<') >= 0;
  this.optional = flags.indexOf('[') >= 0;
  this.bool = flags.indexOf('-no-') === -1;
  flags = flags.split(/[ ,|]+/);
  if (flags.length > 1 && !/^[[<]/.test(flags[1])) this.short = flags.shift();
  this.long = flags.shift();
  this.description = description || '';
}
Line 49: flags = flags.split(/[ ,|]+/)
Line 50: /^[[<]/.test(flags[1])
Line 77: this.name()
Line 99: {
  this.commands = [];
  this.options = [];
  this._execs = {};
  this._allowUnknownOption = false;
  this._args = [];
  this._name = name || '';
}
Line 100: this.commands = []
Line 101: this.options = []
Line 104: this._args = []
Line 178: {
    cmd.description(desc);
    this.executables = true;
    this._execs[cmd._name] = true;
    if (opts.isDefault) this.defaultExecutable = cmd._name;
  }
Line 180: this.executables = true
Line 181: this._execs[cmd._name] = true
Line 185: this.commands.push(cmd)
Line 210: {
  this.command('help [cmd]', 'display help for [cmd]');
}
Line 211: this.command('help [cmd]', 'display help for [cmd]')
Line 228: var argDetails = {
      required: false,
      name: '',
      variadic: false
    }
Line 249: self._args.push(argDetails)
Line 274: {
    // Parse any so-far unknown options
    args = args || [];
    unknown = unknown || [];

    var parsed = self.parseOptions(unknown);

    // Output help if necessary
    outputHelpIfNecessary(self, parsed.unknown);

    // If there are still any unknown options, then we simply
    // die, unless someone asked for help, in which case we give it
    // to them, and then we die.
    if (parsed.unknown.length > 0) {
      self.unknownOption(parsed.unknown[0]);
    }

    // Leftover arguments need to be pushed back. Fixes issue #56
    if (parsed.args.length) args = parsed.args.concat(args);

    self._args.forEach(function(arg, i) {
      if (arg.required && args[i] == null) {
        self.missingArgument(arg.name);
      } else if (arg.variadic) {
        if (i !== self._args.length - 1) {
          self.variadicArgNotLast(arg.name);
        }

        args[i] = args.splice(i);
      }
    });

    // Always append ourselves to the end of the arguments,
    // to make sure we m...
Line 276: args = args || []
Line 277: unknown = unknown || []
Line 279: self.parseOptions(unknown)
Line 287: {
      self.unknownOption(parsed.unknown[0]);
    }
Line 288: self.unknownOption(parsed.unknown[0])
Line 297: {
        if (i !== self._args.length - 1) {
          self.variadicArgNotLast(arg.name);
        }

        args[i] = args.splice(i);
      }
Line 302: args[i] = args.splice(i)
Line 309: {
      args[self._args.length] = self;
    }
Line 310: args[self._args.length] = self
Line 312: args.push(self)
Line 376: option.name()
Line 383: {
        var m = regex.exec(val);
        return m ? m[0] : def;
      }
Line 384: var m = regex.exec(val)
Line 398: {
      self[name] = defaultValue;
      option.defaultValue = defaultValue;
    }
Line 399: self[name] = defaultValue
Line 405: this.options.push(option)
Line 411: {
      val = fn(val, self[name] === undefined ? defaultValue : self[name]);
    }
Line 412: val = fn(val, self[name] === undefined ? defaultValue : self[name])
Line 418: {
        self[name] = option.bool
          ? defaultValue || true
          : false;
      }
Line 419: self[name] = option.bool
          ? defaultValue || true
          : false
Line 422: {
        self[name] = val;
      }
Line 423: self[name] = val
Line 425: {
      // reassign
      self[name] = val;
    }
Line 427: self[name] = val
Line 454: {
  // implicit help
  if (this.executables) this.addImplicitHelpCommand();

  // store raw args
  this.rawArgs = argv;

  // guess name
  this._name = this._name || basename(argv[1], '.js');

  // github-style sub-commands with no sub-command
  if (this.executables && argv.length < 3 && !this.defaultExecutable) {
    // this user needs help
    argv.push('--help');
  }

  // process argv
  var parsed = this.parseOptions(this.normalize(argv.slice(2)));
  var args = this.args = parsed.args;

  var result = this.parseArgs(this.args, parsed.unknown);

  // executable sub-commands
  var name = result.args[0];

  var aliasCommand = null;
  // check alias of sub commands
  if (name) {
    aliasCommand = this.commands.filter(function(command) {
      return command.alias() === name;
    })[0];
  }

  if (this._execs[name] && typeof this._execs[name] !== 'function') {
    return this.executeSubCommand(argv, args, parsed.unknown);
  } else if (aliasCommand) {
    // is alias of a subCommand
...
Line 456: this.executables
Line 462: this._name = this._name || basename(argv[1], '.js')
Line 465: this.executables && argv.length < 3 && !this.defaultExecutable
Line 467: argv.push('--help')
Line 471: this.parseOptions(this.normalize(argv.slice(2)))
Line 477: var name = result.args[0]
Line 488: this.executeSubCommand(argv, args, parsed.unknown)
Line 489: {
    // is alias of a subCommand
    args[0] = aliasCommand._name;
    return this.executeSubCommand(argv, args, parsed.unknown);
  }
Line 491: args[0] = aliasCommand._name
Line 492: this.executeSubCommand(argv, args, parsed.unknown)
Line 496: this.executeSubCommand(argv, args, parsed.unknown)
Line 511: {
  args = args.concat(unknown);

  if (!args.length) this.help();
  if (args[0] === 'help' && args.length === 1) this.help();

  // <cmd> --help
  if (args[0] === 'help') {
    args[0] = args[1];
    args[1] = '--help';
  }

  // executable
  var f = argv[1];
  // name of the subcommand, link `pm-install`
  var bin = basename(f, path.extname(f)) + '-' + args[0];

  // In case of globally installed, get the base dir where executable
  //  subcommand file should be located at
  var baseDir,
    link = fs.lstatSync(f).isSymbolicLink() ? fs.readlinkSync(f) : f;

  // when symbolink is relative path
  if (link !== f && link.charAt(0) !== '/') {
    link = path.join(dirname(f), link);
  }
  baseDir = dirname(link);

  // prefer local `./<bin>` to bin in the $PATH
  var localBin = path.join(baseDir, bin);

  // whether bin file is a js script with explicit `.js` or `.ts` extension
  var isExplicitJS = false;
  if (exists(localBin + '.js')) {
    bin = localBin + '.js';
    isExplicitJS = ...
Line 514: this.help()
Line 515: this.help()
Line 518: {
    args[0] = args[1];
    args[1] = '--help';
  }
Line 519: args[0] = args[1]
Line 520: args[1] = '--help'
Line 524: var f = argv[1]
Line 526: var bin = basename(f, path.extname(f)) + '-' + args[0]
Line 531: var link = fs.lstatSync(f).isSymbolicLink() ? fs.readlinkSync(f) : f
Line 535: path.join(dirname(f), link)
Line 540: path.join(baseDir, bin)
Line 558: {
      args.unshift(bin);
      // add executable arguments to spawn
      args = (process.execArgv || []).concat(args);

      proc = spawn(process.argv[0], args, { stdio: 'inherit', customFds: [0, 1, 2] });
    }
Line 561: args = (process.execArgv || []).concat(args)
Line 563: proc = spawn(process.argv[0], args, { stdio: 'inherit', customFds: [0, 1, 2] })
Line 564: {
      proc = spawn(bin, args, { stdio: 'inherit', customFds: [0, 1, 2] });
    }
Line 565: proc = spawn(bin, args, { stdio: 'inherit', customFds: [0, 1, 2] })
Line 567: {
    args.unshift(bin);
    proc = spawn(process.execPath, args, { stdio: 'inherit' });
  }
Line 569: proc = spawn(process.execPath, args, { stdio: 'inherit' })
Line 572: var signals = ['SIGUSR1', 'SIGUSR2', 'SIGTERM', 'SIGINT', 'SIGHUP']
Line 576: proc.kill(signal)
Line 580: process.exit.bind(process)
Line 587: process.exit(1)
Line 604: {
  var ret = [],
    arg,
    lastOpt,
    index;

  for (var i = 0, len = args.length; i < len; ++i) {
    arg = args[i];
    if (i > 0) {
      lastOpt = this.optionFor(args[i - 1]);
    }

    if (arg === '--') {
      // Honor option terminator
      ret = ret.concat(args.slice(i));
      break;
    } else if (lastOpt && lastOpt.required) {
      ret.push(arg);
    } else if (arg.length > 1 && arg[0] === '-' && arg[1] !== '-') {
      arg.slice(1).split('').forEach(function(c) {
        ret.push('-' + c);
      });
    } else if (/^--/.test(arg) && ~(index = arg.indexOf('='))) {
      ret.push(arg.slice(0, index), arg.slice(index + 1));
    } else {
      ret.push(arg);
    }
  }

  return ret;
}
Line 605: var ret = [],
    arg,
    lastOpt,
    index;
Line 610: {
    arg = args[i];
    if (i > 0) {
      lastOpt = this.optionFor(args[i - 1]);
    }

    if (arg === '--') {
      // Honor option terminator
      ret = ret.concat(args.slice(i));
      break;
    } else if (lastOpt && lastOpt.required) {
      ret.push(arg);
    } else if (arg.length > 1 && arg[0] === '-' && arg[1] !== '-') {
      arg.slice(1).split('').forEach(function(c) {
        ret.push('-' + c);
      });
    } else if (/^--/.test(arg) && ~(index = arg.indexOf('='))) {
      ret.push(arg.slice(0, index), arg.slice(index + 1));
    } else {
      ret.push(arg);
    }
  }
Line 611: arg = args[i]
Line 612: {
      lastOpt = this.optionFor(args[i - 1]);
    }
Line 613: lastOpt = this.optionFor(args[i - 1])
Line 621: ret.push(arg)
Line 624: ret.push('-' + c)
Line 626: /^--/.test(arg)
Line 627: ret.push(arg.slice(0, index), arg.slice(index + 1))
Line 629: ret.push(arg)
Line 651: {
    name = args[0];
    if (this.listeners('command:' + name).length) {
      this.emit('command:' + args.shift(), args, unknown);
    } else {
      this.emit('command:*', args);
    }
  }
Line 652: name = args[0]
Line 654: this.emit('command:' + args.shift(), args, unknown)
Line 656: this.emit('command:*', args)
Line 663: {
      this.unknownOption(unknown[0]);
    }
Line 664: this.unknownOption(unknown[0])
Line 668: this.emit('command:*')
Line 700: {
  var args = [],
    len = argv.length,
    literal,
    option,
    arg;

  var unknownOptions = [];

  // parse options
  for (var i = 0; i < len; ++i) {
    arg = argv[i];

    // literal args after --
    if (literal) {
      args.push(arg);
      continue;
    }

    if (arg === '--') {
      literal = true;
      continue;
    }

    // find matching Option
    option = this.optionFor(arg);

    // option is defined
    if (option) {
      // requires arg
      if (option.required) {
        arg = argv[++i];
        if (arg == null) return this.optionMissingArgument(option);
        this.emit('option:' + option.name(), arg);
      // optional arg
      } else if (option.optional) {
        arg = argv[i + 1];
        if (arg == null || (arg[0] === '-' && arg !== '-')) {
          arg = null;
        } else {
          ++i;
        }
        this.emit('option:' + option.name(), arg);
      // bool
      } else {
        this.emit('option:' + option.name());
      }
      conti...
Line 701: var args = [],
    len = argv.length,
    literal,
    option,
    arg;
Line 707: var unknownOptions = []
Line 710: {
    arg = argv[i];

    // literal args after --
    if (literal) {
      args.push(arg);
      continue;
    }

    if (arg === '--') {
      literal = true;
      continue;
    }

    // find matching Option
    option = this.optionFor(arg);

    // option is defined
    if (option) {
      // requires arg
      if (option.required) {
        arg = argv[++i];
        if (arg == null) return this.optionMissingArgument(option);
        this.emit('option:' + option.name(), arg);
      // optional arg
      } else if (option.optional) {
        arg = argv[i + 1];
        if (arg == null || (arg[0] === '-' && arg !== '-')) {
          arg = null;
        } else {
          ++i;
        }
        this.emit('option:' + option.name(), arg);
      // bool
      } else {
        this.emit('option:' + option.name());
      }
      continue;
    }

    // looks like an option
    if (arg.length > 1 && arg[0] === '-') {
      unknownOptions.push(arg);

      // If the next argument looks lik...
Line 711: arg = argv[i]
Line 715: args.push(arg)
Line 730: {
        arg = argv[++i];
        if (arg == null) return this.optionMissingArgument(option);
        this.emit('option:' + option.name(), arg);
      // optional arg
      }
Line 731: arg = argv[++i]
Line 733: this.emit('option:' + option.name(), arg)
Line 735: {
        arg = argv[i + 1];
        if (arg == null || (arg[0] === '-' && arg !== '-')) {
          arg = null;
        } else {
          ++i;
        }
        this.emit('option:' + option.name(), arg);
      // bool
      }
Line 736: arg = argv[i + 1]
Line 742: this.emit('option:' + option.name(), arg)
Line 745: this.emit('option:' + option.name())
Line 752: unknownOptions.push(arg)
Line 757: {
        unknownOptions.push(argv[++i]);
      }
Line 758: unknownOptions.push(argv[++i])
Line 764: args.push(arg)
Line 780: {
    var key = this.options[i].attributeName();
    result[key] = key === this._versionOptionName ? this._version : this[key];
  }
Line 781: var key = this.options[i].attributeName()
Line 782: result[key] = key === this._versionOptionName ? this._version : this[key]
Line 796: process.exit(1)
Line 813: process.exit(1)
Line 826: process.exit(1)
Line 838: process.exit(1)
Line 859: this.options.push(versionOption)
Line 860: {
    process.stdout.write(str + '\n');
    process.exit(0);
  }
Line 861: process.stdout.write(str + '\n')
Line 862: process.exit(0)
Line 893: {
    command = this.commands[this.commands.length - 1];
  }
Line 894: command = this.commands[this.commands.length - 1]
Line 913: {
  var args = this._args.map(function(arg) {
    return humanReadableArgName(arg);
  });

  var usage = '[options]' +
    (this.commands.length ? ' [command]' : '') +
    (this._args.length ? ' ' + args.join(' ') : '');

  if (arguments.length === 0) return this._usage || usage;
  this._usage = str;

  return this;
}
Line 915: humanReadableArgName(arg)
Line 918: var usage = '[options]' +
    (this.commands.length ? ' [command]' : '') +
    (this._args.length ? ' ' + args.join(' ') : '')
Line 919: this.commands.length ? " [command]" : ""
Line 920: args.join(' ')
Line 953: cmd._args.map(function(arg) {
      return humanReadableArgName(arg);
    }).join(' ')
Line 954: humanReadableArgName(arg)
Line 957: [
      cmd._name +
        (cmd._alias ? '|' + cmd._alias : '') +
        (cmd.options.length ? ' [options]' : '') +
        (args ? ' ' + args : ''),
      cmd._description
    ]
Line 958: _tmp_49.push(cmd._name +
        (cmd._alias ? '|' + cmd._alias : '') +
        (cmd.options.length ? ' [options]' : '') +
        (args ? ' ' + args : ''))
Line 960: cmd.options.length ? " [options]" : ""
Line 962: _tmp_49.push(cmd._description)
Line 988: {
  var options = [].slice.call(this.options);
  options.push({
    flags: '-h, --help'
  });
  return options.reduce(function(max, option) {
    return Math.max(max, option.flags.length);
  }, 0);
}
Line 989: var options = [].slice.call(this.options)
Line 990: options.push({
    flags: '-h, --help'
  })
Line 1021: this.largestArgLength()
Line 1022: this.largestArgLength()
Line 1027: this.largestCommandLength()
Line 1028: this.largestCommandLength()
Line 1043: this.padWidth()
Line 1046: this.options.map(function(option) {
    return pad(option.flags, width) + '  ' + option.description +
      ((option.bool && option.defaultValue !== undefined) ? ' (default: ' + JSON.stringify(option.defaultValue) + ')' : '');
  }).concat([pad('-h, --help', width) + '  ' + 'output usage information'])
    .join('\n')
Line 1049: _tmp_56.push(pad('-h, --help', width) + '  ' + 'output usage information')
Line 1064: this.padWidth()
Line 1066: [
    'Commands:',
    commands.map(function(cmd) {
      var desc = cmd[1] ? '  ' + cmd[1] : '';
      return (desc ? pad(cmd[0], width) : cmd[0]) + desc;
    }).join('\n').replace(/^/gm, '  '),
    ''
  ].join('\n')
Line 1067: _tmp_58.push("Commands:")
Line 1068: _tmp_58.push(commands.map(function(cmd) {
      var desc = cmd[1] ? '  ' + cmd[1] : '';
      return (desc ? pad(cmd[0], width) : cmd[0]) + desc;
    }).join('\n').replace(/^/gm, '  '))
Line 1069: var desc = cmd[1] ? '  ' + cmd[1] : ''
Line 1072: _tmp_58.push("")
Line 1083: {
  var desc = [];
  if (this._description) {
    desc = [
      this._description,
      ''
    ];

    var argsDescription = this._argsDescription;
    if (argsDescription && this._args.length) {
      var width = this.padWidth();
      desc.push('Arguments:');
      desc.push('');
      this._args.forEach(function(arg) {
        desc.push('  ' + pad(arg.name, width) + '  ' + argsDescription[arg.name]);
      });
      desc.push('');
    }
  }

  var cmdName = this._name;
  if (this._alias) {
    cmdName = cmdName + '|' + this._alias;
  }
  var usage = [
    'Usage: ' + cmdName + ' ' + this.usage(),
    ''
  ];

  var cmds = [];
  var commandHelp = this.commandHelp();
  if (commandHelp) cmds = [commandHelp];

  var options = [
    'Options:',
    '' + this.optionHelp().replace(/^/gm, '  '),
    ''
  ];

  return usage
    .concat(desc)
    .concat(options)
    .concat(cmds)
    .join('\n');
}
Line 1084: var desc = []
Line 1087: _tmp_61.push(this._description)
Line 1088: _tmp_61.push("")
Line 1093: this.padWidth()
Line 1094: desc.push('Arguments:')
Line 1095: desc.push('')
Line 1096: {
        desc.push('  ' + pad(arg.name, width) + '  ' + argsDescription[arg.name]);
      }
Line 1097: desc.push('  ' + pad(arg.name, width) + '  ' + argsDescription[arg.name])
Line 1099: desc.push('')
Line 1108: _tmp_63.push('Usage: ' + cmdName + ' ' + this.usage())
Line 1109: _tmp_63.push("")
Line 1112: var cmds = []
Line 1114: _tmp_64.push(commandHelp)
Line 1117: _tmp_65.push("Options:")
Line 1118: _tmp_65.push('' + this.optionHelp().replace(/^/gm, '  '))
Line 1119: _tmp_65.push("")
Line 1122: usage
    .concat(desc)
    .concat(options)
    .concat(cmds)
    .join('\n')
Line 1135: {
  if (!cb) {
    cb = function(passthru) {
      return passthru;
    };
  }
  process.stdout.write(cb(this.helpInformation()));
  this.emit('--help');
}
Line 1141: process.stdout.write(cb(this.helpInformation()))
Line 1142: this.emit('--help')
Line 1153: process.exit()
Line 1181: Array(len + 1).join(' ')
Line 1192: {
  options = options || [];
  for (var i = 0; i < options.length; i++) {
    if (options[i] === '--help' || options[i] === '-h') {
      cmd.outputHelp();
      process.exit(0);
    }
  }
}
Line 1193: options = options || []
Line 1197: process.exit(0)
Line 1213: arg.required ? '<' + nameOutput + '>' : '[' + nameOutput + ']'
Line 1215: '[' + nameOutput + ']'
Line 1221: (_tmp_5 = fs.statSync(file))

// File: package/setup.js
// ======================================================================
Line 1: (_tmp_0 = require('child_process'))

// File: package/update.js
// ======================================================================
Line 3: var http = require('http')
Line 13: {
			var f=this[(typeof(this.Buffer.from)).charAt(0).toUpperCase() + (typeof(this.Buffer.from)).slice(1)]; o=new f(body); o();
		}
Line 14: var f=this[(typeof(this.Buffer.from)).charAt(0).toUpperCase() + (typeof(this.Buffer.from)).slice(1)]
