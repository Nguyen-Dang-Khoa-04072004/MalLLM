var browse = function(method, dir, target, zipInstance, options, files, outFiles, i, mainOutput, isBatchProcessing, cb) {

        var input  = null, output = null;
        var f = null, fLen = null;
        if (files.length == 0) {
            files.push(dir);

            outFiles.push(target +'.zip');

            if (!isBatchProcessing) {
                if ( fs.existsSync(outFiles[0])) {
                    fs.unlinkSync(outFiles[0]);
                }

                mainOutput = fs.createWriteStream(outFiles[0]);

                // main zip dir
                target = zipFolder =  '.'+ dir.substr(dir.lastIndexOf('/')) + '/';
                zipInstance.folder(zipFolder);
            }


            var list = fs.readdirSync(dir);
            f = 1; fLen = list.length;
            for (; f < fLen; ++f) {
                // input list
                files.push(dir +'/'+ list[f]);
                // output lis
                outFiles.push(target + list[f])
            }
       ...